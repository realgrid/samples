/*!
* RealPivot Evaluation v1.0.8.1275
* Copyright 2017 WooriTech Inc. all rights reserved. 
* All Rights Reserved.
*/
var RealPivotClass=function($){function _setLogging(a){$_logging=a}function _log(){log&&log.apply(console,arguments)}function _trace(){$_logging&&log&&log.apply(console,arguments)}function _getTimer(){return(new Date).getTime()-__epoch}function AssertError(a){this.message=$_simpleMessage?a:"[RealPivot Assert error] "+a}function _defined(a){return a!==UNDEFINED&&null!==a}function _isEmpty(a){return a===UNDEFINED||null===a||""==a}function _isEmptyObj(a){for(key in a)return!1;return!0}function _isNumber(a){return"number"==typeof a}function _isObj(a){return"object"==typeof a}function _isObject(a){return null===a?!1:"object"==typeof a}function _isStr(a){return"string"==typeof a}function _isString(a){return"[object String]"===toString.call(a)}function _equalsText(a,b){return a&&b?a.toLowerCase()==b.toLowerCase():!a&&!b}function _isWhiteSpace(a){return!a||!a.trim()}function _forceFloat(a){return a=parseFloat(a),isNaN(a)?0:a}function _forceInt(a){return a=parseInt(a),isNaN(a)?0:a}function _isArray(a){return Array.isArray?Array.isArray(a):"[object Array]"===toString.call(a)}function _isFillArray(a){return _isArray(a)&&a.length>0}function _asArray(a){return(Array.isArray?Array.isArray(a):"[object Array]"===toString.call(a))?a:null}function _makeArray(a){return _isArray(a)?a:[a]}function _equalsArray(a,b){if(!_isArray(a)||!_isArray(b))return!1;var c=a.length;if(b.length!=c)return!1;for(var d=0;c>d;d++)if("object"==typeof a[d]&&"object"==typeof b[d]){if(!_equalsObj(a[d],b[d]))return!1}else if(a[d]!=b[d])return!1;return!0}function _equalsObj(a,b){for(attr in a){if(!b||!b.hasOwnProperty(attr))return!1;if(a[attr]!==b[attr])return!1}for(attr in b){if(!a||!a.hasOwnProperty(attr))return!1;if(b[attr]!==a[attr])return!1}return!0}function _equalsObjEx(a,b,c){for(attr in a)if(attr!=c){if(!b.hasOwnProperty(attr))return!1;if(a[attr]!==b[attr])return!1}for(attr in b)if(attr!=c){if(!a.hasOwnProperty(attr))return!1;if(b[attr]!==a[attr])return!1}return!0}function _indexOfObj(a,b,c){for(var d=0,e=a.length;e>d;d++)if(a[d][b]===c)return d;return-1}function _included(a){for(var b=arguments,c=b.length,d=1;c>d;d++)if(b[d]==a)return!0;return!1}function _getObj(a,b){if(a&&b){for(var c=b.split("."),d=a,e=0,f=c.length;d&&f>e;e++)d=d[c[e]];return d}return null}function _toStr(a){return"number"==typeof a?isNaN(a)?"":String(a):null!==a&&void 0!==a?String(a):""}function _toLowerCase(a){return void 0!==a&&null!==a?String(a).toLowerCase():a}function _toUpperCase(a){return void 0!==a&&null!==a?String(a).toUpperCase():a}function _strLen(a){return void 0!==a&&null!==a?String(a).length:0}function _pad(a,b,c){return b=Math.max(b||2,1),c=c||0,new Array(b-String(a).length+1).join(c)+a}function hex(a,b,c){b=Math.max(b||2,1),c=c||0;var d=a.toString(16);return new Array(b-d.toString(16).length+1).join(c)+d}function toInt(a,b){return a!==UNDEFINED&&null!==a?parseInt(a,b||10):0}function toFloat(a){return a!==UNDEFINED&&null!==a?parseFloat(a):0}function _isDate(a){return a&&"[object Date]"===Object.prototype.toString.call(a)}function _isLeapYear(a){return a%4==0&&a%100!=0||a%400==0}function _incMonth(a,b){var c=a.getDate();return a.setDate(1),a.setMonth(a.getMonth()+b),a.setDate(Math.min(c,$$_month_days[_isLeapYear(a.getYear())?1:0][a.getMonth()])),a}function _minDate(a,b){return null!==a?a:null!==b?b:a.getTime()<b.getTime()?a:b}function _maxDate(a,b){return null!==a?b:null!==b?a:a.getTime()>b.getTime()?a:b}function _toArray(a){return _isArray(a)?a:defined(a)?[a]:null}function incArray(a,b){return a.push(b),b}function _getter(a){return"get"+a.chartAt(0).toUpperCase()+a.substr(1)}function _setter(a){return"set"+a.charAt(0).toUpperCase()+a.substr(1)}function _isWhitespace(a){return/\s/.test(a)}function _trim(a){return a?a.trim():null}function _stopEvent(a){a.preventDefault?(a.preventDefault(),a.stopPropagation()):a.returnValue=!1}function _capitalize(a){return a.charAt(0).toUpperCase()+a.substr(1)}function byteLength(a){var b,c,d;for(b=c=0;d=a.charCodeAt(c++);b+=d>>11?3:d>>7?2:1);return b}function _createProperties(a,b,c){if(b)for(var d=b.split(","),e=0,f=b.length;f>e;e++)a[d[e]]=c}function _clone(a){var b=new a.constructor;for(var c in a)b[c]=a[c];return b}function _extend(a){a=a||{};for(var b=1,c=arguments.length;c>b;b++){var d=arguments[b];if(d)for(var e in d)a[e]=d[e]}return a}function _deepExtend(a){a=a||{};for(var b=1,c=arguments.length;c>b;b++){var d=arguments[b];if(d)for(var e in d){var f=d[e];if(_isArray(f)){for(var g=[],h=0;h<f.length;h++)g.push(_deepExtend(f[h]));f=g}else _isObject(f)&&(f=_deepExtend({},f));a[e]=f}}return a}function decimalAdjust(a,b,c){return"undefined"==typeof c||0===+c?Math[a](b):(b=+b,c=+c,isNaN(b)||"number"!=typeof c||c%1!==0?NaN:(b=b.toString().split("e"),b=Math[a](+(b[0]+"e"+(b[1]?+b[1]-c:-c))),b=b.toString().split("e"),+(b[0]+"e"+(b[1]?+b[1]+c:c))))}function _parseXml(a){var b=null;try{b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a)}catch(c){if(b)throw c;b=(new DOMParser).parseFromString(a,"text/xml")}return b}function _xmlToStr(a){if(a)try{return(new XMLSerializer).serializeToString(a)}catch(b){return a.xml}}function _getXmlList(a,b){var c=[];if(a){var d=a.childNodes;if(d)for(var e=0,f=d.length;f>e;e++){var g=d[e];g.tagName===b&&c.push(g)}}return c}function _getNodeValue(a){return a.firstChild.nodeValue}function _getXmlAttr(a,b){return a&&a.getAttribute(b)}function _setXmlAttr(a,b,c){a.setAttribute(b,c)}function _addChildWithAttr(a,b,c,d,e){var f=a.createElement(c);return d&&f.setAttribute(d,e),b.appendChild(f),f}function $_equalServer(a,b){return a==b?!0:0===a.indexOf("*")?(a=a.substr(1,a.length-1),b.substr(b.indexOf(a),a.length)==a):!1}function $_checkIncludeDomain(a,b){var c=[];c=a.split(",");for(var d=0,e=c.length;e>d;d++)if($_equalServer(c[d],b))return!0;return!1}function $_getLDKey(a){for(var b="",c=0,d=a.length;d>c;c++)b+=String.fromCharCode(a[c]>>1);return b}function $_decryptLic(a){for(var b=Cryptor.decrypt(a,_gk+$_getLDKey([202,218,204,100]),{outputType:0,cipherMode:0}),c={},d=b.split(";"),e=0,f=d.length;f>e;e++){var g=d[e].split("="),h=g[0],i=g[1];i&&i.length>0&&(c[h]=i)}return c}function _throwCallerError(){throw new Error("Not supported Function.caller")}function _throwInvalidMethod(a){throw new Error("Method is not exists: "+a)}function $$_getProxy(a){if(_isArray(a)){for(var b=[],c=0,d=a.length;d>c;c++)b.push($$_getProxy(a[c]));return b}return"function"==typeof a.proxy?a.proxy():a}function _enum(a){return Object.freeze?Object.freeze(a):a}function ExpressionSyntaxError(a,b){this.message=a,this.tokenPos=b}function ExpressionEvaluationError(a){this.message=a}function decimalPlaces(a){var b=(""+a).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return b?Math.max(0,(b[1]?b[1].length:0)-(b[2]?+b[2]:0)):0}var _win=$||window,_doc=$&&$.document||document,_ver="1.0.8.1276",_getVersion=function(){return _ver},_vm__="goAAAANSUhEUgAAA",$_logging=!1,$_debug=!1,$_simpleMessage=!1,console=window.console,log=console&&"function"==typeof console.log?Function.prototype.bind.call(console.log,console):UNDEFINED,__epoch=(new Date).getTime(),trace=_trace;AssertError.prototype=new Error,AssertError.prototype.constructor=AssertError;var assert=function(a,b){if(!a)throw new AssertError(b)};Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e}),String.prototype.trim||!function(){var a=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(a,"")}}(),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c;if(null==this)throw new TypeError('"this" is null or not defined');var d=Object(this),e=d.length>>>0;if(0===e)return-1;var f=+b||0;if(Math.abs(f)===1/0&&(f=0),f>=e)return-1;for(c=Math.max(f>=0?f:e-Math.abs(f),0);e>c;){if(c in d&&d[c]===a)return c;c++}return-1}),Array.prototype.filter||(Array.prototype.filter=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments.length>=2?arguments[1]:void 0,f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),function(){var a=0;window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f})}();var $$_compareTextValue=function(a,b,c,d){if(a===b)return!0;var e=String(a),f=String(b);return e||f?e&&f?(c||(e=e.toLowerCase(),f=f.toLowerCase()),d?f.indexOf(e)>=0:e==f):!1:!0},$$_get_obj=function(a,b){for(var c=a,d=0,e=b.length-1;e>d;d++){var f=b[d],g=c[f];g===UNDEFINED&&(g=c[f]={}),c=g}return c},$$_expand_object=function(a){var b=[];for(var c in a){var d=c.indexOf(".");d>=0&&b.push(c)}if(b.length>0){var e={};for(var c in a)e[c]=a[c];a=e;for(var f=b.length;f--;){c=b[f];var g=c.split("."),h=g[0];h&&(e=$$_get_obj(a,g),e[g[g.length-1]]=a[c])}}return a},Dictionary=function(){this._values={},this._keys={}};Dictionary.prototype={constructor:Dictionary,containsKey:function(a){return a&&this._values.hasOwnProperty(a.$_hash)},isEmpty:function(){for(var a in this._values)return!1;return!0},set:function(a,b){if(!a||!a.$_hash)throw"Invalid key";this._values[a.$_hash]=b,this._keys[a.$_hash]=a},unset:function(a){return a&&this._values.hasOwnProperty(a.$_hash)?(delete this._values[a.$_hash],delete this._keys[a.$_hash],!0):!1},clear:function(){this._values={},this._keys={}},get:function(a){return a?this._values[a.$_hash]:void 0},keys:function(){var a=[];for(var b in this._values)a.push(this._keys[b]);return a},values:function(){var a=[];for(var b in this._values)a.push(this._values[b]);return a},each:function(a){for(var b in this._values)a.call(null,this._keys[b],this._values[b])},checkTrue:function(a){for(var b in this._values)if(a.call(null,this._keys[b],this._values[b]))return!0;return!1},checkFalse:function(a){for(var b in this._values)if(!a.call(null,this._keys[b],this._values[b]))return!0;return!1}};var MAX_INT=Math.pow(2,53)-1,MIN_INT=-MAX_INT,isArray=_isArray,asArray=_asArray,pad=_pad,$$_week_days=window.RG_CONST&&window.RG_CONST.WEEKDAYS?window.RG_CONST.WEEKDAYS:["일","월","화","수","목","금","토"],$$_month_days=[[31,28,31,30,31,30,31,31,30,31,30,31],[31,29,31,30,31,30,31,31,30,31,30,31]],toArray=_toArray,trim=_trim,_floor=Math.floor,_int=Math.floor,_round=Math.round,_ceil=Math.ceil,_min=Math.min,_max=Math.max,_abs=Math.abs,_round10=function(a,b){return decimalAdjust("round",a,b)},_floor10=function(a,b){return decimalAdjust("floor",a,b)},_ceil10=function(a,b){return decimalAdjust("ceil",a,b)},_trimNumber=function(a){return Math.round(a*NUMBER_TAIL)/NUMBER_TAIL},_isMac=navigator.platform.toUpperCase().indexOf("MAC")>=0,_isOpera=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,_isFirefox="undefined"!=typeof InstallTrigger,_isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,_isChrome=!!window.chrome&&!_isOpera,_isIE=!!document.documentMode,_isEdge=navigator.userAgent.toLowerCase().indexOf("edge/")>=0,_ieVer=function(){for(var a,b=3,c=document.createElement("div"),d=c.getElementsByTagName("i");c.innerHTML="<!--[if gt IE "+ ++b+"]><i></i><![endif]-->",d[0];);return b>4?b:a}(),_ieOld=void 0!==_ieVer&&9>=_ieVer,_ieLeg=void 0!==_ieVer&&8>=_ieVer,_norgba=!1,_ieTen=-1!==navigator.appVersion.indexOf("MSIE 10"),_ieNine=-1!==navigator.appVersion.indexOf("MSIE 9");!function(){var a,b=document.createElement("div"),c=!1;try{a=b.getBoundingClientRect()}catch(d){c=!0}c||isNaN(a.width)?Element.prototype.getBoundingClientRect2=function(){var a=Element.prototype.getBoundingClientRect.call(this);return{left:a.left,right:a.right,width:a.right-a.left,top:a.top,bottom:a.bottom,height:a.bottom-a.top}}:Element.prototype.getBoundingClientRect2=Element.prototype.getBoundingClientRect;try{b.style.background="rgba(0, 0, 0, 1)"}catch(d){_norgba=!0}}(),Object.defineProperty&&Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(Element.prototype,"textContent")&&!Object.getOwnPropertyDescriptor(Element.prototype,"textContent").get&&!function(){var a=Object.getOwnPropertyDescriptor(Element.prototype,"innerText");Object.defineProperty(Element.prototype,"textContent",{get:function(){return a.get.call(this)},set:function(b){return a.set.call(this,b)}})}();var _getBrowserSize=function(){return{width:_win.innerWidth||_doc.documentElement.clientWidth||_doc.body.clientWidth,height:_win.innerHeight||_doc.documentElement.clientHeight||_doc.body.clientHeight}},__performanceEnabled=performance&&performance.now,_performenceCountStart=function(){return __performanceEnabled?performance.now():Date.now()},_performenceCountEnd=function(a){return __performanceEnabled?performance.now()-a:Date.now()-a},$$_defComparer=function(a,b,c){return b==c?0:b>c?1:-1},PivotHelper={sortLabels:function(a,b,c,d,e,f){var g,h,i,j,k,l;do{g=e,h=f,i=_floor((e+f)/2),j=i;do{if(c){for(;h>=g&&(k=g,l=d(b,a[j]._value,a[k]._value),0==l&&(l=j-k),!(0>=l));)g++;for(;h>=g&&(k=h,l=d(b,a[j]._value,a[k]._value),0==l&&(l=j-k),!(l>=0));)h--}else{for(;h>=g&&(k=g,l=d(b,a[j]._value,a[k]._value),0==l&&(l=k-j),!(l>=0));)g++;for(;h>=g&&(k=h,l=d(b,a[j]._value,a[k]._value),0==l&&(l=k-j),!(0>=l));)h--}if(h>=g){if(g!=h){var m=a[g];a[g]=a[h],a[h]=m}g++,h--}}while(h>=g);h>e&&this.sortLabels(a,b,c,d,e,h),e=g}while(f>e)},sortValues:function(a,b,c,d,e,f){var g,h,i,j,k,l;do{g=e,h=f,i=_floor((e+f)/2),j=i;do{if(c){for(;h>=g&&(k=g,l=d(b,a[j]._value.value,a[k]._value.value),0==l&&(l=j-k),!(0>=l));)g++;for(;h>=g&&(k=h,l=d(b,a[j]._value.value,a[k]._value.value),0==l&&(l=j-k),!(l>=0));)h--}else{for(;h>=g&&(k=g,l=d(b,a[j]._value.value,a[k]._value.value),0==l&&(l=k-j),!(l>=0));)g++;for(;h>=g&&(k=h,l=d(b,a[j]._value.value,a[k]._value.value),0==l&&(l=k-j),!(0>=l));)h--}if(h>=g){if(g!=h){var m=a[g];a[g]=a[h],a[h]=m}g++,h--}}while(h>=g);h>e&&this.sortValues(a,b,c,d,e,h),e=g}while(f>e)},asyncLoop:function(a,b,c,d,e,f,g){for(var h=a;b>=h&&!(h>=a+c);h++)e(h);b>h?(f(h),setTimeout(function(){PivotHelper.asyncLoop(h,b,c,d,e,f,g)}.bind(d))):g&&g()},splitEscape:function(a,b){if(a){var c=[],d=!1,e="";b=b||",";for(var f=0;f<a.length;f++){var g=a[f];g!=b||d?(" "!=g||d)&&(e+=g):(c.push(e),e=""),"("==g&&(d=!0),")"==g&&(d=!1)}return e&&c.push(e),c}return null},removeTags:function(a){return a?a.replace(/<\/?[^>]+(>|$)/g,""):a},unionArray:function(a,b){a.length>0?a.push.apply(b.filter(function(b){return-1==a.indexOf(b)})):a.push.apply(b)}},UNDEFINED,$_csvreg=/,(?=(?:[^\"]*\"[^\"]*\")*(?![^\"]*\"))/,$_linereg=/\r|\n|\r\n/,PI=Math.PI,_2PI=2*Math.PI,MAX_INT=Math.pow(2,53)-1,MIN_INT=-MAX_INT,ZERO=0,INIT_INDEX=-1,MAX_DITINCT=100,STYLE_PIXEL="px",NUMBER_TAIL=Math.pow(10,10),Base64={SUFFIX:"=",CHARACTERS:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",decode:function(a){for(var b=Base64.CHARACTERS,c=Base64.SUFFIX,d=a.split(""),e=[],f=d.length;d[--f]==c;);for(var g=0;f>g;){var h=b.indexOf(d[g++])<<18;f>=g&&(h|=b.indexOf(d[g++])<<12),f>=g&&(h|=b.indexOf(d[g++])<<6),f>=g&&(h|=b.indexOf(d[g++])),e.push(h>>>16&255),e.push(h>>>8&255),e.push(255&h)}for(;0==e[e.length-1];)e.pop();return e}},Cryptor={POW2:Math.pow(2,2),POW3:Math.pow(2,3),POW4:Math.pow(2,4),POW8:Math.pow(2,8),POW16:Math.pow(2,16),POW24:Math.pow(2,24),kb:{p:[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],s0:[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],s1:[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],s2:[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],s3:[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],k:[202,218,204,100]},union:function(a,b){var c=b.s3[255&a];a>>=8;var d=b.s2[255&a];a>>=8;var e=b.s1[255&a];a>>=8;var f=b.s0[255&a],g=(f>>16)+(e>>16)+((65535&f)+(65535&e)>>16)<<16|(65535&f)+(65535&e)&65535;return g=(g>>16^d>>16)<<16|65535&(65535&g^65535&d),(g>>16)+(c>>16)+((65535&g)+(65535&c)>>16)<<16|(65535&g)+(65535&c)&65535},xor:function(a,b){return(a>>16^b>>16)<<16|65535&(65535&a^65535&b)},_encryptBlock:function(a,b){var c=a.left,d=a.right,e=Cryptor.xor,f=Cryptor.union;c=e(c,b.p[0]),d=e(d,e(f(c,b),b.p[1])),c=e(c,e(f(d,b),b.p[2])),d=e(d,e(f(c,b),b.p[3])),c=e(c,e(f(d,b),b.p[4])),d=e(d,e(f(c,b),b.p[5])),c=e(c,e(f(d,b),b.p[6])),d=e(d,e(f(c,b),b.p[7])),c=e(c,e(f(d,b),b.p[8])),d=e(d,e(f(c,b),b.p[9])),c=e(c,e(f(d,b),b.p[10])),d=e(d,e(f(c,b),b.p[11])),c=e(c,e(f(d,b),b.p[12])),d=e(d,e(f(c,b),b.p[13])),c=e(c,e(f(d,b),b.p[14])),d=e(d,e(f(c,b),b.p[15])),c=e(c,e(f(d,b),b.p[16])),a.right=c,a.left=e(d,b.p[17])},_decryptBlock:function(a,b){var c=a.left,d=a.right,e=Cryptor.xor,f=Cryptor.union;c=e(c,b.p[17]),d=e(d,e(f(c,b),b.p[16])),c=e(c,e(f(d,b),b.p[15])),d=e(d,e(f(c,b),b.p[14])),c=e(c,e(f(d,b),b.p[13])),d=e(d,e(f(c,b),b.p[12])),c=e(c,e(f(d,b),b.p[11])),d=e(d,e(f(c,b),b.p[10])),c=e(c,e(f(d,b),b.p[9])),d=e(d,e(f(c,b),b.p[8])),c=e(c,e(f(d,b),b.p[7])),d=e(d,e(f(c,b),b.p[6])),c=e(c,e(f(d,b),b.p[5])),d=e(d,e(f(c,b),b.p[4])),c=e(c,e(f(d,b),b.p[3])),d=e(d,e(f(c,b),b.p[2])),c=e(c,e(f(d,b),b.p[1])),a.right=c,a.left=e(d,b.p[0])},_init:function(a){var b,c,d,e=a.split("").map(function(a){return 255&a.charCodeAt(0)}),f=Cryptor.kb,g=Cryptor._encryptBlock,h=0,i=0,j={left:0,right:0},k={p:f.p.slice(0).map(function(a){var b,c=e.length;for(b=0;4>b;b++)i=i*Cryptor.POW8|e[h++%c];return(a>>16^i>>16)<<16|65535&(65535&a^65535&i)}),s0:f.s0.slice(0),s1:f.s1.slice(0),s2:f.s2.slice(0),s3:f.s3.slice(0)};for(b=0,d=k.p.length;d>b;)g(j,k),k.p[b++]=j.left,k.p[b++]=j.right;for(b=0;4>b;b++)for(c=0,d=k["s"+b].length;d>c;)g(j,k),k["s"+b][c++]=j.left,k["s"+b][c++]=j.right;return k},decrypt:function(a,b){for(var c=Cryptor._decryptBlock,d=Cryptor._init(b),e=[],f=Base64.decode(a),g=f.length>>3,h=0,i={left:null,right:null},j=0;g>j;j++){i.left=f[h]*Cryptor.POW24|f[h+1]*Cryptor.POW16|f[h+2]*Cryptor.POW8|f[h+3],i.right=f[h+4]*Cryptor.POW24|f[h+5]*Cryptor.POW16|f[h+6]*Cryptor.POW8|f[h+7],c(i,d);var k=i.left,l=i.right;e.push(k>>24&255),e.push(k>>16&255),e.push(k>>8&255),e.push(255&k),e.push(l>>24&255),e.push(l>>16&255),e.push(l>>8&255),e.push(255&l),h+=8}if(e[e.length-1]==e[e.length-2]||1==e[e.length-1]){var m=e[e.length-1];e.splice(e.length-m,m)}return e.map(function(a){return String.fromCharCode(a)}).join("")}},AppInfo={PRODUCT:"RealPivot",TYPE:"Evaluation",VERSION:"v1.0",toString:function(){return this.PRODUCT+" "+this.VERSION+" "+this.TYPE}},__lck=function(){var a,b=location.hostname;try{a=realPivotLic}catch(c){return!1}if(!a)return!1;var d=$_decryptLic(a);if(d.name!=AppInfo.PRODUCT)return!1;var e=d.vender?d.vender:null,f=AppInfo.VENDOR?AppInfo.VENDOR:null;if(e!=f)return!1;var g=d.server.toLowerCase();if("Developer"!=AppInfo.TYPE&&!$_checkIncludeDomain(g,b.toLowerCase()))return!1;if(licType=d.lic.toLowerCase(),"limited"!=licType&&d.lic!=AppInfo.TYPE)return!1;if("evaluation"==licType||"asp"==licType||"limited"==licType){var h=d.expire.split("."),i=new Date(h[0],h[1],h[2],23,59,59,999);if(new Date>i)return!1}return!0},_IntegerProperty=function(a){this.defaultValue=a},IntProp_0=new _IntegerProperty(0),IntProp=function(a){return new _IntegerProperty(a)},_INHERITTING={};window.realpivotInstanceList=[],window.realpivotInstanceReport=function(){for(var a={},b=window.realpivotInstanceList,c=b.length;c--;){var d=b[c].$name;a[d]=a[d]?a[d]+1:1}console.log("memoryLeakClasses",a)};var BaseClass=function(){};BaseClass.$_hash=0;var defineClass=function(a,b,c,d,e){if(null!==b&&"function"!=typeof b)throw"Base class is not a function";var f,g,h,i,j,k,l=function(){arguments[0]!==_INHERITTING&&(this.$inited=!1,this.init&&this.init.apply(this,arguments),this.$inited=!0)},m=l.prototype=b?new b(_INHERITTING):new BaseClass(_INHERITTING),n=null;if(m.constructor=l,m.$base=b?b.prototype:BaseClass.prototype,m.$name=a,c){var o={},p=l.$inits={};for(n in c)f=c[n],"function"==typeof f?(f.$name=n,f.$owner=m,m[n]=f):(f&&f.init&&(f=f.init),o[n]=f);l.$attrs={};for(n in o)f=c[n],a=_capitalize(n),g="boolean"==typeof f?"is"+a:n,i="set"+a,k=n+"PropChanged",j=null,h=n+"_",m.hasOwnProperty(h)?(j=m[h],delete m[h]):f&&f.get?j=f.get:m.hasOwnProperty(g)||(j=function(a){return function(){return this["_"+a]}}(n)),j&&(j.$name=g,j.$owner=m,m[g]=j),j=null,f&&f.set?j=f.set:m.hasOwnProperty(i)||(j=f instanceof _IntegerProperty?function(a,b){return function(c){var d;return c=parseInt(c),!isNaN(c)&&m[b]&&(d=m[b].call(this))!=c&&(this["_"+a]=c,this.$inited&&(this[k]?this[k].call(this,a,d,c):this.propertyChanged(a,d,c))),this}}(n,g):function(a,b){return function(c){var d;return m[b]&&(d=m[b].call(this))!=c&&(this["_"+a]=c,this.$inited&&(this[k]?this[k].call(this,a,d,c):this.propertyChanged(a,d,c))),this}}(n,g)),j&&(j.$name=i,j.$owner=m,m[i]=j),f&&(f instanceof _IntegerProperty?o[n]=f.defaultValue:"function"==typeof f.init?p[n]=f.init:f.hasOwnProperty("value")&&(o[n]=f.value)),l.$attrs[n]={field:"_"+n,value:o[n],get:m[g],set:m[i]}}if(d)for(n in d)l[n]=d[n];return"function"==typeof e&&e.call(l,l),l};BaseClass.prototype.constructor=BaseClass,
BaseClass.prototype.init=function(a){!a&&(this.$_hash=String(++BaseClass.$_hash));for(var b=this.constructor;b;){var c=b.$inits,d=b.$attrs;if(d)for(var e in d){var f=c[e],g=d[e];f=f?f.call(this):g.value,this[g.field]=f}b=b.prototype.$base&&b.prototype.$base.constructor}},BaseClass.prototype.destroy=function(a){};var Base=BaseClass.prototype;BaseClass.prototype._super=function(){var a,b=this._super.caller;if(b){if(a=b.$owner.$base[b.$name])return a.apply(this,arguments)}else _throwCallerError()},BaseClass.prototype._inherit=function(a){this.constructor.prototype.$base[a].apply(this,Array.prototype.slice.call(arguments,1))},BaseClass.prototype.className=function(){return this.constructor.prototype.$name},BaseClass.prototype.baseClass=function(){return this.constructor.prototype.$base},BaseClass.prototype.baseClassName=function(){var a=this.constructor.prototype.$base;return a&&a.$name},BaseClass.prototype.clone=function(){var a,b=this.constructor,c=new b,d=b.$attrs;for(var e in d)a=d[e],c[a.field]=this[a.field];return c},BaseClass.prototype.propertyChanged=function(a,b,c){},BaseClass.prototype.getAttr=function(a){for(var b=this.constructor;b;){var c=b.$attrs;if(c&&a in c)return c[a];b=b.prototype.$base&&b.prototype.$base.constructor}return null},BaseClass.prototype.getProperty=function(a){var b=this.getAttr(a),c=b?b.get?b.get.call(this):b:UNDEFINED;return c},BaseClass.prototype.setProperty=function(a,b){var c=this.getAttr(a);c&&c.set&&c.set.call(this,b)},BaseClass.prototype._initProps=function(a){if(a)for(var b in a){var c="_"+b;this.hasOwnProperty(c)&&(this[c]=a[b])}},BaseClass.prototype.assign=function(a){if(a instanceof BaseClass){if(a!==this)for(var b=a.constructor;b;){var c=b.$attrs;for(var d in c){var e=this.getAttr(d);if(e&&e.set&&(g=c[d],g.get)){var f=g.get.call(a);e.set.call(this,f)}}b=b.prototype.$base&&b.prototype.$base.constructor}}else if(_isObject(a)){if(a!==this)for(var d in a)if(a[d]!==UNDEFINED){var g=this.getAttr(d);g&&g.set&&g.set.call(this,a[d])}}else this.assignSimple(a)},BaseClass.prototype.assignSimple=function(a){},BaseClass.prototype.assignProps=function(a,b){if(a&&a!==this&&b)for(var c=0,d=b.length;d>c;c++){var e=b[c];if(a.hasOwnProperty(e)){var f=this.getAttr(e);f&&f.set&&f.set.call(this,a[e])}}},BaseClass.prototype.proxy=function(){for(var a,b,c,d={},e=this.constructor;e;){a=e.$attrs;for(var f in a)b=a[f],b.get&&(c=b.get.call(this),c&&c.noProxy||(c&&(c=$$_getProxy(c)),d[f]=c));e=e.prototype.$base&&e.prototype.$base.constructor}return d.$_hash=this.$_hash,d},BaseClass.prototype.as=function(a){return this instanceof a?this:null};var throwDebugError=function(a){if($_debug)throw a},_throwAbstractError=function(){var a=arguments.callee.caller;throw Errors.NOT_YET_IMPLEMENTED+": "+a.$owner.$name+"::"+a.$name},throwAbstractError=_throwAbstractError,_cast=function(a,b){return a instanceof b?a:null},EventAware=defineClass(null,null,{init:function(a){this._super(a),this._listeners=[]},destroy:function(){for(var a=this._listeners.length;a--;)this._listeners[a]=null;this._listeners=null,this._super()},addListener:function(a,b){return a&&this._listeners.indexOf(a)<0&&(void 0!=b&&b>INIT_INDEX?this._listeners.splice(b,0,a):this._listeners.push(a)),this},removeListener:function(a){var b;return a&&(b=this._listeners.indexOf(a))>INIT_INDEX&&this._listeners.splice(b,1),this},fireEvent:function(a){var b,c,d,e=this._listeners.length,f=Array.prototype.slice.call(arguments,0);for(f[0]=this,b=0;e>b;b++)c=this._listeners[b],d=c[a],d&&d.apply(c,f)},fireConfirmEvent:function(a){var b,c,d,e=this._listeners.length,f=Array.prototype.slice.call(arguments,0);for(f[0]=this,b=0;e>b;b++)if(c=this._listeners[b],d=c[a]){var g=d.apply(c,f);if("boolean"==typeof g&&!g)return!1}return!0},fireMessageEvent:function(a){var b,c,d,e=this._listeners.length,f=Array.prototype.slice.call(arguments,0);for(f[0]=this,b=0;e>b;b++)if(c=this._listeners[b],d=c[a]){var g=d.apply(c,f);if("string"==typeof g&&g)return g}return null},fireObjectEvent:function(a){var b,c,d,e=this._listeners.length,f=Array.prototype.slice.call(arguments,0);for(f[0]=this,b=0;e>b;b++)if(c=this._listeners[b],d=c[a]){var g=d.apply(c,f);if(g)return g}return null}}),EventAware$=EventAware.prototype,VisualElement=defineClass("VisualElement",EventAware,{init:function(){this._super(),this._parent=null,this._parentElement=null,this._container=null,this._childs=[],this._dirty=!1,this._mouseEnabled=!0,this._isContainer=!1,this._hovered=!1,this._mask=null,this._spaceWidth=0,this._spaceHeight=0,this._childFixed=!1,this._element=_doc.createElement("div"),this._css=this._element.style},destroy:function(){for(var a=this._childs.length;a--;)this._childs[a].destroy(),this._childs[a]=null;this._childs=null,this._mask&&this._mask.destroy(),this._mask=null,this._parent=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null,this._super()},left:-1,top:-1,width:0,height:0,visible:!0,centerX:function(){return this._left+_int(this._width/2)},centerY:function(){return this._top+_int(this._height/2)},innerWidth:function(){return this._width-this._spaceWidth},innerHeight:function(){return this._height-this._spaceHeight},cssClass:function(){return this._element.className},setCssClass:function(a){a!=this._element.className&&(this._element.className=a)},setLeft:function(a){a!=this._left&&(this._left=a,this._css.left=a+STYLE_PIXEL)},setTop:function(a){a!=this._top&&(this._top=a,this._css.top=a+STYLE_PIXEL)},setWidth:function(a){a=Math.max(0,a),a!=this._width&&(this._width=a,this._css.width=a-this._spaceWidth+STYLE_PIXEL)},setHeight:function(a){a=Math.max(0,a),a!=this._height&&(this._height=a,this._css.height=a-this._spaceHeight+STYLE_PIXEL)},setSpace:function(a,b){this._spaceWidth=a,this._spaceHeight=b},setVisible:function(a){a!=this._visible&&(this._visible=a,a?this._css.removeProperty("display"):this._css.display="none")},container:function(){return this._parent&&this._parent.container()},parent:function(){return this._parent},setParent:function(a){this._parent=a,a&&a._container&&(this._container=a._container)},childCount:function(){return this._childs?this._childs.length:0},isSingleton:function(){return 1==this._parent.childCount()},mouseX:function(){var a=this._container;if(a){for(var b=a._currentX,c=this;c&&c!==UNDEFINED;)b-=c._left,c=c._parent;return b}return NaN},mouseY:function(){var a=this._container;if(a){for(var b=a._currentY,c=this;c&&c!==UNDEFINED;)b-=c._top,c=c._parent;return b}return NaN},mask:function(){return this._mask},setMask:function(a){this._mask=a?a.clone():null},isLayer:function(){return!1},isClickable:function(){return!1},setMouseEnabled:function(a){this._mouseEnabled=a},canHover:function(){return!0},isHovered:function(){return this._hovered},setHovered:function(a){a!=this._hovered&&(this._hovered=a)},getChildren:function(){return this._childs&&this._childs.concat()},getChild:function(a){return this._childs?this._childs[a]:null},getChildIndex:function(a){return this._childs?this._childs.indexOf(a):-1},contains:function(a){return this._childs?this._childs.indexOf(a)>INIT_INDEX:!1},_calcOuterSpace:function(a){var a=getComputedStyle(this._element,null);"border-box"!=a["box-sizing"]&&"border-box"!=a["-webkit-box-sizing"]&&"border-box"!=a["-moz-box-sizing"]&&(this._spaceWidth=_forceInt(a.getPropertyValue("border-left-width"))+_forceInt(a.getPropertyValue("border-right-width"))+_forceInt(a.getPropertyValue("padding-left"))+_forceInt(a.getPropertyValue("padding-right"))+_forceInt(a.getPropertyValue("margin-left"))+_forceInt(a.getPropertyValue("margin-right")),this._spaceHeight=_forceInt(a.getPropertyValue("border-top-width"))+_forceInt(a.getPropertyValue("border-bottom-width"))+_forceInt(a.getPropertyValue("padding-top"))+_forceInt(a.getPropertyValue("padding-bottom"))+_forceInt(a.getPropertyValue("margin-top"))+_forceInt(a.getPropertyValue("margin-bottom")))},setParentElement:function(a){this._parentElement=a},addChild:function(a,b){a instanceof VisualElement&&!this.contains(a)&&(this._childs||(this._childs=[]),b?b.appendChild(a._element):this._element&&this._element.appendChild(a._element),this._childs.push(a),a.setParentElement(b||this._element),a.setParent(this))},insertChildAt:function(a,b){b<this._childs.length?a instanceof VisualElement&&!this.contains(a)&&(this._childs||(this._childs=[]),this._element.insertBefore(a._element,this._childs[b]._element),this._childs.splice(b,0,a)):this.addChild(a)},moveChildTo:function(a,b){if(b>=-1&&b<this._childs.length){var c=this._childs.indexOf(a);if(b!=c){if(this._element.removeChild(a._element),-1==b)this._element.appendChild(a._element),b=this._childs.length;else{var d=this._childs[b]._element;this._element.insertBefore(a._element,d)}this._childs.splice(b,0,this._childs.splice(c,1)[0])}}},removeChild:function(a){if(a&&this._childs){var b=this._childs.indexOf(a);if(b>INIT_INDEX)return this.removeChildAt(b)}return null},removeChildAt:function(a){if(a>INIT_INDEX&&a<this.childCount()){var b=this._childs[a];this._element&&b._element&&this._element.removeChild(b._element),b._parnet=null,this._childs.splice(a,1)}},clear:function(){var a,b=this._childs,c=b?b.length:0;if(!this._childFixed&&c>0){for(a=0;c>a;a++)b[a].destroy();this._childs=[]}},right:function(){return this._left+this._width},bottom:function(){return this._top+this._height},position:function(){return{x:this._left,y:this._top}},bounds:function(){return new Rectangle(this._left,this._top,this._width,this._height)},clientRect:function(){return new Rectangle(0,0,this._width,this._height)},getBounds:function(a){return a?a.set(this._left,this._top,this._width,this._height):new Rectangle(this._left,this._top,this._width,this._height)},getClientRect:function(a){return a?a.set(0,0,this._width,this._height):new Rectangle(0,0,this._width,this._height)},containsInBounds:function(a,b){return a>=this._left&&a<this.right()&&b>=this._top&&b<this.bottom()},containsChildInBound:function(a){return a.right()>=0&&a.bottom()>=0&&a.left()<=this.width()&&a.top()<=this.height()},containsInClient:function(a,b){return a>INIT_INDEX&&a<this._width&&b>INIT_INDEX&&b<this._height},translateBy:function(a,b){var c=a;for(b||(b=new Rectangle(0,0,this._width,this._height));c&&c!==this;)b.x-=c._left,b.y-=c._top,c=c._parent;return b},topBy:function(a,b){for(var c=this._top+b,d=this._parent;d&&d!==a;)c+=d._top,d=d._parent;return c},boundsBy:function(a,b){var c=this._left,d=this._top,e=this._parent;for(b&&(c+=b.x,d+=b.y);e&&e!==a;)c+=e._left,d+=e._top,e=e._parent;return b?new Rectangle(c,d,b.width,b.height):new Rectangle(c,d,this._width,this._height)},boundsByContainer:function(a){var b=this._left,c=this._top;a&&(b+=a.x,c+=a.y);for(var d=this._parent;d&&d._left!==UNDEFINED;)b+=d._left,c+=d._top,d=d._parent;return a?new Rectangle(b,c,a.width,a.height):new Rectangle(b,c,this._width,this._height)},boundsByScreen:function(a){return a=this.boundsByContainer(a),a=this.container().toScreen(a)},move:function(a,b){this.setLeft(a),this.setTop(b)},offset:function(a,b){this.setLeft(this._left+a),this.setTop(this._top+b)},inflate:function(a,b){0!=a&&this.setWidth(this.width()+a),0!=b&&this.setHeight(this.height()+b)},shift:function(a,b){a&&(this.setLeft(this._left+a),this.setWidth(this._width-a)),b&&(this.setTop(this._top+b),this.setHeight(this._height-b))},resize:function(a,b){this.setWidth(a),this.setHeight(b)},setSize:function(a,b){this.setWidth(a),this.setHeight(b)},setPosition:function(a,b){this.setLeft(a),this.setTop(b)},setBounds:function(a,b,c,d,e,f){arguments.length>4&&(this._spaceWidth=e,this._spaceHeight=f),this.setLeft(a),this.setTop(b),this.setWidth(c),this.setHeight(d)},setBoundsI:function(a,b,c,d){this.setLeft(a>>0),this.setTop(b>>0),this.setWidth(c>>0),this.setHeight(d>>0)},setRect:function(a){this.setLeft(a.x),this.setTop(a.y),this.setWidth(a.width),this.setHeight(a.height)},setRectI:function(a){this.setLeft(_floor(a.x)),this.setTop(_floor(a.y)),this.setWidth(_floor(a.width)),this.setHeight(_floor(a.height))},layoutContent:function(a){this._doLayoutContent(a)},draw:function(){this._doDraw()},_doLayoutContent:function(a){},_doDraw:function(){this._doRender(this.clientRect())},_doRender:function(){},hitTest:function(a,b){return a>INIT_INDEX&&b>INIT_INDEX&&a<this._width&&b<this._height},clientToContainer:function(a,b){for(var c=this;c;)a+=c._left,b+=c._top,c=c._parent;return{x:a,y:b}},containerToClient:function(a,b){for(var c=this;c;)a-=c._left,b-=c._top,c=c._parent;return{x:a,y:b}},findChildAt:function(a,b,c){var d,e,f,g=this._childs,h=g?g.length:0;if(h>0)for(d=h-1;d>=0;d--)if(e=g[d],e.isVisible()&&(c||e._mouseEnabled)){var i,j,k=e._left,l=e._top;if("absolute"!=e._css.position){var m=e._element.getBoundingClientRect(),n=this._element.getBoundingClientRect();k=m.left-n.left,l=m.top-n.top,i=m.width,j=m.height}if(cx=a-k,cy=b-l,e.isLayer()||cx<i&&cy<j||e.hitTest(cx,cy)){if(f=e.findChildAt(cx,cy,c))return f;if(!e.isLayer()&&e._mouseEnabled&&!e._isContainer)return e}}return null}}),VisualElement$=VisualElement.prototype,OverflowContainer=defineClass("OverflowContainer",VisualElement,{init:function(){this._super(),this._isContainer=!0,this._css.position="absolute",this._css.overflow="hidden",this._css.pointerEvents="none",this._css.whiteSpace="nowrap"},destroy:function(){this._super()}}),PivotElement=defineClass("PivotElement",VisualElement,{init:function(a,b){this._super(),this._css.position="absolute",this._drawRect=new Rectangle,this._grid=a,this._options=a.tmpDisplayOptions(),this._cellSpaceWidth=this._options.cellSpaceWidth(),this._cellSpaceHeight=this._options.cellSpaceHeight(),this.setCssClass(b)},destroy:function(){this._drawRect=null,this._grid=null,this._super()},grid:function(){return this._grid},_doDraw:function(){this.getClientRect(this._drawRect),this._doRender(this._drawRect)},_doLayoutContent:function(a){this._layoutCells(a)},_layoutCells:function(a){this._clearCells()},_doRender:function(a){},_clearCells:function(){for(var a=this._childs.length;a--;)this._childs[a].destroy(),delete this._childs[a],this._childs[a]=null;this._childs=[]}}),ClickableElement=defineClass("ClickableElement",PivotElement,{init:function(a,b){this._super(a,b),this._request=null,this._tracker=null},destroy:function(){this._request&&(this._request.destroy(),this._request=null),this._tracker&&(this._tracker.destroy(),this._tracker=null),this._super()},enabled:!0,clickable:!0,rightClickable:!1,draggable:!1,click:function(a,b){this._enabled&&this._clickable&&this._doClick(a,b)},rightClick:function(){this._enabled&&this._rightClickable&&this._doRightClick(x,y)},getRequest:function(){return null},getTracker:function(){return null},_doClick:function(a,b){},_doRightClick:function(a,b){}}),CellIndex=defineClass("CellIndex",null,{init:function(a,b,c,d){this._super(),this._grid=a,this._columns=b,this._rows=c,this._valueField=d},destroy:function(){this._grid=null,this._columns=null,this._rows=null,this._super()},valueField:null,grid:function(){return this._grid},columns:function(){return this._columns},rows:function(){return this._rows},setColumns:function(a){a?this._columns=_clone(a):this._columns=null},setRows:function(a){a?this._rows=_clone(a):this._rows=null},toProxy:function(){return{columns:this._columns,rows:this._rows,valueField:this._valueField}}},{ATTR_ISSUM:"__sum",ATTR_VFIELD:"$valueField",$_temp:null,temp:function(a,b,c,d){return CellIndex.$_temp._grid=a,CellIndex.$_temp._columns=column,CellIndex.$_temp._rows=c,CellIndex.$_temp._valueField=d,CellIndex.$_temp},areEquals:function(a,b){return a&&b&&a._grid===b._grid&&a._valueField==b._valueField&&_equalsObj(a._columns,b._columns)&&_equalsObj(a._rows,b._column)}},function(a){a.$_temp=new a}),PivotOptions=defineClass("PivotOptions",null,{init:function(a){this.assign(a),this._super()},destroy:function(){this._super()}});ExpressionSyntaxError.prototype=new Error,ExpressionSyntaxError.prototype.constructor=ExpressionSyntaxError,ExpressionEvaluationError.prototype=new Error,ExpressionEvaluationError.prototype.constructor=ExpressionEvaluationError;var $$_createTokenArray=function(){for(var a=[],b=0;b<arguments.length;b++)a[arguments[b]]=!0;return a},TokenKind={Unknown:0,Add:1,Slash:2,Star:3,Minus:4,Plus:5,Identifier:10,And:11,In:12,Not:13,Div:14,Mod:15,Shl:16,Shr:17,Or:18,Xor:19,ToStr:20,ToNum:21,ToBool:23,Length:24,LengthBin:25,Is:26,IsNot:27,BraceClose:30,BraceOpen:31,Comma:32,CRLF:33,Null:34,Defined:35,Empty:36,NaN:37,Equal:40,Greater:41,GreaterEqual:42,Lower:43,LowerEqual:44,NotEqual:45,Like:46,NotLike:47,ILike:48,NotILike:49,Match:50,NotMatch:51,IMatch:52,NotIMatch:53,String:60,StringLiteral:61,Ascii:62,FloatLiteral:63,IntegerLiteral:64,Point:65,RoundOpen:66,RoundClose:67,DotDot:68,BracketOpen:69,BracketClose:70,Space:71,Symbol:80,ToDateStr:90,ToYear:91,ToMonth:92,ToDay:93,ToHour:94};TokenKind.IS_CHECK=$$_createTokenArray(TokenKind.Is,TokenKind.IsNot),TokenKind.IS_RELATIVE=$$_createTokenArray(TokenKind.Equal,TokenKind.NotEqual,TokenKind.Like,TokenKind.NotLike,TokenKind.ILike,TokenKind.NotILike,TokenKind.Match,TokenKind.NotMatch,TokenKind.IMatch,TokenKind.NotIMatch,TokenKind.Greater,TokenKind.GreaterEqual,TokenKind.Lower,TokenKind.LowerEqual),TokenKind.IS_ADDITIVE=$$_createTokenArray(TokenKind.Minus,TokenKind.Plus,TokenKind.Or,TokenKind.Xor),TokenKind.IS_MULTIPLICATIVE=$$_createTokenArray(TokenKind.And,TokenKind.Star,TokenKind.Slash,TokenKind.Div,TokenKind.Mod,TokenKind.Shl,TokenKind.Shr);var ExpressionLexer=function(){function a(){var a=L.charCodeAt(O);T=O,256>a?K[a]():j()}function b(){N=TokenKind.Symbol,O++}function c(){N=TokenKind.Comma,O++}function d(){N=TokenKind.CRLF,10==L.charCodeAt(O+1)?O+=2:O++,R++,S=O}function e(){N=TokenKind.CRLF,O++,R++,S=O}function f(){N=TokenKind.Equal,O++}function g(){"="==L.charAt(O+1)?(N=TokenKind.GreaterEqual,O+=2):(N=TokenKind.Greater,O++)}function h(){"="==L.charAt(O+1)?(N=TokenKind.LowerEqual,O+=2):">"==L.charAt(O+1)?(N=TokenKind.NotEqual,O+=2):(N=TokenKind.Lower,O++)}function i(){for(var a=O;M>a&&!A[L.charCodeAt(a)];)a++;for(var b=a;M>a&&A[L.charCodeAt(a)];)a++;return a>b?(Q=a,L.substr(b,a-b).toLowerCase()):null}function j(){for(var a=O;M>O&&(A[L.charCodeAt(O)]||L.charCodeAt(O)>255);)O++;var b=L.substr(a,O-a).toLowerCase();if(I.hasOwnProperty(b))switch(N=I[b]){case TokenKind.Not:if(b=i())switch(b){case"like":N=TokenKind.NotLike,O=Q;break;case"ilike":N=TokenKind.NotILike,O=Q;break;case"match":N=TokenKind.NotMatch,O=Q;break;case"imatch":N=TokenKind.NotIMatch,O=Q}break;case TokenKind.Is:b=i(),"not"==b&&(N=TokenKind.IsNot,O=Q)}else N=TokenKind.Identifier}function k(){for(N=TokenKind.IntegerLiteral,O++;M>O&&B[L.charCodeAt(O)];)O++}function l(){for(N=TokenKind.IntegerLiteral,O++;M>O&&C[L.charCodeAt(O)];){if("."==L.charAt(O)){if("."==L.charAt(O+1))break;N=TokenKind.FloatLiteral}O++}}function m(){N=TokenKind.Minus,O++}function n(){N=TokenKind.Plus,O++}function o(){var a=L.charAt(O+1);"."==a?(N=TokenKind.DotDot,O+=2):(N=TokenKind.Point,O++)}function p(){N=TokenKind.RoundOpen,O++}function q(){N=TokenKind.RoundClose,O++}function r(){N=TokenKind.Slash,O++}function s(){for(N=TokenKind.Space,O++;M>O&&D[L.charCodeAt(O)];)O++}function t(){N=TokenKind.BracketOpen,O++}function u(){N=TokenKind.BracketClose,O++}function v(){N=TokenKind.Star,O++}function w(){N=TokenKind.Mod,O++}function x(){N=TokenKind.StringLiteral;do{var a=L.charCodeAt(O);if(E[a])throw new ExpressionSyntaxError("Untermintated string",a);a==H&&O++,O++}while(M>O&&L.charCodeAt(O)!=F);O++}function y(){N=TokenKind.StringLiteral;do{var a=L.charCodeAt(O);if(E[a])throw new ExpressionSyntaxError("Untermintated string",a);a==H&&O++,O++}while(M>O&&L.charCodeAt(O)!=G);O++}function z(){var a;for(K=[],a=1;255>=a;a++)K[a]=b;for(a=1;32>=a;a++)K[a]=s;for(K[10]=e,K[13]=d,K["$".charCodeAt()]=k,K[F]=x,K[G]=y,a=0;9>=a;a++)K["0".charCodeAt()+a]=l;for(a="A".charCodeAt();a<="Z".charCodeAt();a++)K[a]=j;for(a="a".charCodeAt();a<="z".charCodeAt();a++)K[a]=j;K["_".charCodeAt()]=j,K["(".charCodeAt()]=p,K[")".charCodeAt()]=q,K["*".charCodeAt()]=v,K["+".charCodeAt()]=n,K[",".charCodeAt()]=c,K["-".charCodeAt()]=m,K[".".charCodeAt()]=o,K["/".charCodeAt()]=r,K["%".charCodeAt()]=w,K["<".charCodeAt()]=h,K["=".charCodeAt()]=f,K[">".charCodeAt()]=g,K["[".charCodeAt()]=t,K["]".charCodeAt()]=u}for(var A=[],B=[],C=[],D=[],E=[],F=0,G=0,H=0,I={},J=0;256>J;J++)A[J]=J=="_".charCodeAt()||J>="0".charCodeAt()&&J<="9".charCodeAt()||J>="a".charCodeAt()&&J<="z".charCodeAt()||J>="A".charCodeAt()&&J<="Z".charCodeAt(),B[J]=J>="0".charCodeAt()&&J<="9".charCodeAt()||J>="a".charCodeAt()&&J<="f".charCodeAt()||J>="A".charCodeAt()&&J<="F".charCodeAt(),C[J]=J>="0".charCodeAt()&&J<="9".charCodeAt()||J==".".charCodeAt()||J=="e".charCodeAt()||J=="E".charCodeAt(),D[J]=J>=1&&9>=J||11==J||J>=14&&32>=J,E[J]=0==J;F='"'.charCodeAt(),G="'".charCodeAt(),H="\\".charCodeAt(),I={},I.str=TokenKind.ToStr,I.num=TokenKind.ToNum,I.bool=TokenKind.ToBool,I.not=TokenKind.Not,I.len=TokenKind.Length,I.lenb=TokenKind.LengthBin,I.and=TokenKind.And,I["in"]=TokenKind.In,I.mod=TokenKind.Mod,I.or=TokenKind.Or,I.div=TokenKind.Div,I.shl=TokenKind.Shl,I.shr=TokenKind.Shr,I.xor=TokenKind.Xor,I.is=TokenKind.Is,I.like=TokenKind.Like,I.ilike=TokenKind.ILike,I.match=TokenKind.Match,I.imatch=TokenKind.IMatch,I.defined=TokenKind.Defined,I["null"]=TokenKind.Null,I.empty=TokenKind.Empty,I.nan=TokenKind.NaN,I.datestr=TokenKind.ToDateStr,I.year=TokenKind.ToYear,I.month=TokenKind.ToMonth,I.day=TokenKind.ToDay,I.hour=TokenKind.ToHour;var K=null,L=null,M=0,N=0,O=0,P=0,Q=0,R=0,S=0,T=0;this.tokenId=function(){return N},this.tokenLoc=function(){return{x:T-S,y:R}},this.tokenLen=function(){return O-T},this.token=function(){return L.substr(T,this.tokenLen())},this.isSpace=function(){return N==TokenKind.Space},this.init=function(a){L=a,M=a.length,_origin=0,R=0,S=0,T=0,P=O=0,N=0},this.charAhread=function(){for(P=O;M>P&&L.charCodeAt(P)>0&&L.charCodeAt(P)<=32;)P++;return L.charCodeAt(this._runAhead)},this.nextId=function(b){do a();while(M>O&&N!=b)},this.nextNoSpace=function(){if(M>O)do a();while(M>O&&this.isSpace())},this.isFirstInLine=function(){if(0==T)return!0;var a,b=T;for(b--;b>0&&D[L.charCodeAt(b)];)b--;return 0==b?!0:(a=L.charCodeAt(b),10==a||13==a?!0:!1)},z()},ExpressionNode=defineClass("ExpressionNode",null,{init:function(){this._super()},_asLiteral:function(){return null},evaluate:function(){throwAbstractError()},toString:function(){return String(this)}}),EmptyExpressionNode=defineClass("EmptyExpressionNode",ExpressionNode,{init:function(){this._super()},_asLiteral:function(){return null},evaluate:function(){return void 0},toString:function(){return""}},null,function(a){a.Default=new a}),ExpressionNodeImpl=defineClass("ExpressionNodeImpl",ExpressionNode,{init:function(){this._super(),this.leftExpr=null,this.rightExpr=null,this.operator=TokenKind.Unknown,this._literal=null},evaluate:function(a){if(this._literal)return this._literal.value();if(!this.rightExpr)return this.leftExpr.evaluate(a);var b=this.leftExpr.evaluate(a),c=this.rightExpr.evaluate(a);switch(this.operator){case TokenKind.Equal:return b==c;case TokenKind.NotEqual:return b!=c;case TokenKind.Greater:return b>c;case TokenKind.GreaterEqual:return b>=c;case TokenKind.Lower:return c>b;case TokenKind.LowerEqual:return c>=b;case TokenKind.Like:return this._calcLike(b,c,!1);case TokenKind.NotLike:return!this._calcLike(b,c,!1);case TokenKind.ILike:return this._calcLike(b,c,!0);case TokenKind.NotILike:return!this._calcLike(b,c,!0);case TokenKind.Match:return this._calcMatch(b,c,!1);case TokenKind.NotMatch:return!this._calcMatch(b,c,!1);case TokenKind.IMatch:return this._calcMatch(b,c,!0);case TokenKind.NotIMatch:return!this._calcMatch(b,c,!0);default:throw new ExpressionEvaluationError("Unknown operator: "+operator)}},toString:function(){var a="";if(this._literal)a=this._literal.toString();else if(this.rightExpr){var b,c=this.leftExpr.toString(),d=this.rightExpr.toString();switch(this.operator){case TokenKind.Equal:b="=";break;case TokenKind.NotEqual:b="<>";break;case TokenKind.Greater:b=">";break;case TokenKind.GreaterEqual:b=">=";break;case TokenKind.Lower:b="<";break;case TokenKind.LowerEqual:b="<=";break;case TokenKind.Like:b="like";break;case TokenKind.NotLike:b="not like";break;case TokenKind.ILike:b="ilike";break;case TokenKind.NotILike:b="not ilike";break;case TokenKind.Match:b="match";break;case TokenKind.NotMatch:b="not match";break;case TokenKind.IMatch:b="imatch";break;case TokenKind.NotIMatch:b="not imatch";break;default:b="<<ERROR>>"}a="("+c+" "+b+" "+d+")"}else a=this.leftExpr.toString();return a},isIdentifier:function(a){return this.leftExpr&&!this.rightExpr&&this.leftExpr.isIdentifier(a)},_prepareValue:function(){this.leftExpr._prepareValue(),null==this.rightExpr?this._literal=this.leftExpr._getLiteral():this.rightExpr._prepareValue()},_getLiteral:function(){return this._literal},_calcLike:function(a,b,c){var d=String(a),e=String(b);if(d&&e){c&&(d=d.toLowerCase(),e=e.toLowerCase());var f=e.length;if(f>1){var g="%"==e.charAt(0),h="%"==e.charAt(f-1);return g&&h?(e=e.substr(1,f-2),d.indexOf(e,0)>=0):g?(e=e.substr(1,f-1),f=d.length,d.lastIndexOf(e,f-1)==f-1):h?(e=e.substr(0,f-1),0==d.indexOf(e,0)):d==e}return"%"==e?!1:d==e}return!1},_calcMatch:function(a,b,c){var d=new RegExp(b,"m"+(c?"i":""));return d.test(a)}}),CheckableNode=defineClass("DefinedNode",ExpressionNode,{init:function(){this._super()}}),DefinedNode=defineClass("DefinedNode",CheckableNode,{init:function(){this._super()},value:function(){return UNDEFINED},_asLiteral:function(){return this},evaluate:function(a){return UNDEFINED},toString:function(){return"defined"}}),EmptyNode=defineClass("EmptyNode",CheckableNode,{init:function(){this._super()},value:function(){return UNDEFINED},_asLiteral:function(){return this},evaluate:function(a){return UNDEFINED},toString:function(){return"empty"}}),NullNode=defineClass("NullNode",CheckableNode,{init:function(){this._super()},value:function(){return UNDEFINED},_asLiteral:function(){return this},evaluate:function(a){return null},toString:function(){return"null"}}),NanNode=defineClass("NanNode",CheckableNode,{init:function(){this._super()},value:function(){return NaN},_asLiteral:function(){return this},evaluate:function(a){return NaN},toString:function(){return"NaN"}}),CheckNode=defineClass("CheckNode",ExpressionNodeImpl,{init:function(a,b,c){this._super(),this.leftExpr=a,this.operator=b,this._isNot=b==TokenKind.IsNot,this._value=-1,c instanceof DefinedNode?this._value=CheckNode.DEFINED:c instanceof NullNode?this._value=CheckNode.NULL:c instanceof EmptyNode?this._value=CheckNode.EMPTY:c instanceof NanNode&&(this._value=CheckNode.NAN)},_prepareValue:function(){this.leftExpr._prepareValue(),this._literal=this.leftExpr._getLiteral()},_getLiteral:function(){return null},evaluate:function(a){var b,c=this._literal?this._literal.value():this.leftExpr.evaluate(a);switch(this._value){case CheckNode.DEFINED:b=c!==UNDEFINED;break;case CheckNode.NULL:b=c===UNDEFINED||null===c;break;case CheckNode.EMPTY:b=c===UNDEFINED||null===c||0==String(c).length;break;case CheckNode.NAN:b=null===c||isNaN(c);break;default:return UNDEFINED}return this._isNot?!b:b},toString:function(){var a="<<ERROR>>";switch(this._value){case CheckNode.DEFINED:a="defined";break;case CheckNode.NULL:a="null";break;case CheckNode.EMPTY:a="empty";break;case CheckNode.NAN:a="NaN"}return"("+((this._isNot?"is not ":"is ")+a)+")"}},{DEFINED:0,NULL:1,EMPTY:2,NAN:3}),FloatLiteralNode=defineClass("FloatLiteralNode",ExpressionNode,{init:function(a){this._super(),this._value=Number(a)},value:function(){return this._value},_asLiteral:function(){return this},evaluate:function(a){return this._value},toString:function(){return String(this._value)}}),IntegerLiteralNode=defineClass("IntegerLiteralNode",ExpressionNode,{init:function(a){this._super(),this._value=parseInt(a)},value:function(){return this._value},_asLiteral:function(){return this},evaluate:function(a){return this._value},toString:function(){return String(this._value)}}),StringLiteralNode=defineClass("StringLiteralNode",ExpressionNode,{init:function(a){this._super(),this._value=a.substr(1,a.length-2);for(var b="",c=0,d=!1;c<this._value.length;)"\\"!=this._value[c]||d?(d=!1,b+=this._value[c++]):(d=!0,c++);this._value=b},value:function(){return this._value},_asLiteral:function(){return this},evaluate:function(a){return this._value},toString:function(){return this._value}}),IdentifierNode=defineClass("IdentifierNode",ExpressionNode,{init:function(a){this._super(),this._literal=a,this._idKey=-651212},identifier:function(){return this._literal},evaluate:function(a){return-651212==this._idKey&&(this._idKey=a.isIdentifier(this._literal)),a.evaluateIdentifier(this._idKey)},toString:function(){return this._literal}}),IndexerNode=defineClass("IndexerNode",ExpressionNode,{init:function(a,b,c){this._super(),this._ident=a,this._indexer=b,this._capital=c,this._idKey=-1490313,this._intIndex=NaN,this._strIndex=null},_prepareValue:function(){var a=null,b=this._indexer._asLiteral();if(b||(a=this._indexer._prepareValue&&this._indexer,a&&(a._prepareValue(),b=a._getLiteral())),b){var c=b.value();"string"==typeof c?this._strIndex=c:this._intIndex=parseInt(c),this._capital&&this._strIndex&&(this._strIndex=this._strIndex.toUpperCase())}},_getLiteral:function(){return null},evaluate:function(a){if(-1490313==this._idKey&&(this._idKey=a.isIdentifier(this._ident)),this._strIndex)return a.evaluateIndexerS(this._idKey,this._strIndex,this._capital);if(isNaN(this._intIndex)){var b=this._indexer.evaluate(a);return"string"==typeof b?a.evaluateIndexerS(this._idKey,b,this._capital):a.evaluateIndexerI(this._idKey,b)}return a.evaluateIndexerI(this._idKey,this._intIndex)},toString:function(){var a=this._ident+"["+this._indexer.toString()+"]";return a}}),UnaryNode=defineClass("UnaryNode",ExpressionNode,{init:function(a){this._super(),this._factor=a,this._literal=null},_prepareValue:function(){this._literal=this._factor._asLiteral(),!this._literal&&this._factor._prepareValue&&(this._factor._prepareValue(),this._literal=this._factor._getLiteral())},_getLiteral:function(){return null}}),LenNode=defineClass("LenNode",UnaryNode,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return b?b.length:0},toString:function(){return"(len "+this._factor+")"}}),MinusNode=defineClass("MinusNode",UnaryNode,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return-b},toString:function(){return"-"+this._factor}}),PlusNode=defineClass("PlusNode",UnaryNode,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return b},toString:function(){return"+"+this._factor}}),NotNode=defineClass("NotNode",UnaryNode,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return!b},toString:function(){return"(not "+this._factor+")"}}),ToBoolNode=defineClass("ToBoolNode",UnaryNode,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return Boolean(b)},toString:function(){return"(bool "+this._factor+")"}}),ToNumberNode=defineClass("ToNumberNode",UnaryNode,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return Number(b)},toString:function(){return"(num "+this._factor+")"}}),ToStringNode=defineClass("ToStringNode",UnaryNode,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return String(b)},toString:function(){return"(str "+this._factor+")"}}),ToDateStringNode=defineClass("ToDateStringNode",UnaryNode,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return b instanceof Date&&(b=_pad(b.getFullYear(),4)+_pad(b.getMonth()+1,2)+_pad(b.getDate(),2)+_pad(b.getHours(),2)+_pad(b.getMinutes(),2)+_pad(b.getSeconds(),2)+_pad(b.getMilliseconds(),3)),
String(b)},toString:function(){return"(datestr "+this._factor+")"}}),ToYearNode=defineClass("ToYearNode",UnaryNode,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return b instanceof Date?b.getFullYear():null},toString:function(){return"(year "+this._factor+")"}}),ToMonthNode=defineClass("ToMonthNode",UnaryNode,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return b instanceof Date?b.getMonth()+1:null},toString:function(){return"(month "+this._factor+")"}}),ToDayNode=defineClass("ToDayNode",UnaryNode,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return b instanceof Date?b.getDate():null},toString:function(){return"(day "+this._factor+")"}}),ToHourNode=defineClass("ToHourNode",UnaryNode,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return b instanceof Date?b.getHours():null},toString:function(){return"(hour "+this._factor+")"}}),TermNode=defineClass("TermNode",ExpressionNode,{init:function(){this._super(),this._factors=[],this._operators=[],this._literal=null},addFactor:function(a){this._factors.push(a)},addOperator:function(a){this._operators.push(a)},isIdentifier:function(a){return 1==this._factors.length&&this._factors[0]instanceof IdentifierNode&&this._factors[0].identifier()==a},_prepareValue:function(){var a,b,c;for(a=0,b=this._factors.length;b>a;a++)c=this._factors[a],c._prepareValue&&c._prepareValue();0==this._operators.length&&(c=this._factors[0],this._literal=c._asLiteral(),!this._literal&&c._prepareValue&&(this._literal=c._getLiteral()))},_getLiteral:function(){return this._literal},evaluate:function(a){if(this._literal)return this._literal.value();var b,c,d=this._factors.length,e=this._factors[0].evaluate(a);for(b=1;d>b;b++)switch(c=this._factors[b].evaluate(a),this._operators[b-1]){case TokenKind.And:e=e&&c;break;case TokenKind.Star:e*=c;break;case TokenKind.Slash:e/=c;break;case TokenKind.Div:e=_int(_int(e)/_int(c));break;case TokenKind.Mod:e%=c;break;case TokenKind.Shl:e<<=c;break;case TokenKind.Shr:e>>=c}return e},toString:function(){var a="";if(this._literal)a=this._literal.toString();else if(1==this._factors.length)a=this._factors[0].toString();else{var b,c=this._factors.length;for(a="("+this._factors[0].toString(),b=1;c>b;b++){switch(this._operators[b-1]){case TokenKind.And:a+=" and ";break;case TokenKind.Star:a+=" * ";break;case TokenKind.Slash:a+=" / ";break;case TokenKind.Div:a+=" / ";break;case TokenKind.Mod:a+=" mod ";break;case TokenKind.Shl:a+=" shl ";break;case TokenKind.Shr:a+=" shr "}a+=this._factors[b].toString()}a+=")"}return a}}),SimpleExpressioNode=defineClass("SimpleExpressioNode",ExpressionNode,{init:function(){this._super(),this._terms=[],this._operators=[],this._literal=null},addTerm:function(a){this._terms.push(a)},addOperator:function(a){this._operators.push(a)},isIdentifier:function(a){return 1==this._terms.length&&this._terms[0].isIdentifier(a)},_prepareValue:function(){var a,b;for(a=0,b=this._terms.length;b>a;a++)this._terms[a]._prepareValue();0==this._operators.length&&(this._literal=this._terms[0]._getLiteral())},_getLiteral:function(){return this._literal},evaluate:function(a){if(this._literal)return this._literal.value();var b,c,d=this._terms.length,e=this._terms[0].evaluate(a);for(b=1;d>b;b++)switch(c=this._terms[b].evaluate(a),this._operators[b-1]){case TokenKind.Minus:e-=c;break;case TokenKind.Plus:e+=c;break;case TokenKind.Or:e=e||c;break;case TokenKind.Xor:e^=c}return e},toString:function(){var a="";if(this._literal)a=this._literal.toString();else if(1==this._terms.length)a=this._terms[0].toString();else{var b,c=this._terms.length;for(a="("+this._terms[0].toString(),b=1;c>b;b++){switch(this._operators[b-1]){case TokenKind.Minus:a+=" - ";break;case TokenKind.Plus:a+=" + ";break;case TokenKind.Or:a+=" or ";break;case TokenKind.Xor:a+=" xor ";break;default:a+=" <<ERROR>> "}a+=this._terms[b].toString()}a+=")"}return a}}),ExpressionParser=function(){function a(a){if(a!=D.tokenId())throw new ExpressionSyntaxError("Token is not a expected kind ["+a+"]: "+D.tokenId(),D.tokenLoc());b()}function b(){D.nextNoSpace()}function c(){var a,c,e,f=null,g=d();if(TokenKind.IS_CHECK[e=D.tokenId()]){if(b(),a=d(),a._prepareValue(),c=_cast(a._getLiteral(),CheckableNode),!c)throw new ExpressionSyntaxError("is operator's operand must be defined, null or empty: "+D.tokenId());f=new CheckNode(g,e,c)}else f=new ExpressionNodeImpl,f.leftExpr=g,TokenKind.IS_RELATIVE[D.tokenId()]&&(f.operator=D.tokenId(),b(),f.rightExpr=d());return f}function d(){var a=new SimpleExpressioNode;for(a.addTerm(e());TokenKind.IS_ADDITIVE[D.tokenId()];)a.addOperator(D.tokenId()),b(),a.addTerm(e());return a}function e(){var a=new TermNode;for(a.addFactor(f());TokenKind.IS_MULTIPLICATIVE[D.tokenId()];)a.addOperator(D.tokenId()),b(),a.addFactor(f());return a}function f(){var a=D.tokenId();switch(a){case TokenKind.StringLiteral:return g();case TokenKind.RoundOpen:return h();case TokenKind.Identifier:return i();case TokenKind.IntegerLiteral:return k();case TokenKind.FloatLiteral:return j();case TokenKind.Minus:return l();case TokenKind.Plus:return m();case TokenKind.Not:return n();case TokenKind.Defined:return o();case TokenKind.Null:return p();case TokenKind.Empty:return q();case TokenKind.NaN:return r();case TokenKind.ToBool:return s();case TokenKind.ToNum:return t();case TokenKind.ToStr:return u();case TokenKind.Length:return v();case TokenKind.LengthBin:return w();case TokenKind.ToDateStr:return x();case TokenKind.ToYear:return y();case TokenKind.ToMonth:return z();case TokenKind.ToDay:return A();case TokenKind.ToHour:return B()}throw new ExpressionSyntaxError("Unkown token: "+a)}function g(){var a=D.token();return b(),new StringLiteralNode(a)}function h(){b();var d=c();return a(TokenKind.RoundClose),d}function i(){var d=D.token();if(b(),D.tokenId()==TokenKind.BracketOpen){b();var e=c();return a(TokenKind.BracketClose),new IndexerNode(d,e,C.indexOf(d)>=0)}return new IdentifierNode(d)}function j(){var a=D.token();return b(),new FloatLiteralNode(a)}function k(){var a=D.token();return b(),new IntegerLiteralNode(a)}function l(){return b(),new MinusNode(f())}function m(){return b(),new PlusNode(f())}function n(){return b(),new NotNode(f())}function o(){return b(),new DefinedNode}function p(){return b(),new NullNode}function q(){return b(),new EmptyNode}function r(){return b(),new NanNode}function s(){return b(),new ToBoolNode(f())}function t(){return b(),new ToNumberNode(f())}function u(){return b(),new ToStringNode(f())}function v(){return b(),new LenNode(f())}function w(){return b(),new LenBinNode(f())}function x(){return b(),new ToDateStringNode(f())}function y(){return b(),new ToYearNode(f())}function z(){return b(),new ToMonthNode(f())}function A(){return b(),new ToDayNode(f())}function B(){return b(),new ToHourNode(f())}var C=null,D=new ExpressionLexer;this.parse=function(a,d){if(!a)return null;C=d||[],D.init(a),b();var e=c();return e&&e._prepareValue(),e},this.evaluate=function(a,b,c){var d=this.parse(a,c);return d.evaluate(b)}};ExpressionParser.Default=new ExpressionParser;var ExpressionRuntime=defineClass("ExpressionRuntime",null,{init:function(){this._super()},isIdentifier:function(a){throw new Error("Token is not a valid Identifier: "+a)},evaluateIdentifier:function(a){throw new Error("Invalid identifier key: "+a)},evaluateIndexerI:function(a,b){throw new Error("Invalid identifier indexer: "+a)},evaluateIndexerS:function(a,b){throw new Error("Invalid identifier indexer: "+a)}}),FilterRuntime=defineClass("FilterRuntime",ExpressionRuntime,{init:function(){this._super(),this._value=null},setData:function(a){this._value=a},isIdentifier:function(a){return a=a.toLowerCase(),FilterRuntime.IDENTS.hasOwnProperty(a)?FilterRuntime.IDENTS[a]:this._super(a)},evaluateIdentifier:function(a){switch(a){case FilterRuntime.ID_VALUE:return this._value}throw new ExpressionEvaluationError("Invalid identifier key: "+a)}},{ID_VALUE:0},function(a){a.IDENTS={value:a.ID_VALUE}}),$$_XML_HEAD='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',_excelColCaption=function(a){for(var b="",c=a+1,d=1,e=26;(c-=d)>=0;d=e,e*=26)b=String.fromCharCode(parseInt(c%e/d)+65)+b;return b},_formatIndentXml=function(a){var b="",c=/(>)(<)(\/*)/g;a=a.replace(c,"$1\r\n$2$3");for(var d=0,e=a.split("\r\n"),f=0,g=e.length;g>f;f++){var h=e[f],i=0;h.match(/.+<\/\w[^>]*>$/)?i=0:h.match(/^<\/\w/)?0!=d&&(d-=1):i=h.match(/^<\w[^>]*[^\/]>.*$/)?1:0;for(var j="",k=0;d>k;k++)j+="  ";b+=j+h+"\r\n",d+=i}return b},ExcelStrings=defineClass("ExcelStrings",null,{init:function(a){this._super(),this._workbook=a,this._nextId=0,this._count=0,this._stringMap={},this._strings=[]},count:function(){return this._count},uniqueCount:function(){return this._nextId},add:function(a){this._count++;var b=this._stringMap[a];return void 0===b&&(b=this._nextId++,this._stringMap[a]=b,this._strings[b]=a),b},getIndex:function(a){return this._stringMap[a]},createPart:function(){var a='<sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"></sst>',b=_parseXml(a),c=b.documentElement,d=/^\s|\s$/;c.setAttribute("count",this._count),c.setAttribute("uniqueCount",this._nextId);for(var e=0,f=this._strings.length;f>e;e++){var g=b.createElement("si");c.appendChild(g);var h=b.createElement("t");g.appendChild(h);var i=b.createTextNode(this._strings[e]);h.appendChild(i),d.test(this._strings[e])?h.setAttribute("xml:space","preserve"):null}return a=$$_XML_HEAD+_xmlToStr(b),$_debug?_formatIndentXml(a):a}}),ExcelFont=function(){this.id=void 0,this.name="Tahoma",this.size=10,this.color="ff000000",this.bold=!1,this.italic=!1,this.scheme=void 0};ExcelFont.prototype.serialize=function(a,b){_addChildWithAttr(a,b,"sz","val",this.size||10),_addChildWithAttr(a,b,"name","val",this.name||"Calibri"),_addChildWithAttr(a,b,"color","rgb",this.color||"ff000000"),_addChildWithAttr(a,b,"b","val",this.bold?"true":"false"),_addChildWithAttr(a,b,"i","val",this.italic?"true":"false")};var ExcelFill=function(){this.id=void 0,this.patternType="none",this.color=void 0,this.gradient=void 0,this.color2=void 0,this.degree="90",this.tint=0,this.serialize=function(a,b){var c;if("linear"==this.gradient){var d=a.createElement("gradientFill");b.appendChild(d),d.setAttribute("degree",this.degree);var e=a.createElement("stop");d.appendChild(e),e.setAttribute("position","0"),c=a.createElement("color"),e.appendChild(c),c.setAttribute("rgb",this.color),c.setAttribute("tint",this.tint),e=a.createElement("stop"),d.appendChild(e),e.setAttribute("position","1"),c=a.createElement("color"),e.appendChild(c),c.setAttribute("rgb",this.color2),c.setAttribute("tint",this.tint)}else{var f=a.createElement("patternFill");b.appendChild(f),f.setAttribute("patternType",this.patternType),"none"!=this.patternType&&(c=a.createElement("fgColor"),f.appendChild(c),c.setAttribute("rgb",this.color),c.setAttribute("tint",this.tint))}}},ExcelBorder=function(){this.id=void 0,this.left=void 0,this.right=void 0,this.top=void 0,this.bottom=void 0};ExcelBorder.prototype.serialize=function(a,b){this.serializeBorder(a,b,"left"),this.serializeBorder(a,b,"right"),this.serializeBorder(a,b,"top"),this.serializeBorder(a,b,"bottom")},ExcelBorder.prototype.serializeBorder=function(a,b,c){var d=a.createElement(c);if(b.appendChild(d),c=this[c],c&&c._width>0){d.setAttribute("style","thin");var e=a.createElement("color");d.appendChild(e),e.setAttribute("rgb",c._color.toColorHex())}};var ExcelStyle=function(){this.id=void 0,this.horzAlign=ExcelStyle.ALIGN_NEAR,this.vertAlign=ExcelStyle.VALIGN_CENTER,this.wrapText=!1,this.formatId=0,this.font=null,this.fill=null,this.border=null,this.xfId=0};ExcelStyle.ALIGN_NEAR="left",ExcelStyle.ALIGN_CENTER="center",ExcelStyle.ALIGN_FAR="right",ExcelStyle.VALIGN_NEAR="top",ExcelStyle.VALIGN_CENTER="center",ExcelStyle.VALIGN_FAR="bottom",ExcelStyle.prototype.clone=function(){var a=new ExcelStyle;for(var b in this)this.hasOwnProperty(b)&&(a[b]=this[b]);return a.id=void 0,a},ExcelStyle.prototype.serialize=function(a,b){this.border&&b.setAttribute("borderId",this.border?this.border.id:"0"),this.fill&&b.setAttribute("fillId",this.fill?this.fill.id:"0"),this.font&&b.setAttribute("fontId",this.font?this.font.id:"0"),b.setAttribute("numFmtId",this.formatId),b.setAttribute("xfId","0");var c=a.createElement("alignment");b.appendChild(c),c.setAttribute("horizontal",this.horzAlign),c.setAttribute("vertical",this.vertAlign),this.wrapText&&c.setAttribute("wrapText","1")},$$_EXCEL_NUMFMT_START=200;var ExcelStyles=defineClass("ExcelStyles",null,{init:function(a){this._super(),this._book=a,this._fonts=[],this._fills=[],this._borders=[],this._numFormats=[],this._xfs=[];var b=new ExcelFill;this._fills.push(b,b);var c=new ExcelBorder;this._borders.push(c);var d=new ExcelFont;this._fonts.push(d);var e=new ExcelStyle;this._xfs.push(e)},addFont:function(a){return a?(this._fonts.push(a),a.id=this._fonts.length-1):0},addFill:function(a){return a?(this._fills.push(a),a.id=this._fills.length-1):0},addBorder:function(a){return a?(this._borders.push(a),a.id=this._borders.length-1):0},addNumberFormat:function(a){var b=this._numFormats.indexOf(a);return 0>b&&(this._numFormats.push(a),b=this._numFormats.length-1),$$_EXCEL_NUMFMT_START+b},add:function(a){return a?(this._xfs.push(a),a.id=this._xfs.length-1):0},createPart:function(){var a='<styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"></styleSheet>',b=_parseXml(a),c=b.documentElement;if(this._numFormats.length>0){var d=b.createElement("numFmts");c.appendChild(d),this.$_createNumberFormats(b,d)}var e=b.createElement("fonts");c.appendChild(e),this.$_createFonts(b,e);var f=b.createElement("fills");c.appendChild(f),this.$_createFills(b,f);var g=b.createElement("borders");c.appendChild(g),this.$_createBorders(b,g);var h=b.createElement("cellStyleXfs");c.appendChild(h),this.$_createDefXfs(b,h);var i=b.createElement("cellXfs");return c.appendChild(i),this.$_createXfs(b,i),a=$$_XML_HEAD+_xmlToStr(b),$_debug?_formatIndentXml(a):a},$_createNumberFormats:function(a,b){for(var c=0,d=this._numFormats.length;d>c;c++){var e=a.createElement("numFmt");_setXmlAttr(e,"formatCode",this._numFormats[c]),_setXmlAttr(e,"numFmtId",$$_EXCEL_NUMFMT_START+c),b.appendChild(e)}},$_createFonts:function(a,b){if(this._fonts.length<1){var c=new ExcelFont;this._fonts.push(c)}for(var d=0,e=this._fonts.length;e>d;d++){var f=a.createElement("font");this._fonts[d].serialize(a,f),b.appendChild(f)}b.setAttribute("count",this._fonts.length)},$_createFills:function(a,b){if(this._fills.length<1){var c=new ExcelFill;this._fills.push(c)}for(var d=0,e=this._fills.length;e>d;d++){var f=a.createElement("fill");this._fills[d].serialize(a,f),b.appendChild(f)}b.setAttribute("count",this._fills.length)},$_createBorders:function(a,b){if(this._borders.length<1){var c=new ExcelBorder;this._borders.push(c)}for(var d=0,e=this._borders.length;e>d;d++){var f=a.createElement("border");this._borders[d].serialize(a,f),b.appendChild(f)}b.setAttribute("count",this._borders.length)},$_createDefXfs:function(a,b){var c=a.createElement("xf");b.appendChild(c),c.setAttribute("borderId",0),c.setAttribute("fillId",0),c.setAttribute("fontId",0),c.setAttribute("numFmtId",0),b.setAttribute("count",1)},$_createXfs:function(a,b){if(this._xfs.length<1){var c=new ExcelStyle;this._xfs.push(c)}for(var d=0,e=this._xfs.length;e>d;d++){var f=this._xfs[d],g=a.createElement("xf");f.serialize(a,g),b.appendChild(g)}b.setAttribute("count",this._xfs.length)}}),ExcelColumn=function(){this.index=void 0,this.width=10,this.style=null,this.serialize=function(a,b){b.setAttribute("min",this.index),b.setAttribute("max",this.index),b.setAttribute("width",this.width),this.style&&b.setAttribute("style",this.style.id)}},ExcelSheet=defineClass("ExcelSheet",null,{init:function(a){this._super(),this._book=a,this._columns=null,this._doc=null,this._viewRoot=null,this._dataRoot=null,this._mergeRoot=null,this._rows=[],this._mergeCount=0,this._outlineLevel=0,this.$_preparePart(),this._dateConverter=DatetimeConverter.Default},colCount:function(){return this._columns.length},rowCount:function(){return this._rows.length},setColumns:function(a){this._columns=a},addRow:function(a,b){var c=this._rows[a];if(!c){var c=this._doc.createElement("row");c.setAttribute("r",a+1),b&&b>-1&&(c.setAttribute("ht",b),c.setAttribute("customHeight","1")),this._rows[a]=c,this._dataRoot.appendChild(c)}return c},setRowLevel:function(a,b){if(b>=0){var c=this._rows[a];c&&(c.setAttribute("outlineLevel",b),this._outlineLevel=Math.max(b,this._outlineLevel))}},addBlank:function(a,b,c){var d=this.addRow(a),e=this._doc.createElement("c");e.setAttribute("r",_excelColCaption(b)+(a+1)),c&&e.setAttribute("s",c.id),d.appendChild(e)},addMerge:function(a,b,c,d){var e=_excelColCaption(b)+(a+1)+":"+_excelColCaption(b+d-1)+(a+c),f=this._doc.createElement("mergeCell");f.setAttribute("ref",e),this._mergeRoot.appendChild(f),this._mergeCount++},$_addCell:function(a,b,c,d,e,f){var g=this.addRow(a,f),h=this._doc.createElement("c");h.setAttribute("r",_excelColCaption(b)+(a+1)),h.setAttribute("t",c),e&&h.setAttribute("s",e.id),g.appendChild(h);var i=this._doc.createElement("v");i.appendChild(this._doc.createTextNode(d)),h.appendChild(i)},addText:function(a,b,c,d,e){var f=void 0!==c&&null!==c?c:"";f=this._book.addString(f),this.$_addCell(a,b,"s",f,d,e)},addNumber:function(a,b,c,d,e,f){var g=isNaN(c)?"":String(c);this.$_addCell(a,b,"n",g,d)},addBool:function(a,b,c,d,e,f){this.$_addCell(a,b,"b",c?1:0,d)},addDate:function(a,b,c,d,e,f,g){if(c)if(g){var h=this._dateConverter.toExcelDate(c);this.addNumber(a,b,h,d)}else{var i=this.$_dateToStr(c);this.$_addCell(a,b,"d",i,d)}else this.$_addCell(a,b,"s","",d)},createPart:function(){var a=this._doc,b=a.documentElement,c="A1:"+_excelColCaption(this._columns.length-1)+this._book._sheet._rows.length,d=a.getElementsByTagName("dimension");if(d&&d.length>0&&d[0].setAttribute("ref",c),this._outlineLevel>0){var e=a.createElement("sheetFormatPtr");b.appendChild(e),e.setAttribute("outlineLevelRow",this._outlineLevel)}if(this._columns){var f=a.createElement("cols");b.appendChild(f),this.$_createCols(a,f)}b.appendChild(this._dataRoot),this._mergeCount>0&&(b.appendChild(this._mergeRoot),this._mergeRoot.setAttribute("count",this._mergeCount));var g=$$_XML_HEAD+_xmlToStr(a);return $_debug?_formatIndentXml(g):g},$_preparePart:function(){var a='<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"></worksheet>',b=this._doc=_parseXml(a),c=b.createElement("dimension");b.documentElement.appendChild(c);var d=b.createElement("sheetViews");b.documentElement.appendChild(d);var e=this._viewRoot=b.createElement("sheetView");d.appendChild(e),e.setAttribute("workbookViewId","0"),e.setAttribute("tabSelected","1"),this._dataRoot=b.createElement("sheetData"),this._mergeRoot=b.createElement("mergeCells")},$_createCols:function(a,b){for(var c=this._columns,d=0,e=c.length;e>d;d++){var f=c[d],g=a.createElement("col");f.serialize(a,g),b.appendChild(g)}},$_dateToStr:function(a){return _pad(a.getFullYear(),4)+_pad(a.getMonth()+1,2)+_pad(a.getDate(),2)+"T"+_pad(a.getHours(),2)+_pad(a.getMinutes(),2)+_pad(a.getSeconds(),2)}}),ExcelWorkbook=defineClass("ExcelWorkbook",null,{init:function(){this._super(),this._parts={},this._sst=new ExcelStrings(this),this._styles=new ExcelStyles(this),this._sheet=new ExcelSheet(this),this.$_preapreTemplateParts()},destroy:function(){this._sst.destroy(),this._sst=null,this._styles.destroy(),this._styles=null,this._sheet.destroy(),this._sheet=null,this._super()},parts:function(){return this._parts},sheet:function(){return this._sheet},addString:function(a){return this._sst.add(a)},addNumberFormat:function(a){return this._styles.addNumberFormat(a)},addFill:function(a){return this._styles.addFill(a)},addBorder:function(a){return this._styles.addBorder(a)},addFont:function(a){return this._styles.addFont(a)},addStyle:function(a){return this._styles.add(a)},createParts:function(){var a=this._parts;return a["xl/sharedStrings.xml"]=this._sst.createPart(),a["xl/styles.xml"]=this._styles.createPart(),a["xl/worksheets/sheet1.xml"]=this._sheet.createPart(),a},$_preapreTemplateParts:function(){var a=this._parts;a["[Content_Types].xml"]=$$_XML_HEAD+'<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Default Extension="xml" ContentType="application/xml"/><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/><Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/><Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/></Types>',a["_rels/.rels"]=$$_XML_HEAD+'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/></Relationships>',a["docProps/app.xml"]=$$_XML_HEAD+'<Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"><Application>RealGridJS</Application><AppVersion>1.0</AppVersion></Properties>',a["docProps/core.xml"]=$$_XML_HEAD+'<coreProperties xmlns="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><dcterms:created xsi:type="dcterms:W3CDTF">2014-12-25T03:06:34Z</dcterms:created><dc:creator>Wooritech</dc:creator></coreProperties>',a["xl/workbook.xml"]=$$_XML_HEAD+'<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><workbookPr date1904="false"/><bookViews><workbookView activeTab="0"/></bookViews><sheets><sheet name="Sheet1" r:id="rId3" sheetId="1"/></sheets></workbook>',a["xl/_rels/workbook.xml.rels"]=$$_XML_HEAD+'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/></Relationships>'}}),$$_SCROLL_SIZE=17,Dom=defineClass("Dom",null,{init:function(a){this._super(),this._element=a},x:function(){return this._element.offsetLeft},y:function(){return this._element.offsetTop},size:function(){return Dom.getSize(this._element)},element:function(){return this._element},detach:function(){this._element.parentNode&&this._element.parentNode.removeChild(this._element)},clearChildren:function(){Dom.clearChildren(this._element)},addChild:function(a){Dom.addChild(this._element,a)},setStyles:function(a){Dom.setStyles(this._element,a)},getBounds:function(){return Dom.getBounds(this._element)},getOffset:function(){return Dom.getOffset(this._element)},move:function(a,b){Dom.move(this._element,a,b)},disableSelection:function(){Dom.disableSelection(this._element)},isAncestorOf:function(a){for(var b=a.parentElement;b;)if(b==this._element)return!0;return!1}},{createElement:function(a,b,c){var d=document.createElement(a);if(b&&Dom.setStyles(d,b),c)for(var e in c)d[e]=c[e];return d},setStyles:function(a,b){if(b){var c=a.style;for(var d in b)c[d]=b[d]}},removeStyleProperty:function(a,b){a.style.removeProperty?a.style.removeProperty(b):a.style.removeAttribute(b)},addEventListener:function(a,b,c,d){_win.addEventListener?a.addEventListener(b,c,d):a.attachEvent(b,c,d)},removeEventListener:function(a,b,c,d){_win.removeEventListener?a.removeEventListener(b,c,d):a.detachEvent(b,c)},getSize:function(a){var b=a.getBoundingClientRect();return{width:b.width,height:b.height}},setSize:function(a,b,c){var d=a.style;d.width=b+"px",d.height=c+"px"},getBounds:function(a){var b=a.getBoundingClientRect();return b.cx=a.offsetLeft,b.cy=a.offsetTop,b},setBounds:function(a,b,c,d,e){var f=a.style;f.left=b+"px",f.top=c+"px",f.width=d+"px",f.height=e+"px"},getScrolled:function(){var a=document.body,b=document.documentElement;return{sx:window.pageXOffset||b.scrollLeft||a.scrollLeft,sy:window.pageYOffset||b.scrollTop||a.scrollTop}},getOffset:function(a){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||c.scrollTop,f=window.pageXOffset||d.scrollLeft||c.scrollLeft,g=d.clientTop||c.clientTop||0,h=d.clientLeft||c.clientLeft||0,i=b.left+f-h,j=b.top+e-g;return{x:Math.round(i),y:Math.round(j)}},move:function(a,b,c){a.style.left=b+"px",a.style.top=c+"px"},disableSelection:function(a){a.style["-moz-user-select"]="-moz-none",a.style["-khtml-user-select"]="none",a.style["-webkit-user-select"]="none",a.style["-o-user-select"]="none",a.style["-ms-user-select"]="none",a.style["user-select"]="none"},createOptions:function(a,b,c){for(var d=0,e=b.length;e>d;d++){var f=document.createElement("option");f.value=b[d],f.text=c?c[d]:b[d],a.appendChild(f)}},addChild:function(a,b){return a&&b&&b.parentNode!==a?(a.appendChild(b),!0):!1},removeChild:function(a,b){return a&&b&&b.parentNode===a?(a.removeChild(b),!0):!1},clearChildren:function(a){for(var b=a;b.lastChild;)b.removeChild(b.lastChild)},getChildIndex:function(a){if(a){var b=a.parentNode;if(b)for(var c=b.childNodes,d=0;d<c.length;d++)if(c[d]===a)return d}return-1},getRadioGroupValue:function(a){var b=document.getElementsByName(a);if(b)for(var c=b.length;c--;)if(b[c].checked)return b[c].value;return void 0},htmlEncode:function(a){return document.createElement("a").appendChild(document.createTextNode(a)).parentNode.innerHTML},getClipRect:function(a){return"rect("+a.y+"px,"+(a.x+a.width)+"px,"+(a.y+a.height)+"px,"+a.x+"px)"},renderTextRect:function(a,b,c,d,e,f){Dom.renderTextBounds(a,b,c,d,e.x,e.y,e.width,e.height,f)},renderTextBounds:function(a,b,c,d,e,f,g,h,i,j){if(c&&d){var k=a.style;a.textContent=d,k.font=b?b.font:DEF_FONT,k.color=c.css(),k.whiteSpace="nowrap",k.textDecoration=b.underline?"underline":"none";var l=a.getBoundingClientRect2();switch(i){case TextAlign.CENTER:e+=(g-l.width)/2;break;case TextAlign.RIGHT:e=e+g-l.width}switch(k.left=e+"px",j){case TextLayout.TOP:break;case TextLayout.BOTTOM:f=f+h-l.height;break;case TextLayout.MIDDLE:default:f+=(h-l.height)/2}k.top=f+"px"}},isAncestorOf:function(a,b){for(var c=b.parentElement;c;){if(c==a)return!0;c=c.parentElement}return!1},fireEvent:function(a,b){var c;document.createEventObject?(c=document.createEventObject(),a.fireEvent("on"+b,c)):(c=document.createEvent("HTMLEvents"),c.initEvent(b,!0,!0),a.dispatchEvent(c))}}),Color=function(a,b){if("string"==typeof a){var c=Color._parse(a,this,b,!1);if("object"==typeof c)return c}else a instanceof Color?(this._r=a._r,this._g=a._g,this._b=a._b,this._a=a._a):isNaN(a)?(this._r=this._g=this._b=0,this._a=b?NaN:1):(this._a=(a>>>24)/255,this._r=(16711680&a)>>16,this._g=(65280&a)>>8,this._b=255&a)};Color._ERROR=new Color(UNDEFINED,!0),Color._ERROR.error=!0,Color.createFrom=function(a,b){var c=Color._parse(a,$_tempColor,b,!1);return c?"object"==typeof c?c:$_tempColor.clone():null},Color._parse=function(a,b,c,d){var e=function(a){return a?"%"==a[a.length-1]?toInt(a)/100*255:toInt(a):NaN},f=String(a);if(f){var g,h=f.length;if(f=f.trim().toLowerCase(),"#"==f.charAt(0))if(f=f.substr(1),h--,h>=6&&8>=h)b._b=toInt(f.substr(h-2,2),16),b._g=toInt(f.substr(h-4,2),16),b._r=toInt(f.substr(h-6,2),16),b._a=6==h?c?NaN:1:toInt(f.substr(0,h-6),16)/255;else{if(3!=h){if(d)throw"Invalid color value text: "+a;return!1}b._r=toInt(f.charAt(0)+f.charAt(0),16),b._g=toInt(f.charAt(1)+f.charAt(1),16),b._b=toInt(f.charAt(2)+f.charAt(2),16),b._a=c?NaN:1}else if(0==f.indexOf("rgba(")&&")"==f.charAt(h-1))f=f.substring(5,h-1),g=f.split(","),b._r=e(g[0]),b._g=e(g[1]),b._b=e(g[2]),b._a=g[3];else{if(0!=f.indexOf("rgb(")||")"!=f.charAt(h-1)){if(c&&StrictColors.hasOwnProperty(f))return StrictColors[f];if(!c&&Colors.hasOwnProperty(f))return Colors[f];var i=ColorPaletteItem.createFrom(f,!1);if(i)return i;if(d)throw new Error("Invalid color text: "+a);return!1}f=f.substring(4,h-1),g=f.split(","),b._r=e(g[0]),b._g=e(g[1]),b._b=e(g[2]),b._a=c?NaN:1}return!0}return!1},Color.getColorStringArray=function(a){return a.trim().toLowerCase().split(/\s+|(rgba\(.*\))|(rgb\(.*\))|(pal\(.*\))/).filter(Boolean)},Color.getColorCsvArray=function(a){return a.trim().toLowerCase().split(/\s*,\s*|\s+|(rgba\(.*\))|(rgb\(.*\))|(pal\(.*\))/).filter(Boolean)},Color.prototype.clone=function(){return new Color(this)},Color.prototype.copy=function(a,b){return a?(this._r=a._r,this._g=a._g,this._b=a._b,this._a=isNaN(a._a)?Number(b):a._a):this._a=Number(b),this},Color.prototype.value=function(){return"rgba("+this._r+","+this._g+","+this._b+","+this._a+")"},Color.prototype.valueWithBrightness=function(a){var b=this._r,c=this._g,d=this._b,e=Number(a);return isNaN(e)||1==e||(b=_floor(Math.max(0,Math.min(255,b*e))),c=_floor(Math.max(0,Math.min(255,c*e))),d=_floor(Math.max(0,Math.min(255,d*e))),255==b&&this._r<255&&(b=_floor((255+this._r)/2)),255==c&&this._g<255&&(c=_floor((255+this._g)/2)),255==d&&this._b<255&&(d=_floor((255+this._b)/2))),"rgba("+b+","+c+","+d+","+this._a+")"},Color.prototype.argb=function(){return Math._floor(255*this._a)<<24|this._r<<16|this._g<<8|this._b},Color.prototype.rgb=function(){return this._r<<16|this._g<<8|this._b},Color.prototype.extractAlpha=function(){var a=this._a;return this._a=NaN,a},Color.prototype.toHex=function(){return""+hex(_floor(255*this._a))+hex(this._r)+hex(this._g)+hex(this._b)},Color.prototype.toColorHex=function(){return""+hex(this._r)+hex(this._g)+hex(this._b)},Color.prototype.toString=function(){return"#"+hex(_floor(255*this._a))+hex(this._r)+hex(this._g)+hex(this._b)},Color.prototype.toColorString=function(){return"#"+hex(this._r)+hex(this._g)+hex(this._b)},Color.areEqual=function(a,b){return a&&b&&a._r==b._r&&a._g==b._g&&a._b==b._b&&a._a==b._a};var $_tempColor=new Color,$_tempColors=[new Color,new Color],Colors={transparent:new Color("#00000000"),aqua:new Color("#00ffff"),black:new Color("#000000"),blue:new Color("#0000ff"),fuchsia:new Color("#ff00ff"),gray:new Color("#808080"),green:new Color("#008000"),lime:new Color("#00ff00"),maroon:new Color("#800000"),navy:new Color("#000080"),olive:new Color("#808000"),orange:new Color("#ffa500"),purple:new Color("#800080"),red:new Color("#ff0000"),silver:new Color("#c0c0c0"),teal:new Color("#008080"),white:new Color("#ffffff"),yellow:new Color("#ffff00"),dimGray:new Color("#696969"),ltGray:new Color("#d3d3d3")},StrictColors={transparent:new Color("#00000000"),aqua:new Color("#00ffff",!0),black:new Color("#000000",!0),
blue:new Color("#0000ff",!0),fuchsia:new Color("#ff00ff",!0),gray:new Color("#808080",!0),green:new Color("#008000",!0),lime:new Color("#00ff00",!0),maroon:new Color("#800000",!0),navy:new Color("#000080",!0),olive:new Color("#808000",!0),orange:new Color("#ffa500",!0),purple:new Color("#800080",!0),red:new Color("#ff0000",!0),silver:new Color("#c0c0c0",!0),teal:new Color("#008080",!0),white:new Color("#ffffff",!0),yellow:new Color("#ffff00",!0),dimGray:new Color("#696969",!0),ltGray:new Color("#d3d3d3",!0)},ColorPaletteItem=function(a,b){this._palette=a,this._index=arguments.length>1?b:-1};ColorPaletteItem.createFrom=function(a,b){var c=b?a.trim().toLowerCase():a;if(0==c.indexOf("pal(")&&")"==c.charAt(c.length-1)){if(c=c.substring(4,c.length-1),c.indexOf(",")>=1){var d=c.split(",");return d.length>1?new ColorPaletteItem(d[0],parseInt(d[1])):new ColorPaletteItem(d[0])}return new ColorPaletteItem(c)}return null},ColorPaletteItem.prototype.clone=function(){var a=new ColorPaletteItem(this._palette,this._index);return a},ColorPaletteItem.prototype.getColor=function(){var a=this.getIndex();return a>=0?this._palette.getColor(a):Colors.transparent},ColorPaletteItem.prototype.getIndex=function(){var a=this._palette;return a instanceof ColorPalette||(this._palette=a=ColorPalette.getPalette(this._palette)),a?((this._index<0||this._index>=a.getCount())&&(this._index=a.next()),this._index):-1};var ColorPalette=function(a){this._colors=[],this._next=0,this._parse(a)};ColorPalette.register=function(a,b){a&&(ColorPalette._palettes[a]=b)},ColorPalette.loadPalettes=function(a){if(a){var b=toArray(a);if(b)for(var c=0;c<b.length;c++){var d=b[c].name,e=b[c].colors;if(d&&e){var f=new ColorPalette(e);ColorPalette.register(d,f)}}}},ColorPalette.getPalette=function(a){return ColorPalette._palettes.hasOwnProperty(a)?ColorPalette._palettes[a]:ColorPalette._palettes["default"]},ColorPalette.prototype.getCount=function(){return this._colors.length},ColorPalette.prototype.getColors=function(){return this._colors.slice()},ColorPalette.prototype.next=function(){var a=this._next;return this._next=(this._next+1)%this._colors.length,a},ColorPalette.prototype.getColor=function(a){return this._colors[a]},ColorPalette.prototype._parse=function(a,b){if(this._colors=[],a){var c=a;isArray(c)||(c=String(a).split(","));for(var d=0,e=c.length;e>d;d++){var f=Color.createFrom(c[d],!0);this._colors.push(f)}}this._colors.length<1&&this._colors.push(Color.createFrom("#00000000"))},ColorPalette._palettes={"default":new ColorPalette("#eeeeee")};var Pen=function(){var a=arguments;1==a.length?this._parse(a[0]):2==a.length&&(this._color=new Color(a[0]),this._width=parseInt(a[1]))};Pen.prototype._parse=function(a){var b=PivotHelper.splitEscape(a," ");3==b.length&&"solid"==b[1]?(this._width=parseInt(b[0]),this._color=new Color(b[2])):2==b.length&&"solid"==b[1]?(this._width=1,this._color=Colors.black):(this._width=0,this._color=null)},Pen.prototype.width=function(){return this._width},Pen.prototype.color=function(){return this._color},Pen.prototype.css=_norgba?function(){return this._width+"px solid "+this._color.toColorString()}:function(){return this._width+"px solid "+this._color.value()};var TextAlign=_enum({LEFT:"left",CENTER:"center",RIGHT:"right"}),TextLayout=_enum({TOP:"top",MIDDLE:"middle",BOTTOM:"bottom"}),TextWrap=_enum({NONE:"none",NORMAL:"normal"}),ChartItemShapes=_enum({CIRCLE:"circle",TRIANGLE:"triangle",SQUARE:"square",DIAMOND:"diamond"}),ContentVisibility=_enum({VISIBLE:"visible",HIDDEN:"hidden",COLLAPSED:"collapsed"}),LabelPosition=_enum({DEFAULT:"default",FAR:"far",MID:"mid",NEAR:"near"}),ContentOrientation=_enum({HORIZONTAL:"horizontal",VERTICAL:"vertical"}),HorizontalAlign=_enum({DEFAULT:"default",LEFT:"left",CENTER:"center",RIGHT:"right",FILL:"fill"}),VerticalAlign=_enum({DEFAULT:"default",TOP:"top",MIDDLE:"middle",BOTTOM:"bottom",FILL:"fill"}),OverflowPolicy=_enum({NONE:"none",JUSTIFY:"justify"}),Rectangle=function(a,b,c,d){"undefined"==typeof a||null===a?this.x=this.y=this.width=this.height=0:(this.x=a,this.y=b,this.width=c,this.height=d)};Rectangle.prototype={constructor:Rectangle,clone:function(){return new Rectangle(this.x,this.y,this.width,this.height)},getInner:function(){return new Rectangle(0,0,this.width,this.height)},equals:function(a){return a===this||a&&this.x===a.x&&this.y===a.y&&this.width===a.width&&this.height===a.height},toString:function(){return"{x: "+this.x+", y: "+this.y+", width: "+this.width+", height: "+this.height+"}"},left:function(){return this.x},setLeft:function(a){var b=a-this.x;this.x+=b,this.width-=b},leftBy:function(a){return this.x+=a,this.width-=a,this},right:function(){return this.x+this.width},setRight:function(a){var b=a-(this.x+this.width);this.width+=b},rightBy:function(a){return this.width+=a,this},top:function(){return this.y},setTop:function(a){var b=a-this.y;return this.y+=b,this.height-=b,this},topBy:function(a){return this.y+=a,this.height-=a,this},bottom:function(){return this.y+this.height},setBottom:function(a){var b=a-(this.y+this.height);return this.height+=b,this},bottomBy:function(a){return this.height+=a,this},shrink:function(a,b){return this.width-=a,this.height-=b,this},expand:function(a,b){return this.width+=a,this.height+=b,this},contains:function(a,b){return a>=this.x&&a<=this.x+this.width&&b>=this.y&&b<=this.y+this.height},isEmpty:function(){return 0===this.width||0===this.height},setEmpty:function(){return this.width=this.height=0,this},set:function(a,b,c,d){return this.x=a,this.y=b,this.width=c,this.height=d,this},copy:function(a){return this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height,this},copyHorz:function(a){return this.x=a.x,this.width=a.width,this},copyVert:function(a){return this.y=a.y,this.height=a.height,this},inflate:function(a,b,c,d){return b=arguments.length>1?b:0,c=arguments.length>2?c:a,d=arguments.length>3?d:b,a&&this.setLeft(this.x-a),b&&this.setTop(this.y-b),c&&this.setRight(this.right()+c),d&&this.setBottom(this.bottom()+d),this},offset:function(a,b){return this.x+=a,this.y+=b,this},round:function(){var a=this.clone();return a.x>>>=0,a.y>>>=0,a.width>>>=0,a.height>>>=0,a},union:function(a){var b=this.clone();return b.setLeft(Math.min(this.x,a.x)),b.setRight(Math.max(this.right(),a.right())),b.setTop(Math.min(this.y,a.y)),b.setBottom(Math.max(this.bottom(),a.bottom())),b},normalize:function(){return this.width<0&&(this.x-=this.width,this.width*=-1),this.height<0&&(this.y-=this.height,this.height*=-1),this}};var Size=function(a,b){0==arguments.length?this.width=this.height=0:(this.width=a,this.height=b)};Size.EMPTY=new Size,Size.empty=function(){return new Size},Size.create=function(a,b){return new Size(a,b)},Size.prototype={constructor:Size,clone:function(){return new Size(this.width,this.height)},equals:function(a){return a===this||a&&this.width===a.width&&this.height===a.height},toString:function(){return"{width: "+this.width+", height: "+this.height+"}"},isEmpty:function(){return 0===this.width||0===this.height},setEmpty:function(){return this.width=this.height=0,this},set:function(a,b){return this.width=a,this.height=b,this},round:function(){var a=this.clone();return a.width>>>=0,a.height>>>=0,a}};var Point=function(a,b){0==arguments.length?this.x=this.y=0:(this.x=a,this.y=b)};Point.EMPTY=new Point,Point.empty=function(){return new Point},Point.create=function(a,b){return new Point(a,b)},Point.prototype={constructor:Size,clone:function(){return new Point(this.x,this.y)},equals:function(a){return a===this||a&&this.width===a.width&&this.height===a.height},toString:function(){return"{x: "+this.x+", y: "+this.y+"}"},isEmpty:function(){return 0===this.x||0===this.y},setEmpty:function(){return this.x=this.y=0,this},set:function(a,b){return this.x=a,this.y=b,this},round:function(){var a=this.clone();return a.x>>>=0,a.y>>>=0,a}};var SideRectangles=function(){this.left=new Rectangle,this.right=new Rectangle,this.top=new Rectangle,this.bottom=new Rectangle};SideRectangles.prototype={constructor:SideRectangles,clear:function(){this.left.setEmpty(),this.right.setEmpty(),this.top.setEmpty(),this.bottom.setEmpty()},setLeft:function(a,b,c,d){this.left.set(a,b,c,d)},setRight:function(a,b,c,d){this.right.set(a,b,c,d)},setTop:function(a,b,c,d){this.top.set(a,b,c,d)},setBottom:function(a,b,c,d){this.bottom.set(a,b,c,d)}};var RelativeSize=function(a,b){this._size=a,this._fixed=b};RelativeSize.prototype={constructor:RelativeSize,clone:function(){return new RelativeSize(this._size,this._fixed)},getSize:function(a){return this._fixed?this._size:a*this._size}},RelativeSize.Empty=new RelativeSize(0,!1),RelativeSize.createFrom=function(a){var b=0,c=!1;if(a){var d=String(a).trim(),e=d.length;e>0&&(e>2&&d.lastIndexOf("px")==e-2&&(c=!0,d=d.substr(0,e-3)),d&&(b=parseFloat(d)))}return new RelativeSize(b,c)},RelativeSize.equals=function(a,b){return a instanceof RelativeSize&&b instanceof RelativeSize&&a._size===b.size&&a._precentage===b._precentage};var PercentSize=function(a,b){this._size=a,this._fixed=b};PercentSize.prototype={constructor:PercentSize,clone:function(){return new PercentSize(this._size,this._fixed)},getSize:function(a,b){return this._fixed?this._size:a*this._size/(b||100)}},PercentSize.Empty=new PercentSize(0,!0),PercentSize.createFrom=function(a){var b=0,c=!0;if(a){var d=String(a).trim(),e=d.length;e>0&&(e>1&&d.lastIndexOf("%")==e-1&&(c=!1,d=d.substr(0,e-1).trim()),d&&(b=parseFloat(d)))}return new PercentSize(b,c)},PercentSize.equals=function(a,b){return a instanceof PercentSize&&b instanceof PercentSize&&a._size===b.size&&a._precentage===b._precentage};var SizeF=function(a,b){this.width=a,this.height=b};SizeF.prototype={constructor:SizeF,clone:function(){return new SizeF(this.width,this.height)},set:function(a,b){this.width=parseFloat(a),this.height=parseFloat(b)}},SizeF.createFrom=function(a){var b=0,c=0;if(a){var d=String(a).split(",");d.length>0&&(b=c=parseFloat(d[0])),d.length>1&&(c=parseFloat(d[1]))}return new SizeF(b,c)};var pointInBound=function(a,b,c){return a>=c.left&&a<=c.right&&b>=c.top&&b<=c.bottom},ProgressView=defineClass("ProgressView",null,{init:function(){this._super(),this._container=null,this._element=this.$_createElement(),this._min=0,this._max=0,this._pos=0},destroy:function(){this._element.parentNode&&this._container.removeChild(this._element),this._container=null,this._super()},modal:!1,message:"Load data...",position:function(){return this._pos},setProperties:function(a,b,c,d){this._min=a,this._max=Math.max(a,b),this._max==this._min&&(this._max=this._min+1),this._pos=Math.max(this._min,Math.min(this._max,c)),d&&this.$_refreshView()},show:function(a,b){this._container=a,this.setMessage(b),a.appendChild(this._element);var c=a.getBoundingClientRect(),d=this._element.getBoundingClientRect();this._element.style.left=(c.width-d.width)/2+"px",this._element.style.top=(c.height-d.height)/3+"px"},close:function(){this._element.parentNode&&this._container.removeChild(this._element)},setMessage:function(a){if(a!=this._message){var b=this._spanElement;b.innerHTML=Dom.htmlEncode(a),this._message=a}},$_createElement:function(){var a=_doc.createElement("div");return a.style.position="absolute",a.style.zIndex=3001,a.style.minWidth="250px",a.style.padding="8px 10px",a.className="realpivot-progress",this._barElement=this.$_createBar(),a.appendChild(this._barElement),this._msgElement=this.$_createMsg(),a.appendChild(this._msgElement),a},$_createBar:function(){var a=_doc.createElement("div");a.style.width="100%",a.style.height="13px",a.style.marginBottom="4px",a.className="realpivot-progress-bar";var b=this._ledElement=_doc.createElement("div");return b.style.height="100%",b.style.width="0px",b.className="realpivot-progress-led",a.appendChild(b),a},$_createMsg:function(){var a=_doc.createElement("div");a.style.width="100%",a.className="realpivot-progress-message";var b=this._spanElement=_doc.createElement("span");return b.className="realpivot-progress-message",a.appendChild(b),a},$_refreshView:function(){var a=(this._element,this._barElement),b=this._ledElement,c=this._spanElement;c.innerHTML=Dom.htmlEncode(this._message);var d=a.getBoundingClientRect();b.style.width=Math.min(d.width-1,_int(d.width*(this._pos-this._min)/(this._max-this._min)))+"px"}}),ProgressManager=defineClass("ProgressManager",null,{init:function(a){this._super(),this._container=a,this._title=null,this._view=null},destroy:function(){this._view&&(this._view.destroy(),this._view=null),this._container=null,this._super()},show:function(a,b){this._view||(this._view=new ProgressView),this._title=a||"Load data...",this._view.show(this._container,a)},close:function(){this._view&&this._view.close()},setProperties:function(a,b,c){message=this._title,b>a&&(message+=parseInt(100*(c-a)/(b-a))+"% ("+c+" / "+b+")"),this._view&&(this._view.setMessage(message),this._view.setProperties(a,b,c,!0))}}),TooltipView=defineClass("ToolTipView",EventAware,{init:function(a){this._super(),this._container=a,this._span=null,this._element=this._createElement()},destroy:function(){this._span&&this._element.removeChild(this._span),this._element.parentNode&&this._container.removeChild(this._element),this._container=null,this._super()},show:function(a,b,c,d,e){var f=a.message+"";if(f){var g=this._span;g.innerHTML=f.replace(/\n/g,"<br>");var h=this._element;h.style.position="absolute",h.style.left=b+"px",h.style.top=c+"px",h.style.visibility="hidden",e?this._container.insertBefore(h,e._element):this._container.appendChild(h);var i=h.getBoundingClientRect(),j=this._container.getBoundingClientRect();h.style.left=i.right>j.right?Math.max(j.right-i.width-j.left-2,0)+"px":h.style.left,h.style.top=i.bottom>j.bottom?Math.max(c-i.height-d.height(),0)+"px":h.style.top,h.style.visibility="visible"}},hide:function(){var a=this._element;a&&a.parentNode&&this._container.removeChild(a)},_createElement:function(){var a=_doc.createElement("div");return a.className="realpivot-tooltip",this._span=_doc.createElement("span"),this._span.className="realpivot-tooltip",a.appendChild(this._span),a}}),TooltipManager=defineClass("ToolTipManager",null,{init:function(a){this._super(),this._container=a,this._tipView=null,this._active=!1},destroy:function(){this._active&&this.close(),this._tipView&&(this._tipView.destroy(),this._tipView=null),this._container=null,this._super()},delayTime:100,showTimer:null,isVisible:function(){return this._active},show:function(a,b,c,d,e){this._active||(this.close(),a&&(this._tipView||(this._tipView=new TooltipView(this._container)),this._tipView.show(a,b,c,d,e),this._active=!0))},close:function(){this._showTimer&&clearTimeout(this._showTimer),this._active&&(this._tipView&&this._tipView.hide(),this._active=!1)}}),ContextMenuView=defineClass("ContextMenuView",EventAware,{init:function(a,b){this._super(),this._container=a,this._listners=[],this._items=b,this._createElement(b)},destroy:function(){this.hide(),this._items=null,this._removeItems(),this._element=null,this._container=null,this._super()},show:function(a,b,c){this.$_show(a,b,c)},$_show:function(a,b,c){var d=this._element;d.style.position="absolute",d.style.left=a+"px",d.style.top=b+"px",d.style.visibility="hidden",this._container.appendChild(d);var e=d.getBoundingClientRect(),f=this._container.getBoundingClientRect(),g=c?c.height:0;d.style.left=e.right>f.right?Math.max(f.right-e.width-f.left-2,0)+"px":d.style.left,d.style.top=e.bottom>f.bottom?Math.max(b-e.height-g,0)+"px":d.style.top,d.style.visibility="visible"},hide:function(){var a=this._element;a&&a.parentNode&&this._container.removeChild(a)},_createElement:function(a){this._element=_doc.createElement("div"),this._element.className="realpivot-menu",this._buildItems(a)},_removeItems:function(){for(var a=this._listners.length;a--;){var b=this._listners[a];Dom.removeEventListener(b,"click",this._menuItemClick,!1),delete this._listners[a]}for(this._listners=[];this._element.firstChild;)this._element.removeChild(this._element.firstChild)},_buildItems:function(a){this._removeItems();var b,c,d,e,f,g,h=this._element;for(f=0,g=a.length;g>f;f++)b=_doc.createElement("div"),b.menuItem=a[f],"-"==a[f].text?(b.className="realpivot-menu-split",c=_doc.createElement("hr"),c.className="realpivot-menu-split",b.appendChild(c)):(b.className="realpivot-menu-item",a[f].callback&&(Dom.addEventListener(b,"click",this._menuItemClick.bind(this),!1),this._listners.push(b)),d=_doc.createElement("span"),d.className="realpivot-menu-item-pre",b.appendChild(d),e=_doc.createElement("span"),e.className="realpivot-menu-item",e.innerHTML=a[f].text||"&nbsp;",b.appendChild(e)),h.appendChild(b)},_menuItemClick:function(a){var b=a.currentTarget?a.currentTarget:a.srcElement,c=b.menuItem.callback;this.hide(),c()}}),ContextMenuManager=defineClass("ContextMenuManager",null,{init:function(a,b){this._super(),this._container=a,this._menuView=null,b?this._items=b.slice():this._items=null,this._active=!1,this._itemChanged=!1},destroy:function(){this._active&&this.close(),this._menuView&&(this._menuView.destroy(),this._menuView=null),this._container=null,this._items=null,this._super()},isVisible:function(){return this._active},getView:function(){return this._menuView},show:function(a,b,c){this._active||(this.close(),this._menuView?this._itemChanged&&this._menuView._buildItems(this._items):this._menuView=new ContextMenuView(this._container,this._items),this._menuView.show(a,b,c),this._active=!0,this._itemChanged=!1)},close:function(){this._active&&(this._menuView&&this._menuView.hide(),_trace(this._menuView._element.parentNode),this._active=!1)},setItems:function(a){if(a){this._items=[],this._itemChanged=!0;for(var b=0,c=a.length;c>b;b++){var d={};d.text=a[b].text,d.callback=a[b].callback,this._items.push(d)}}else this._items=null}}),Keys=_enum({BACK:8,TAB:9,ENTER:13,ESC:27,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,F2:113,F3:114,D:68,I:73,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90}),Cursor=_enum({DEFAULT:"default",AUTO:"auto",POINTER:"pointer",WAIT:"wait",MOVE:"move",COL_RESIZE:"col-resize",ROW_RESIZE:"row-resize",CROSSHAIR:"crosshair",HORZ_RESIZE:"ew-resize",VERT_RESIZE:"ns-resize",NESW_RESIZE:"nesw-resize",NWSE_RESIZE:"nwse-resize",NO_DROP:"no-drop",NOT_ALLOWED:"not-allowed"}),_touchToOffset=function(a,b){if(!b)return void alert("no touch");if(!a)return void alert("no container");if(!a._canvas)return void alert("no canvas");var c=a._canvas.getBoundingClientRect();return b.x=b.pageX-(c.left+window.scrollX),b.y=b.pageY-(c.top+window.scrollY),b},TouchManager=defineClass("TouchManager",null,{init:function(a){this._super(),this._container=a},touchStart:function(a){},touchMove:function(a){},touchEnd:function(a){},touchCancel:function(a){},_toOffset:function(a){return _touchToOffset(this._container,a)}}),VisualTool=defineClass("VisualTool",null,{init:function(a){this._super(),this._owner=a,this._dragTracker=null,this._clickX=0,this._clickY=0,this._currX=0,this._currY=0},dragTracker:null,owner:function(){return this._owner},setDragTracker:function(a){a!==this._dragTracker&&(this._dragTracker&&this._dragTracker.deactivate(),this._dragTracker=a,this._dragTracker&&this._dragTracker.activate())},isDragging:function(){return this._dragTracker&&this._dragTracker.isDragging()},inDraggablePt:function(a,b){return a>=b-VisualTool.DRAG_BORDER-1&&a<=b+VisualTool.DRAG_BORDER},clickX:function(){return this._clickX},clickY:function(){return this._clickY},currX:function(){return this._currX},currY:function(){return this._currY},isEditing:function(){return!1},touchManager:function(){return null},activate:function(){this._doActivate()},deactivate:function(){this._doDeactivate()},keyDown:function(a,b,c,d){return this._doKeyDown(a,b,c,d)},keyUp:function(a,b,c,d){return this._doKeyUp(a,b,c,d)},keyPress:function(a){return this._doKeyPress(a)},click:function(a){this._doClick(a.mouseX,a.mouseY)},dblclick:function(a){this._doDblClick(a.mouseX,a.mouseY)},mouseDown:function(a){var b=this._currX=this._clickX=a.mouseX,c=this._currY=this._clickY=a.mouseY;this.isDragging()&&(this._stopDragTracker(b,c,!1),this.setDragTracker(null));var d=_isMac&&a.metaKey||!_isMac&&a.ctrlKey;this._doMouseDown(a.mouseX,a.mouseY,d,a.shiftKey,a.button,a)},mouseMove:function(a){var b,c=this._currX=a.mouseX,d=this._currY=a.mouseY,e=this.dragTracker();e?e.isDragging()?("$hasNotButtons"in VisualTool||(VisualTool.$hasNotButtons=_ieOld||_isSafari),VisualTool.$hasNotButtons||a.buttons>0?e.drag(c,d)||(b=e.getNextRequest(c,d),b&&(this._stopDragTracker(c,d,!0),this.setDragTracker(this._getDragTracker(b)),this._startDragTracker(c,d))):this._stopDragTracker(c,d,!0)):_abs(c-this._clickX)>=VisualTool.DRAG_THRESHOLD||_abs(d-this._clickY)>=VisualTool.DRAG_THRESHOLD?this._startDragTracker(c,d):this._doMouseMove(c,d):this._doMouseMove(c,d)},mouseUp:function(a){var b=this._currX=a.mouseX,c=this._currY=a.mouseY;return this.isDragging()?void this._stopDragTracker(b,c,!1):void this._doMouseUp(b,c,a)},mouseEnter:function(a){this._doMouseEnter(a.mouseX,a.mouseY)},mouseLeave:function(a){this._doMouseLeave(a.mouseX,a.mouseY)},mouseOver:function(a){this._doMouseOver(a.mouseX,a.mouseY)},mouseOutside:function(){this._doMouseOutside()},mouseWheel:function(a){return xdelta=a.wheelDeltaX?a.wheelDeltaX:0,ydelta=a.wheelDeltaY?a.wheelDeltaY:a.wheelDelta,_abs(xdelta)>_abs(ydelta)?(ydelta=0,xdelta=xdelta>0?VisualTool.WHEEL_DOWN:VisualTool.WHEEL_UP):(xdelta=0,ydelta=ydelta>0?VisualTool.WHEEL_DOWN:VisualTool.WHEEL_UP),a.shiftKey?this._doMouseWheel(a.mouseX,a.mouseY,ydelta,xdelta):this._doMouseWheel(a.mouseX,a.mouseY,xdelta,ydelta)},touchStart:function(a){this.touchManager()?this.touchManager().touchStart(a):this._doTouchStart(a)},touchMove:function(a){this.touchManager()?this.touchManager().touchMove(a):this._doTouchMove(a)},touchEnd:function(a){this.touchManager()?this.touchManager().touchEnd(a):this._doTouchEnd(a)},touchCancel:function(a){this.touchManager()?this.touchManager().touchCancel(a):this._doTouchCancel(a)},findElementAt:function(a,b,c){return this._owner.findChildAt(a,b,c)},setFocus:function(){return this._doSetFocus()},_doActivate:function(){trace("tool: activated")},_doDeactivate:function(){trace("tool: deactivated")},_doKeyDown:function(a,b,c,d){return trace("tool: keyDown("+a+")"),!1},_doKeyUp:function(a,b,c,d){return trace("tool: keyUp("+a+")"),!1},_doKeyPress:function(a){trace("tool: keyPress("+a+")")},_doClick:function(a,b){trace("tool: click("+a+","+b+")")},_doDblClick:function(a,b){trace("tool: dblClick("+a+","+b+")")},_doMouseDown:function(a,b,c,d,e,f){trace("tool: mouseDown("+a+","+b+")")},_doMouseMove:function(a,b){trace("tool: mouseMove("+a+","+b+")")},_doMouseUp:function(a,b){trace("tool: mouseUp("+a+","+b+")")},_doMouseEnter:function(a,b){trace("tool: mouseEnter("+a+","+b+")")},_doMouseLeave:function(a,b){trace("tool: mouseLeave("+a+","+b+")")},_doMouseOver:function(a,b){trace("tool: mouseOver("+a+","+b+")")},_doMouseOutside:function(){},_doMouseWheel:function(a,b,c,d){return trace("tool: mouseWheel("+c+","+d+")"),!1},_doTouchStart:function(a){trace("tool: touchStart")},_doTouchMove:function(a){trace("tool: touchMove")},_doTouchEnd:function(a){trace("tool: touchEnd")},_doTouchCancel:function(a){trace("tool: touchCancel")},_startDragTracker:function(a,b){this._dragTracker&&(this._dragTracker.start(a,b)?this._doDragTrackerStarted(this._dragTracker):this._dragTracker=null)},_stopDragTracker:function(a,b,c){if(this.isDragging()){var d=this._dragTracker;c?d.cancel():d.drop(a,b),this.setDragTracker(null),this._doDragTrackerFinished(d,c),this._owner&&this._owner.invalidate&&this._owner.invalidate()}},_doDragTrackerStarted:function(a){trace("dragTracker started: "+a.name())},_doDragTrackerFinished:function(a,b){trace("dragTracker stopped: "+a.name()+", "+(b?"canceled":"completed"))},_doSetFocus:function(){}},{DRAG_BORDER:2,DRAG_THRESHOLD:3,WHEEL_UP:-60,WHEEL_DOWN:60}),RGValueType=Object.freeze({TEXT:"text",NUMBER:"number",BOOLEAN:"boolean",DATETIME:"datetime",OBJECT:"object",CHAR:"char",UNUM:"unum",INT:"int",UINT:"uint",DATE:"date"}),getRGFieldType=function(a){return a?"function"==typeof a.dataType?a.dataType():a.dataType:null},$$$_DEC_SEP=".",$$$_GRP_SEP=",",DecimalFormatter=defineClass("DecimalFormatter",null,{init:function(a){this._super(),this._minDigits=0,this._maxDigits=0,this._minInts=0,this._maxInts=0,this._optDecimal=!1,this._groupPos=0,this._seperator=null,this._groupSep=null,this._reg=null,this._regDecimal=null,this._replacement="$&,",this._parse(a)},format:function(a){var b=Number(a);if(isNaN(b))return"";var c=this._minDigits;if(this._optDecimal){var d=decimalPlaces(b);c=Math.min(Math.max(d,this._minDigits),this._maxDigits)}b=Number(b.toPrecision(15));var e=b.toFixed(c);return this._seperator&&(e=e.replace($$$_DEC_SEP,this._seperator)),this._reg?c?e.replace(this._regDecimal,this._replacement):e.replace(this._reg,this._replacement):e},_parse:function(a){if(a&&(a=a.trim()),a){var b=$$$_DEC_SEP,c=$$$_GRP_SEP;if(a.indexOf(";")>-1){var d=a.split(";");a=d[0],d.length>1&&d[1]&&(b=d[1]),d.length>2&&d[2]&&(c=d[2])}this._seperator=b==$$$_DEC_SEP?null:b,this._groupSep=c==$$$_GRP_SEP?null:c;var e,f,g=a.length,h=a.indexOf($$$_DEC_SEP);if(this._optDecimal=a.indexOf("#",h)>0,this._minDigits=0,this._maxDigits=0,h>=0){for(e=h+1;g>e&&"0"==a.charAt(e);e++)this._minDigits++,this._maxDigits++;for(;g>e&&"#"==a.charAt(e);e++)this._maxDigits++;a=a.substr(0,h)}if(a&&(g=a.length,a.charAt(g-1)==$$$_GRP_SEP&&(this._groupPos=3,a=a.substr(0,g-1))),a){g=a.length;var i=!0;for(e=g-1;e>=0;e--)if(f=a.charAt(e),"0"==f&&i)this._minInts++,this._maxInts++;else if(0==this._groupPos&&f==$$$_GRP_SEP)this._groupPos=g-e-1;else{if("#"!=f)break;i=!1}}this._groupPos>0&&(this._replacement="$&"+c,this._reg=new RegExp("\\d(?=(\\d{"+this._groupPos+"})+($|\\"+b+"))","g"),this._regDecimal=new RegExp("\\d(?=(\\d{"+this._groupPos+"})+\\"+b+")","g"))}}},{PerformTest:function(a,b){for(var c=new DecimalFormatter(a),d=_getTimer(),e=0;b>e;e++)c.format(1234567.1234);d=_getTimer()-d,trace("##### DecimalFormat PerformTest Result : "+d+" msces.")},Test:function(a,b){var c=new DecimalFormatter(a),d=c.format(b);trace("##### DecimalFormat Test Result : "+d)}}),BooleanFormatter=defineClass("BooleanFormatter",null,{init:function(a){this._super(),this._format=a,this._nullText=null,this._trueText=null,this._falseText=null,this._parse()},format:null,setFormat:function(a){a!=this._format&&(this._format=a,this._parse())},formatValue:function(a){return a===UNDEFINED?this._nullText:a?this._trueText:this._falseText},_parse:function(){if(this._falseText=this._trueText=null,this._format){var a=this._format.split(/[;\:]/);this._falseText=a[0],a.length>0&&(this._trueText=a[1]),a.length>1&&(this._nullText=a[2])}}}),BooleanConverter=function(a){var b=a,c=null,d=!0,e=null,f=null;this.format=function(){return b},this.setFormat=function(a){a!=b&&(b=a,g(a))},this.toBool=function(a){if(c&&a){var b=d?String(a):String(a).toLowerCase();if(b in c)return c[b]}return Boolean(a)},this.toBoolEx=function(a){var b=d?String(a):String(a).toLowerCase();return c&&b in c?c[b]:b?Boolean(b):void 0},this.toBoolStrict=function(a){if(c){var b=d?String(a):String(a).toLowerCase();if(b in c)return c[b]}return void 0},this.toText=function(a){return a?e:f};var g=function(a){if(a){var b,g,h,i,j=a.split(/[;\:]/),k=!0;for(b=j[0],h=b?b.split(","):null,j.length>1&&(b=j[1],i=b?b.split(","):null),j.length>2&&(b=trim(j[2]),"0"==b&&(k=!1)),c={},d=k,g=0;g<h.length;g++)b=h[g],c[k?b:b.toLowerCase()]=!1;for(g=0;g<i.length;g++)b=i[g],c[k?b:b.toLowerCase()]=!0;e=i&&i.length>0?i[0]:"true",f=h&&h.length>0?h[0]:"false"}else c={},c["true"]=!0,c["false"]=!1,e="true",f="false"};g(b)};BooleanConverter.Default=new BooleanConverter("false,f,0:true,t,1:0");var DATE_SEPARATORS="./-: ",DateTimeParser=defineClass("DateTimeParser",null,{init:function(a){this._super(),this._baseYear=0,this._patterns=[],this.setFormat(a)},format:null,baseYear:2e3,amText:"AM",pmText:"PM",setFormat:function(a){if(a!=this._format){if(!a)throw"Invalid empty date format";this.$_parseFormat(a),this._format=a}},setBaseYear:function(a){a!=this._baseYear&&(this._baseYear=a)},setAmText:function(a){a!=this._amText&&(this._amText=a)},setPmText:function(a){a!=this._pmText&&(this._pmText=a)},parse:function(a){try{var b,c=0,d=1,e=1,f=0,g=0,h=0,i=0,j=0,k=0,l=this._patterns.length,m=0,n=a.length;for(b=0;l>b&&n>m;b++){var o=this._patterns[b],p=o.c,q=o.len;switch(p){case"y":c=_int(a.substr(m,q));break;case"M":d=_int(a.substr(m,q));break;case"d":e=_int(a.substr(m,q));break;case"a":if(this._amText&&a.indexOf(this._amText,m)==m)j=12,q=this._amText.length;else{if(!this._pmText||a.indexOf(this._pmText,m)!=m)return null;k=12,q=this._pmText.length}break;case"H":f=_int(a.substr(m,q));break;case"h":f=_int(a.substr(m,q));break;case"m":g=_int(a.substr(m,q));break;case"s":h=_int(a.substr(m,q));break;case"S":i=_int(a.substr(m,q));break;case".":case"/":case"-":case":":case" ":if(DATE_SEPARATORS.indexOf(a.charAt(m))<0)return null;break;default:return null}m+=q}}catch(r){return null}return 100>c&&(c+=this._baseYear),j>0?12==f&&(f=0):k>0&&12>f&&(f+=12),new Date(c,d-1,e,f,g,h,i)},$_parseFormat:function(a){var b,c,d,e=a,f=e.length,g=0;for(this._patterns=[];f>g;)if(b=g,c=e.charAt(g),_isWhitespace(c)){for(g++;f>g&&_isWhitespace(e.charAt(g));)g++;this._patterns.push({c:" ",p:b,len:g-b})}else{switch(d=0,c){case"y":d=this.$_getPattern(e,g,c),4!=d&&2!=d&&this.$_throwInvalidFormat(e);break;case"M":case"d":case"H":case"h":case"m":case"s":d=this.$_getPattern(e,g,c),2!=d&&this.$_throwInvalidFormat(e);break;case"S":d=this.$_getPattern(e,g,c),3!=d&&this.$_throwInvalidFormat(e);break;case"a":case".":case"/":case"-":case":":d=this.$_getPattern(e,g,c),1!=d&&this.$_throwInvalidFormat(e);break;default:this.$_throwInvalidFormat(e)}d>0&&(this._patterns.push({c:c,p:g,len:d}),g+=d)}},$_throwInvalidFormat:function(a){throw"Invalid date format: "+a},$_throwInvalidValue:function(a){throw"Invalid date text: "+a},$_getPattern:function(a,b,c){for(var d=1;++b<a.length&&a.charAt(b)==c;)d++;return d}}),$$_DT_DATE_TOKENS=["yy","yyyy","M","MM","d","dd","a","H","HH","h","hh","m","mm","s","ss","S","SS","SSS"],$$_DT_DATE_SEPARATORS=[".","/","-",":"],U_0="0".charCodeAt(0),U_9="9".charCodeAt(0),U_Z="Z".charCodeAt(0),L_Z="z".charCodeAt(0),U_A="A".charCodeAt(0),L_A="a".charCodeAt(0),U_Y="Y".charCodeAt(0),L_Y="y".charCodeAt(0),U_M="M".charCodeAt(0),L_M="m".charCodeAt(0),U_D="D".charCodeAt(0),L_D="d".charCodeAt(0),U_H="H".charCodeAt(0),L_H="h".charCodeAt(0),U_S="S".charCodeAt(0),L_S="s".charCodeAt(0),DateTimeWriter=function(a){var b=null,c=null,d=null,e=null,f=!1,g=null,h=function(a){var b=[];if(a)for(var c,d,e,f=a.trim(),g=f.length,h=0;g>h;){if(c=f.charAt(h),$$_DT_DATE_SEPARATORS.indexOf(c)>=0)b.push(c),h++;else{for(d=h++;g>h&&f.charAt(h)==c;)h++;if(c=f.substring(d,h),$$_DT_DATE_TOKENS.indexOf(c)<0&&(e=c.charCodeAt(0),e>=U_A&&U_Z>=e||e>=L_A&&L_Z>=e))throw new Error("Invalid datetime write format: "+a);b.push(c)}if(g>h&&_isWhitespace(c=f.charAt(h)))for(b.push(c);g>h&&_isWhitespace(f.charAt(h));)h++}return b},i=function(a){if(c="AM",d="PM",a){var g=a.split(";");if(b=g[0]||DateTimeWriter.$_DefaultFormat,e=h(b),f=e.indexOf("a")>=0||e.indexOf("A")>=0,g.length>1&&g[1]){var i=g[1].split(",");i.length>0&&i[0]&&(c=i[0]),i.length>1&&i[1]&&(d=i[1])}}},j=function(a){return 10>a?"0"+a:String(a)};this.format=function(){return b},this.formatString=function(){return g},this.setFormatString=function(a){a=a||DateTimeWriter.$_DefaultFormat,a!=g&&(e=[],i(a),g=a)},this.getText=function(a){if(!e)return"";var b=a;b instanceof Date||(b=new Date(a));for(var g,h="",i=0,k=e.length;k>i;i++){var l=e[i],m=l.length;switch(l.charCodeAt(0)){case L_Y:h+=m>2?b.getFullYear():j(b.getFullYear()%100);break;case U_M:h+=m>1?j(b.getMonth()+1):b.getMonth()+1;break;case L_D:h+=m>1?j(b.getDate()):b.getDate();break;case U_H:h+=m>1?j(b.getHours()):b.getHours();break;case L_H:f?(g=b.getHours(),0==g?g=12:g>12&&(g-=12),h+=m>1?j(g):g):h+=m>1?j(b.getHours()):b.getHours();break;case L_M:h+=m>1?j(b.getMinutes()):b.getMinutes();
break;case L_S:h+=m>1?j(b.getSeconds()):b.getSeconds();break;case L_A:case U_A:h+=b.getHours()<12?c:d;break;case U_S:h+=b.getMilliseconds().toString().substr(0,m);break;default:h+=l}}return h},this.setFormatString(a||DateTimeWriter.$_DefaultFormat)};DateTimeWriter.$_DefaultFormat="yyyy/MM/dd",DateTimeWriter.Default=new DateTimeWriter(DateTimeWriter.$_DefaultFormat);var $$_DATE_TOKENS=["yy","yyyy","M","MM","d","dd","a","A","H","HH","h","hh","m","mm","s","ss"],$$_DATE_SEPARATORS=[".","/","-",":"],$$_ZERO_CHAR="0".charCodeAt(0),$$_NINE_CHAR="9".charCodeAt(0),$$_WEEK_TIME=6048e5,$$_NOW=new Date,DatetimeConverter=function(a){var b=null,c=null,d=null,e=null,f=2e3,g=!1,h=function(a){var b,c=[];if(b=_trim(a)){for(var d,e,f=b.length,g=0;f>g;){if(d=b.charAt(g),$$_DATE_SEPARATORS.indexOf(d)>=0)c.push(d),g++;else{for(e=g++;f>g&&b.charAt(g)==d;)g++;if(d=b.substring(e,g),$$_DATE_TOKENS.indexOf(d)<0)throw new Error("Invalid datetime read format: "+a);c.push("A"==d?"a":d)}if(f>g&&_isWhitespace(d=b.charAt(g)))for(c.push(" ");f>g&&_isWhitespace(b.charAt(g));)g++}var h=[];for(f=c.length,e=0,g=0;f>g;g++)d=c[g],"a"==d||$$_DATE_TOKENS.indexOf(d)<0?(e>1&&h.push("E"),h.push(d),e=0):(1==e&&h.splice(h.length-2,0,"L"),h.push(d),e++);c=h}return c},i=function(a,b,c){var d,e=[],f=["am","pm","AM","PM","Am","Pm","aM","pM"];if(b&&f.push(b),c&&f.push(c),d=_trim(a))for(var g,h,i=d.length,j=0;i>j;){if(g=d.charAt(j),DATE_SEPARATORS.indexOf(g)>=0)e.push(g),j++;else if(g.charCodeAt(0)>=$$_ZERO_CHAR&&g.charCodeAt(0)<=$$_NINE_CHAR){for(h=j++;i>j&&d.charCodeAt(j)>=$$_ZERO_CHAR&&d.charCodeAt(j)<=$$_NINE_CHAR;)j++;g=d.substring(h,j),e.push(g)}else{for(var k=-1,l=0;l<f.length;l++)if(d.indexOf(f[l],j)==j){k=l;break}if(0>k)throw"Invalid date value: "+d;e.push(f[l]),j+=f[l].length}if(i>j&&_isWhitespace(g=d.charAt(j)))for(e.push(" ");i>j&&_isWhitespace(d.charAt(j));)j++}return e},j=function(a){if(a=_trim(a)){var b=h(a),c=b.indexOf("a")>=0;if(c&&b.indexOf("H")>=0)throw"Invalid datetime read format - 'H'와 'a'가 같이 존재할 수 없습니다: "+a;if(b.indexOf("h")>=0&&!c)throw"Invalid datetime read format - 'h'가 있으면 'a'가 반드시 있어야 합니다: "+a}},k=function(a){if(d="am",e="pm",f=2e3,g=!1,a){var b=a.split(";");if(c=b[0]?b[0]:_defaultFormat,j(c),b.length>1&&b[1]&&(f=_int(b[1])),b.length>2&&b[2]){var h=b[2].split(",");d=h[0]?h[0]:"am",h.length>1&&(e=h[1]?h[1]:"pm")}b.length>3&&(g=b[3]?"1"==b[3]:!1)}};this.formatString=function(){return b},this.setFormatString=function(a){a!=b&&(b=a,k(a))},this.format=function(){return c},this.getDate=function(a){var b=null;if(a=_trim(a)){for(var g,j=h(c),k=i(a,d,e),l=(j.indexOf("a")>=0||j.indexOf("A")>=0,j.length),m=k.length,n=0,o=1,p=1,q=0,r=0,s=0,t=0,u=0,v=0,w=0;l>v&&m>w;){var x=j[v],y=k[w];switch(x.charAt(0)){case"L":for(g=String(y),v++;l>v&&"E"!=(a=j[v]);){switch(y=g?_int(g.substr(0,a.length)):-1,g=g.substr(a.length),a.charAt(0)){case"Y":case"y":n=Math.max(0,y);break;case"M":o=y>=0?y:1;break;case"D":case"d":p=y>=0?y:1;break;case"H":case"h":q=Math.max(0,y);break;case"m":r=Math.max(0,y);break;case"s":s=Math.max(0,y)}v++}break;case"Y":case"y":n=_int(y);break;case"M":o=_int(y);break;case"D":case"d":p=_int(y);break;case"H":case"h":q=_int(y);break;case"m":r=_int(y);break;case"s":s=_int(y);break;case"a":a=String(y),a&&(a=a.toLowerCase(),d&&a==d.toLowerCase()||"am"==a?t=12:(e&&a==e.toLowerCase()||"pm"==a)&&(u=12))}v++,w++}if(100>n&&n>=0&&(n+=f),0>n||n>9999)return null;if(1>o||o>12)return null;if(1>p||p>31)return null;if(2==o){if(p>29)return null;if(29==p&&(n%4!=0||n%100==0)&&n%400!=0)return null}if(0>q||q>24)return null;if((t>0||u>0)&&q>12)return null;if(0>r||r>59)return null;if(0>s||s>59)return null;t>0?q%=12:u>0&&(q=q%12+12),b=new Date(n,o-1,p,q,r,s)}return b},this.getDateNull=function(a){try{return this.getDate(a)}catch(b){}return null},this.getText=function(a){var b=a;b instanceof Date||(b=new Date(a));for(var f,g=h(c),i=g.indexOf("a")>=0||g.indexOf("A")>=0,j="",k=0,l=g.length;l>k;k++){var m=g[k],n=m.length;switch(m.charAt(0)){case"L":break;case"Y":case"y":j+=n>2?b.getFullYear():pad(b.getFullYear()%100);break;case"M":j+=n>1?pad(b.getMonth()+1):b.getMonth()+1;break;case"D":case"d":j+=n>1?pad(b.getDate()):b.getDate();break;case"H":j+=n>1?pad(b.getHours()):b.getHours();break;case"h":i?(f=b.getHours(),0==f?f=12:f>12&&(f-=12),j+=n>1?pad(f):f):j+=n>1?pad(b.getHours()):b.getHours();break;case"m":j+=n>1?pad(b.getMinutes()):b.getMinutes();break;case"s":j+=n>1?pad(b.getSeconds()):b.getSeconds();break;case"A":case"a":j+=b.getHours()<12?d:e;break;default:j+=m}}return j},this._daysOfYear=function(a){for(var b=[31,28,31,30,31,30,31,31,30,31,30],c=0,d=0;d<a.getMonth();d++)c+=b[d];if(a.getMonth()>=2){var e=a.getFullYear();(e%400==0||e%4==0&&e%100!=0)&&c++}return c+=a.getDate()},this._daysOfPriorYears=function(a){if(1900>=a)return 0;a--;var b=parseInt(a/4)-parseInt(a/100)+parseInt(a/400)-460;return 365*(a-1899)+b},this.toExcelDate=function(a){var b=864e5,c=(1e3*(60*(60*a.getHours()+a.getMinutes())+a.getSeconds())+a.getMilliseconds())/b,d=this._daysOfPriorYears(a.getFullYear())+this._daysOfYear(a),e=d+c;return e>=60&&e++,e},this.getDateValue=function(a,b,c){if(!_isDate(a))return null;switch(b){case DateValueType.YEAR:return a.getFullYear();case DateValueType.HALF:return a.getMonth()>5?2:1;case DateValueType.QUARTER:return _floor(a.getMonth()/3)+1;case DateValueType.MONTH:return a.getMonth()+1;case DateValueType.WEEKOFYEAR:var d=new Date(a.getFullYear(),0,1);return d.setDate(d.getDate()-d.getDay()),_floor((a-d)/$$_WEEK_TIME)+1;case DateValueType.WEEKOFMONTH:var d=new Date(a.getFullYear(),a.getMonth(),1);return d.setDate(d.getDate()-d.getDay()),_floor((a-d)/$$_WEEK_TIME)+1;case DateValueType.WEEKDAY:return a.getDay()+1;case DateValueType.DAY:return a.getDate();case DateValueType.HOUR:return a.getHours();case DateValueType.CUSTOM:return c.getText(a)}},this.setFormatString(a)};DatetimeConverter.$_DefaultFormat="yyyy/MM/dd",DatetimeConverter.Default=new DatetimeConverter(DatetimeConverter.$_DefaultFormat);var ISODateTimeParser=function(){},$$_zoneOffset=60*$$_NOW.getTimezoneOffset()*1e3;ISODateTimeParser.parse=function(a,b){var c=null;try{var d,e,f,g,h=a.indexOf("T"),i=a.substring(0,h),j=a.substring(h+1),k=i.split("-"),l=k.length,m=_int(k[0]),n=l>1?_int(k[1]):1,o=l>2?_int(k[2]):1;-1!=j.indexOf("Z")?(d=1,e=0,f=0,j=j.replace("Z","")):-1!=j.indexOf("+")?(d=1,g=j.substring(j.indexOf("+")+1,j.length),e=Number(g.substring(0,g.indexOf(":"))),f=Number(g.substring(g.indexOf(":")+1,g.length)),j=j.substring(0,j.indexOf("+"))):-1!=j.indexOf("-")?(d=-1,g=j.substring(j.indexOf("-")+1,j.length),e=Number(g.substring(0,g.indexOf(":"))),f=Number(g.substring(g.indexOf(":")+1,g.length)),j=j.substring(0,j.indexOf("-"))):d=0;var p=j.split(":");l=p?p.length:0;var q=l>0?_int(p[0]):0,r=l>1?_int(p[1]):0,s=l>2?String(p[2]).split("."):null,t=s&&s.length>0?_int(s[0]):0,u=s&&s.length>1?1e3*parseFloat("0."+s[1]):0,v=Date.UTC(m,n-1,o,q,r,t,u),w=d?(36e5*e+6e4*f)*d:-$$_zoneOffset;if(c=new Date(v-w),b&&isNaN(c.getTime()))throw"Invalidate date text: "+a}catch(x){if(b){var y="Invalid date Text: "+a;throw y+="\nError: "+x.toString()}}return c};var DateTimeReader=function(a){var b=null,c=0,d=new DateTimeParser,e=function(a){if(a){var b=a.toLowerCase();c=Math.max(0,DateTimeReader.FORMATS.indexOf(b)),0==c&&d.setFormat(a)}};this.format=function(){return b},this.setFormat=function(a){a!=b&&(b=a,e(a))},this.amText=function(){return d.amText()},this.setAmText=function(a){d.setAmText(a)},this.pmText=function(){return d.pmText()},this.setPmText=function(a){d.setPmText(a)},this.baseYear=function(){return d.baseYear()},this.setBaseYear=function(a){d.setBaseYear(a)},this.toDate=function(a){if(void 0===a||null===a||""===a)return null;var b=a;if(!(b instanceof Date)){var e=String(a);if(e)switch(c){case 0:b=d.parse(e);break;case 1:b=ISODateTimeParser.parse(e);break;case 2:default:b=new Date(e)}}return b?isNaN(b.getTime())?null:b:null},this.setFormat(a)};DateTimeReader.FORMATS=["custom","iso","platform"],DateTimeReader.Default=new DateTimeReader("yyyy/MM/dd HH:mm:ss"),DateTimeReader.Default.setAmText("AM"),DateTimeReader.Default.setPmText("PM"),DateTimeReader.Default.setBaseYear(2e3),ExcelFormatConverter=defineClass("ExcelFormatConverter",null,{},{convertNumberFormat:function(a){return a.indexOf(".#")>0?a.replace(".#",".0"):a},convertDateFormat:function(a){for(var b="",c=a.length,d=0;c>d;d++){var e=a.charAt(d);switch(e){case"y":case"d":case"m":case"s":case":":b+=e;break;case"M":b+="m";break;case"a":b+="AM/PM";break;case"H":b+="h",(d>=c-1||"H"!=a.charAt(d+1))&&(b+="h");break;case"h":(0==d||"h"!=a.charAt(d-1))&&(b+="h");break;case"S":break;case".":case"/":case"-":case" ":(d>=c-1||"S"!=a.charAt(d+1))&&(b=b+"\\"+e);break;default:b=b+'"'+e+'"'}}return b}}),ExcelFormatConverter.Default=new ExcelFormatConverter;var ValueTokenParse=function(expr,v){return expr.replace(/(\$\{)(.+)(\})/,function(match,a,b,c){return"value"==b?v:b.indexOf("value")>=0?eval(b.replace("value",v)):match})},DataOptions=defineClass("DataOptions",PivotOptions,{trimOutputNumber:!0}),FieldType=_enum({COLUMN:"column",ROW:"row",VALUE:"value"}),ValueType=_enum({SUM:"sum",COUNT:"count",MIN:"min",MAX:"max",AVERAGE:"avg",DISTINCT:"distinct"}),DateValueType=_enum({YEAR:"year",HALF:"half",QUARTER:"quarter",MONTH:"month",WEEKOFYEAR:"weekofyear",WEEKOFMONTH:"weekofmonth",WEEKDAY:"weekday",DAY:"day",HOUR:"hour",CUSTOM:"custom"}),FilterType=_enum({ALL:"all",EXPRESSION:"expression",ITEMS:"items"}),FilterOperation=_enum({AND:"and",OR:"or"}),SortMethod=_enum({LABEL:"label",VALUE:"value"}),SortDirection=_enum({NONE:"none",ASCENDING:"ascending",DESCENDING:"descending"}),PivotField=defineClass("PivotField",null,{init:function(a,b){this._super(),this._owner=a,this._dataSource=a.getDataSource(),this._orgField=null,this._sourceFieldIndex=INIT_INDEX,this._displayFieldIndex=INIT_INDEX,this._formatter=null,b&&this.assign(b)},destroy:function(){this._owner=null,this._dataSource=null,this._orgField=null,this._formatter&&(this._formatter.destroy(),this._formatter=null),this._super()},name:null,sourceField:null,fieldHeader:null,fieldType:null,dateType:null,dateFormat:null,labelEnable:!0,valueEnable:!0,filterEnable:!0,width:null,displayLabels:null,displayFormat:null,displayField:null,labelPrefix:null,labelSuffix:null,summaryHeader:null,summaryFormat:null,summaryPrefix:null,summarySuffix:null,mustValues:null,sortDir:SortDirection.NONE,sortCallback:null,expression:null,numberFormat:null,prefix:null,suffix:null,valueAlignment:null,exportFormat:null,setDateType:function(a){var b=getRGFieldType(this._orgField);b==RGValueType.DATETIME?this._dateType=a:this._dateType=null},setSourceField:function(a){this._sourceField!=a&&(this._sourceField=a,a?(this._sourceFieldIndex=this._dataSource.getFieldIndex(a),this._orgField=this._dataSource.getField(this._sourceFieldIndex),assert(this._sourceFieldIndex>INIT_INDEX,"sourceField is not found in dataProvider.")):(this._sourceFieldIndex=INIT_INDEX,this._orgField=null))},setDisplayField:function(a){this._displayField!=a&&(this._displayField=a,a?(this._displayFieldIndex=this._dataSource.getFieldIndex(a),assert(this._displayFieldIndex>INIT_INDEX,"displayField is not found in dataProvider.")):this._displayFieldIndex=INIT_INDEX)},setDisplayLabels:function(a){a?this._displayLabels=_clone(a):this._displayLabels=null},getDisplayLabels:function(){return this._displayLabels?_clone(this._displayLabels):null},setNumberFormat:function(a){a!=this._numberFormat&&(a&&(this._formatter?this._formatter._parse(a):this._formatter=new DecimalFormatter(a)),this._numberFormat=a)},sortDir:function(){return this._sortCallback?SortDirection.NONE:this._sortDir||SortDirection.ASCENDING},setSortDir:function(a){this._sortCallback||(this._sortDir=a)},setDateFormat:function(a){this._dateFormat!=a&&(a?this._dateFormatter?this._dateFormatter.setFormatString(a):this._dateFormatter=new DateTimeWriter(a):this._dateFormatter=null,this._dateFormat=a)},dateFormatter:function(){return this._dateFormatter},assign:function(a){assert(a.sourceField,"sourceField is not defined."),this._super(a),!a.name&&(this._name=a.sourceField);var b=getRGFieldType(this._orgField);b!=RGValueType.NUMBER||this._numberFormat||this.setNumberFormat("#0")},getOrgIndex:function(){return this._sourceFieldIndex},getFieldHeader:function(){return this._fieldHeader?this._fieldHeader:this._name},getDataType:function(){return getRGFieldType(this._orgField)},getSummaryLabel:function(a,b){if(this._summaryHeader)return this._summaryHeader;var c;return c=this._summaryFormat?ValueTokenParse(this._summaryFormat,a).replace("${label}",b):a+"",this._summaryPrefix&&(c=this._summaryPrefix+c),this._summarySuffix&&(c+=this._summarySuffix),c},getLabelText:function(a,b){if(b&&this._displayFieldIndex>INIT_INDEX)return b[this._displayFieldIndex];if(this._displayLabels)return this._displayLabels[a];var c;return c=this._displayFormat?ValueTokenParse(this._displayFormat,a):a+"",this._labelPrefix&&(c=this._labelPrefix+c),this._labelSuffix&&(c+=this._labelSuffix),c},getDisplayText:function(a){var b;return _defined(a)&&(b=this._formatter?this._formatter.format(a):a,this._prefix&&(b=this._prefix+b),this._suffix&&(b+=this._suffix)),b}}),PivotFieldManager=defineClass("PivotFieldManager",null,{init:function(a){this._super(),this._owner=a,this._fields=[],this._columns=[],this._rows=[],this._values=[],this._valueSort={}},destroy:function(){this.clear(),this._owner=null,this._super()},$_fillFieldList:function(a,b,c){var d;if(b)for(var e=0,f=b.length;f>e;e++)if(d=_isStr(b[e])?this.getFieldByName(b[e]):this.getFieldByName(b[e].name)){a==FieldType.VALUE&&d.setExpression(b[e].expression?b[e].expression:ValueType.SUM),d.setFieldType(a);var g=d.sortDir();d.setSortDir(b[e].direction?b[e].direction:g==SortDirection.NONE?SortDirection.ASCENDING:g),d&&c.push(d)}},$_packFieldList:function(a,b){for(var c,d=[],e=0,f=b.length;f>e;e++)c=b[e],a==FieldType.VALUE?d.push({name:c.name(),expression:c.expression()}):d.push(c.name());return d},clear:function(){var a,b;this._columns=[],this._rows=[],this._values=[],this._sortMethod=SortMethod.LABELS,this._colDirFlds=[],this._rowDirFlds=[],this._colCondFlds=[],this._rowCondFlds=[],this._valueField=null;for(var a=0,b=this._fields.length;b>a;a++)this._fields[a].destroy(),delete this._fields[a];this._fields=[]},fieldCount:function(){return this._fields.length},getField:function(a){return this._fields[a]},getFieldByName:function(a){for(var b=0,c=this._fields.length;c>b;b++)if(this._fields[b].name()==a)return this._fields[b];return null},columnCount:function(){return this._columns.length},getColumn:function(a){return this._columns[a]},getColumns:function(){return this._columns},getColumnNames:function(){for(var a=[],b=0,c=this._columns.length;c>b;b++)a.push(this._columns[b].name());return a},rowCount:function(){return this._rows.length},getRow:function(a){return this._rows[a]},getRows:function(){return this._rows},getRowNames:function(){for(var a=[],b=0,c=this._rows.length;c>b;b++)a.push(this._rows[b].name());return a},valueCount:function(){return this._values.length},getValueNames:function(){for(var a=[],b=0,c=this._values.length;c>b;b++)a.push(this._values[b].name());return a},getValue:function(a){return this._values[a]},getValues:function(){return this._values},getFieldsText:function(a,b){for(var c="",d=0,e=a.length;e>d;d++){c&&(c+=", ");var f=a[d];c+=f.getFieldHeader(),b&&(c+="("+RealPivotMessages.valueTypeTexts[f.expression()]+")")}return c},setFieldMapping:function(a){var b,c;for(this.clear(),b=0,c=a.length;c>b;b++){var d=new PivotField(this._owner,a[b]);this._fields.push(d)}},setPivotFields:function(a){this._columns=[],this._rows=[],this._values=[],this.$_fillFieldList(FieldType.COLUMN,a.columns,this._columns),this.$_fillFieldList(FieldType.ROW,a.rows,this._rows),this.$_fillFieldList(FieldType.VALUE,a.values,this._values)},getPivotFields:function(a){return{columns:this.$_packFieldList(FieldType.COLUMN,this._columns),rows:this.$_packFieldList(FieldType.ROW,this._rows),values:this.$_packFieldList(FieldType.VALUE,this._values)}},clearSort:function(){for(var a=this._fields.length;a--;)this._fields[a].setSortDir(SortDirection.NONE);this._valueSort={}},clearValueSort:function(){this._valueSort={}},setValueSort:function(a,b,c,d){this._valueSort[a]||(this._valueSort[a]={});var e=this._valueSort[a];e.fieldName=b,e.direction=c,e.conditions=_extend(d)},getValueSort:function(a){return this._valueSort[a]},getFieldSortDir:function(a,b){if(a==FieldType.VALUE){var c=this._valueSort[FieldType.COLUMN],d=this._valueSort[FieldType.ROW];return c&&c.fieldName==b?c.direction:d&&d.fieldName==b?d.direction:SortDirection.NONE}var e=this._valueSort[a];return e?SortDirection.NONE:this.getFieldByName(b).sortDir()}}),PivotSortManager=defineClass("PivotFieldManager",null,{init:function(a){this._super(),this._fieldManager=a,this.clear()},destroy:function(){this.clear(),this.fieldManager=null,this._super()},$_fillSortLabels:function(a,b,c){for(var d=0,e=a.length;e>d;d++){b.push(a[d].name);var f=a[d].direction?a[d].direction:SortDirection.ASCENDING,g=this._fieldManager.getFieldByName(a[d].name);g.setSortDir(f),c.push(f)}},$_fillSortConditions:function(a,b,c){for(var d=0,e=a.length;e>d;d++)b.push(a[d].name),c.push(a[d].value)},$_packSortLabels:function(a,b){for(var c=[],d=0,e=a.length;e>d;d++)c.push({name:a[d],direction:b[d]});return c},$_packSortConditions:function(a,b){for(var c=[],d=0,e=a.length;e>d;d++)c.push({name:a[d],direction:b[d]});return c},clear:function(){this._colSortMethod=SortMethod.LABEL,this._rowSortMethod=SortMethod.LABEL,this._colValueField=null,this._colValueDir=SortDirection.NONE,this._rowValueField=null,this._rowValueDir=SortDirection.NONE,this._colFlds=[],this._rowFlds=[],this._colDirs=[],this._rowDirs=[],this._colCondFlds=[],this._rowCondFlds=[],this._colCondVals=[],this._rowCondVals=[]},setValues:function(a){this.clear(),a&&(a.column&&(a.column.method&&(this._colSortMethod=a.column.method),this._colSortMethod==SortMethod.LABEL?(this.$_fillSortLabels(a.column.labels,this._colFlds,this._colDirs),this._colValueField=null):(this.$_fillSortConditions(a.column.conditions,this._colCondFlds,this._colCondVals),this._colValueField=a.column.fieldName,this._colValueDir=a.column.direction?a.column.direction:SortDirection.ASCENDING)),a.row&&(a.row.method&&(this._rowSortMethod=a.row.method),this._colSortMethod==SortMethod.LABEL?(this.$_fillSortLabels(a.row.labels,this._rowFlds,this._rowDirs),this._rowValueField=null):(this.$_fillSortConditions(a.row.conditions,this._rowCondFlds,this._rowCondVals),this._rowValueField=a.row.fieldName,this._rowValueDir=a.row.direction?a.column.direction:SortDirection.ASCENDING)))},getValues:function(){var a={method:this._sortMethod};switch(this._sortMethod){case SortMethod.COL_VALUES:a.columns=this.$_packSortLabels(this._colFlds,this._colDirs),a.rows=this.$_packSortConditions(this._rowCondFlds,this._rowCondVals);break;case SortMethod.ROW_VALUES:a.columns=this.$_packSortConditions(this._colCondFlds,this._colCondVals),a.rows=this.$_packSortLabels(this._rowFlds,this._rowDirs);break;default:a.columns=this.$_packSortLabels(this._colFlds,this._colDirs),a.rows=this.$_packSortLabels(this._rowFlds,this._rowDirs)}this._sortMethod!=SortMethod.LABELS&&(this._valueField=source.value.name,this._valueDir=source.value.direction?source.value.direction:SortDirection.ASCENDING)},isSorted:function(){return this._colFlds.length>0||this._rowFlds.length>0},getColFldCount:function(){return this._colFlds.length},getRowFldCount:function(){return this._rowFlds.length},getColCondCount:function(){return this._colCondFlds.length},getRowCondCount:function(){return this._rowCondFlds.length},getColFld:function(a){return[this._colFlds[a],this._colDirs[a]]},getRowFld:function(a){return[this._rowFlds[a],this._rowDirs[a]]},getColCondFld:function(a){return[this._colCondFlds[a],this._colCondVals[a]]},getRowCondFld:function(a){return[this._rowCondFlds[a],this._rowCondVals[a]]},getValueFld:function(){return[this._valueField["this"]._valueDir]},getColDir:function(a){var b;return(b=this._colFlds.indexOf(a))>-1?this._colDirs[b]:SortDirection.NONE},getRowDir:function(a){var b;return(b=this._rowFlds.indexOf(a))>-1?this._rowDirs[b]:SortDirection.NONE},getColDirs:function(){return this._colDirs.slice(0)},getRowDirs:function(){return this._rowDirs.slice(0)}}),FilterItem=defineClass("FilterItem",null,{init:function(){this._super(),this._exprNode=null,this._field=null},destroy:function(){this._exprNode=null,this._field=null,this._super()},type:FilterType.ALL,field:null,values:null,getValues:function(){return this._values?this._values.slice(0):null},criteria:null,setCriteria:function(a){a?this._exprNode=ExpressionParser.Default.parse(a,null):this._exprNode=null,this._criteria=a},parse:function(a){if(a.criteria)this._type=FilterType.EXPRESSION,this.setCriteria(a.criteria);else if("all"==a.values)this._type=FilterType.ALL;else if(this._values=[],this._type=FilterType.ITEMS,_isArray(a.values))for(var b=0,c=a.values.length;c>b;b++)this._values.push(a.values[b]);else this._values.push(a.values)},toObject:function(){var a={};switch(a.name=this._field.fieldName(),this._type){case FilterType.ALL:a.values="all";break;case FilterType.EXPRESSION:a.criteria=this._criteria;break;case FilterType.ITEMS:a.values=this._values.slice(0)}return a},checkExpress:function(a,b){return this._exprNode?(a.setData(b),this._exprNode.evaluate(a)):!1},checkInclude:function(a){return this._values&&this._values.length>0?this._values.indexOf(a)>-1:!1}}),FilterManager=defineClass("FilterManager",null,{init:function(a){this._super(),this._owner=a,this._filters=[],this._fieldManager=a.fieldManager()},destroy:function(){this.$_clear(),this._super()},operation:FilterOperation.AND,$_clear:function(){for(var a=this._filters.length;a--;){this._filters[a].field();this._filters[a].destroy(),delete this._filters[a]}this._filters=[]},count:function(){return this._filters.length},getFilter:function(a){return this._filters[a]},reset:function(){this.$_clear()},parse:function(a){this._operation=a.operation?a.operation:FilterOperation.AND,this.$_clear();for(var b=0,c=a.conditions.length;c>b;b++){var d=new FilterItem,e=this._fieldManager.getFieldByName(a.conditions[b].name);assert(null!=e,"[filter] Not found field. ("+a.conditions[b].name+")"),d.setField(e),d.parse(a.conditions[b]),this._filters.push(d)}},toObject:function(){if(this._filters.length>0){var a={};a.operation=this._operation,a.conditions=[];for(var b=0,c=this._filters.length;c>b;b++){var d=this._filters[b];a.conditions.push(d.toObject())}return a}return null},select:function(a,b){for(var c=this._filters.length,d=0==c||this._operation==FilterOperation.AND?!0:!1,e=0;c>e;e++){var f=this._filters[e],g=!0;switch(f._type){case FilterType.ALL:break;case FilterType.EXPRESSION:var h=this._owner._getPivotValue(b,f.field());g=f.checkExpress(a,h);break;case FilterType.ITEMS:var h=this._owner._getPivotValue(b,f.field());g=f.checkInclude(h)}d=this._operation==FilterOperation.AND?d&&g:d||g}return d}}),LabelData=function(a,b,c){this.name=a,this.value=b,this.label=c,this.keepChild=!1,this.childs={},this.refCount=void 0,this.refValue=void 0};LabelData.prototype.toProxy=function(){var a={childs:[]};if(a.value=this.value,a.label=this.label,this.hasOwnProperty("childs"))for(var b=0,c=this.childs.length;c>b;b++)a.childs.push(this.childs[b].toProxy());return a};var ValueData=function(){this.value=0,this.count=0};ValueData.prototype.initCols=function(){this.cols={}},ValueData.prototype.initRows=function(){this.rows={}};var VALUE_SEPERATOR=":::";ValueData.prototype.toProxy=function(a){if(this.count){var b,c={cols:{},rows:{}};c.value=a&&_isNumber(this.value)?_trimNumber(this.value):this.value;for(var d in this.cols)b=this.cols[d].toProxy(a),b&&(c.cols[d]=b);for(d in this.rows)b=this.rows[d].toProxy(a),b&&(c.rows[d]=b);return c}return void 0},ValueData.prototype.$_childToDescendants=function(a,b,c,d){d=d||1,c=c?c+VALUE_SEPERATOR:"";for(var e in b){var f=b[e];f&&(a[c+e]=f.value,f.hasOwnProperty("childs")&&this.$_childToDescendants(a,f.childs,c+e,d+1))}},ValueData.prototype.toRowProxy=function(a){if(this.count){var b={childs:{},descendants:{}};b.value=a&&_isNumber(this.value)?_trimNumber(this.value):this.value;for(var c in this.cols){var d=this.cols[c].toRowProxy(a);d&&(b.childs[c]=d)}return this.$_childToDescendants(b.descendants,b.childs),b}return void 0},ValueData.prototype.toColProxy=function(a,b){function c(a,b,d){var e=b[d];if(a.cols.hasOwnProperty(e)){var f=a.cols[e];if(d==b.length-1)return f;if(f.hasOwnProperty("cols"))return c(f,b,d+1)}}var d=this;if(a.length>0&&(d=c(d,a,0)),d&&d.count){var e={childs:{},descendants:{}};e.value=b&&_isNumber(this.value)?_trimNumber(this.value):this.value;for(var f in this.rows)e.childs[f]=this.rows[f].toColProxy(a,b);return this.$_childToDescendants(e.descendants,e.childs),e}return void 0},$$_calcfuncs={},$$_calcfuncs[ValueType.SUM]=function(a,b){return _defined(a)?a+b:b},$$_calcfuncs[ValueType.COUNT]=function(a,b){return _defined(a)?a+b:b},$$_calcfuncs[ValueType.MIN]=function(a,b){return _defined(a)?_min(a,b):b},$$_calcfuncs[ValueType.MAX]=function(a,b){return _defined(a)?_max(a,b):b},$$_calcfuncs[ValueType.AVERAGE]=function(a,b,c){return _defined(a)?(a*c+b)/(c+1):b},$$_calcfuncs[ValueType.DISTINCT]=function(a,b){return _defined(b)?b:a};var PivotDataProvider=defineClass("PivotDataProvider",EventAware,{init:function(){this._super(),this._dataSource=null,this._fieldManager=new PivotFieldManager(this),this._columnLeafCount=0,this._rowLeafCount=0,this._baseValues=[],this._filteredValues=[],this._columnLabelRoot={},this._rowLabelRoot={},this._columnLabels=[],this._rowLabels=[],this._values={},this._filters=new FilterManager(this),this._filterRuntime=new FilterRuntime,this._options=new DataOptions},destroy:function(){this._options.destroy(),this._options=null,this._filterRuntime.destroy(),this._filterRuntime=null,this._filters.destroy(),this._filters=null,this._rowLabels=null,this._coumnLabels=null,this._values=null,this._summaries=null,this._baseValues=null,this._filteredValues=null,this._fieldManager.destroy(),this._fieldManager=null,this._dataSource&&this._dataSource.removeListener(this),this._dataSource=null,this._super()},getColumnLabels:function(){return this._columnLabels},getRowLabels:function(){return this._rowLabels},getValues:function(){return this._values},fieldManager:function(){return this._fieldManager},filterManager:function(){return this._filters},isEmpty:function(){return 0==this._fieldManager.valueCount()||0==this._fieldManager.columnCount()&&0==this._fieldManager.rowCount()},isDataEmpty:function(){return _isEmptyObj(this._values)},setDataSource:function(a){a?(assert(a&&a._dp&&a._dp.getDistinctValues&&a._dp._rowIds,"provider indices must be LocalDataProvider."),this._dataSource=a._dp,this._dataSource.addListener(this)):(this._dataSource.removeListener(this),this._dataSource=null)},getOptions:function(){return this._options.proxy()},setOptions:function(a){this._options.assign(a)},getDataSource:function(){return this._dataSource},clearFieldMapping:function(){this._fieldManager.clear()},setFieldMapping:function(a){this._fieldManager.setFieldMapping(a)},getFieldMapping:function(){for(var a=[],b=this._fieldManager,c=0,d=b.fieldCount();d>c;c++)a.push(b.getField(c).proxy());return a},setPivotFields:function(a){this._fieldManager.setPivotFields(a),a.filter?this.filter(a.filter):this.resetFilter(),this.sort(a.sort),this._baseValues&&this._baseValues.length>0&&this.buildPivotData()},getPivotFields:function(){var a=this._fieldManager.getPivotFields(!this._valueSorted);return this._filters.count()>0&&(a.filter=this._filters.toObject()),a},buildPivotData:function(){_trace("#pivot build data");var a=_performenceCountStart();this.$_extractLabels(),this.$_initializeValues(),this.$_summarizeValues(),_trace(_performenceCountEnd(a)+"ms ellapsed."),this.fireEvent(PivotDataProvider.DATA_REFRESHED)},sort:function(a){var b=this._fieldManager;if(b.clearValueSort(),a){var c,d;if(c=a.column)if(c.method==SortMethod.LABEL)for(var e=0,f=c.labels.length;f>e;e++)d=b.getFieldByName(c.labels[e].name),d&&d.setSortDir(c.labels[e].direction);else this._fieldManager.setValueSort(FieldType.COLUMN,c.fieldName,c.direction,c.conditions);if(c=a.row)if(c.method==SortMethod.LABEL)for(var e=0,f=c.labels.length;f>e;e++)d=b.getFieldByName(c.labels[e].name),d&&d.setSortDir(c.labels[e].direction);else this._fieldManager.setValueSort(FieldType.ROW,c.fieldName,c.direction,c.conditions)}},resetFilter:function(){this._filters.reset(),this._filteredValues=_clone(this._baseValues)},filter:function(a){a&&this._filters.parse(a),this._filteredValues=[];for(var b=0,c=this._baseValues.length;c>b;b++)this._filters.select(this._filterRuntime,this._baseValues[b])&&this._filteredValues.push(this._baseValues[b])},getDistinctValues:function(a,b,c,d,e){return this.$_getDistinctValues(a,b,c,d,e)},getBodyCount:function(){return this._columnLeafCount*this._fieldManager.valueCount()*this._rowLeafCount},getValueData:function(){var a={},b=this._options.isTrimOutputNumber();for(attr in this._values)a[attr]=this._values[attr].toProxy(b);return a},getRowValueData:function(a,b){var c=this._fieldManager.getRowNames(),d=this._values[a];if(d){for(var e=this._options.isTrimOutputNumber(),f=0;f<c.length;f++){var g=c[f];if(!b.hasOwnProperty(g))break;d=d.rows[b[g]]}return d&&d.toRowProxy(e)}},getColumnValueData:function(a,b){var c=this._fieldManager.getColumnNames(),d=this._values[a];if(d){for(var e=this._options.isTrimOutputNumber(),f=[],g=0;g<c.length;g++){var h=c[g];if(!b.hasOwnProperty(h))break;f.push(b[h])}return d&&d.toColProxy(f,e)}},getColumnLabelData:function(){for(var a=[],b=0,c=this._columnLabels.length;c>b;b++)a.push(this._columnLabels[b].toProxy());return a},getRowLabelData:function(){for(var a=[],b=0,c=this._rowLabels.length;c>b;b++)a.push(this._rowLabels[b].toProxy());return a},onDataProviderRefresh:function(){this._baseValues=this._dataSource.getRows(),this._filteredValues=_clone(this._baseValues),this._filters.count()>0?this.filter():this._filteredValues=_clone(this._baseValues),this.buildPivotData()},_getPivotValue:function(a,b){var c=a[b.getOrgIndex()];return null!=b.dateType()&&(c=DatetimeConverter.Default.getDateValue(c,b.dateType(),b.dateFormatter())),c},$_getDistinctValues:function(a,b,c,d,e,f,g,h){var i,j,k,m,n=[],o=(this._fieldManager,d?this._filteredValues:this._baseValues),p=b.length;for(i=0,l=o.length;i<l;i++){var q=o[i];k=this._getPivotValue(q,a);var r=_indexOfObj(n,"value",k),s=0>r;if(s||f){var t=!0;for(j=0;p>j;j++)if(m=this._getPivotValue(q,b[j]),m!=c[j]){t=!1;break}var u;if(t&&(s?(u={},u.name=a._name,u.value=k,a._displayFieldIndex>INIT_INDEX?u.label=q[a._displayFieldIndex]:a._displayFormat?u.label=ValueTokenParse(a._displayFormat,k):a._displayLabels&&(u.label=a._displayLabels[k]),n.push(u)):u=n[r]),f&&u){for(var v=!0,w=0,x=h.length;x>w;w++)if(h[w]!=this._getPivotValue(q,g[w])){v=!1;break}if(v){var y=f.expression(),z=this._getPivotValue(q,f);if(y==ValueType.AVERAGE){var A=u.refCount?u.refCount:0;u.refValue=(u.refValue*A+z)/A++,u.refCount=A}else _defined(z)&&(u.refValue=$$_calcfuncs[y](u.refValue,z))}}}}return e&&(f?n.sort(e==SortDirection.DESCENDING?this.$_compareDescByRefValue:this.$_compareByRefValue):n.sort(e==SortDirection.DESCENDING?this.$_compareDescByValue:this.$_compareByValue)),n},$_compareByValue:function(a,b){var c=void 0===a.value?0:a.value,d=void 0===b.value?0:b.value;return c>d?1:d>c?-1:0},$_compareDescByValue:function(a,b){var c=void 0===a.value?0:a.value,d=void 0===b.value?0:b.value;return c>d?-1:d>c?1:0},$_compareByRefValue:function(a,b){var c=void 0===a.refValue?0:a.refValue,d=void 0===b.refValue?0:b.refValue;return c>d?1:d>c?-1:0},$_compareDescByRefValue:function(a,b){var c=void 0===a.refValue?0:a.refValue,d=void 0===b.refValue?0:b.refValue;return c>d?-1:d>c?1:0},$_getFieldLabels:function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o=function(a,b,c){if(!(c>b.length-1)){var d,e=b[c],f=e.mustValues();if(_isArray(f))for(m=f.length;m--;)if(d=f[m],!a[d]){var g=e.getLabelText(d);
a[d]=new LabelData(e.name(),d,g),c<b.length-1&&(a[d].keepChild=!0)}for(d in a)o(a[d].childs,b,c+1)}},p=function(a,b,c,d){var e=0;for(var f in b){var g=b[f],h=_clone(g);h.childs=[],_isEmptyObj(g.childs)?g.keepChild||(e++,delete h.childs):e+=p(h.childs,g.childs,c,d+1),a.push(h)}var i=s[d],j=t[d];return j?a.sort(j):i&&(c?a.sort(i==SortDirection.DESCENDING?this.$_compareDescByRefValue:this.$_compareByRefValue):a.sort(i==SortDirection.DESCENDING?this.$_compareDescByValue:this.$_compareByValue)),e}.bind(this),q=this._filteredValues,r={},s=[],t=[],u=q.length,v=c.length;for(m=0;u>m;m++)for(k=b,i=q[m],n=0;v>n;n++){if(l=c[n],0==m&&(s.push(f?f:l.sortDir()),t.push(l.sortCallback())),j=this._getPivotValue(i,l),k.hasOwnProperty(j))r=k[j];else{var w=l.getLabelText(j,i);r=k[j]=new LabelData(l.name(),j,w)}if(e&&r){for(var x=!0,y=0,z=h.length;z>y;y++)if(h[y]!=this._getPivotValue(i,g[y])){x=!1;break}if(x&&_defined(B)){var A=e.expression(),B=this._getPivotValue(i,e),C=r.refCount?r.refCount:0;r.refValue=$$_calcfuncs[A](r.refValue,B,C),r.refCount=C}}k=k[j].childs}return o(b,c,0),p(a,b,e,0)},$_extractLabels:function(){var a=this._fieldManager.getColumns(),b=this._fieldManager.getRows();this._columnLeafCount=0,this._rowLeafCount=0;var c=this._fieldManager,d=c.getValueSort(FieldType.COLUMN),e=c.getValueSort(FieldType.ROW);if(this._columnLabels=[],this._columnLabelRoot={},a.length>0)if(d&&d.fieldName){for(var f=c.getFieldByName(d.fieldName),g=[],h=[],i=0,j=d.conditions.length;j>i;i++)g.push(c.getFieldByName(d.conditions[i].name)),h.push(d.conditions[i].value);this._columnLeafCount=this.$_getFieldLabels(this._columnLabels,this._columnLabelRoot,a,[],f,d.direction,g,h)}else this._columnLeafCount=this.$_getFieldLabels(this._columnLabels,this._columnLabelRoot,a,[]);if(this._rowLabels=[],this._rowLabelRoot={},b.length>0)if(e&&e.fieldName){for(var f=c.getFieldByName(e.fieldName),g=[],h=[],i=0,j=e.conditions.length;j>i;i++)g.push(c.getFieldByName(e.conditions[i].name)),h.push(e.conditions[i].value);this._rowLeafCount=this.$_getFieldLabels(this._rowLabels,this._rowLabelRoot,b,[],f,e.direction,g,h)}else this._rowLeafCount=this.$_getFieldLabels(this._rowLabels,this._rowLabelRoot,b,[])},$_getValueLabels:function(a,b){for(var c=[],d=0,e=b.length;e>d;d++){var f=b[d];if(a[f.getOrgIndex()]){var g={};g.name=b[d].name(),g.value=this._getPivotValue(a,f),c.push(g)}}return c},$_findValue:function(a,b,c,d){for(var e,f=0,g=a.length;g>f;f++)if(e=a[f],_equalsArray(e.rows,b)&&_equalsArray(e.cols,c)&&e.valueField==d.name())return e;return null},$_putValue:function(a,b,c,d,e,f){var g=d.expression(),h=$$_calcfuncs[g],i=this.$_findValue(a,b,c,d);_defined(e)&&(i?(f?i.count+=f:i.count++,i.value=g==ValueType.COUNT?i.count:h(i.value,e)):(i={},i.rows=b,i.cols=c,i.valueField=d.name(),i.count=f?f:1,i.value=g==ValueType.COUNT?i.count:e,a.push(i)))},$_initializeValues:function(){function a(b,c){for(var d=0,e=c.length;e>d;d++){var f=c[d],g=b[f.value]=new ValueData;f.hasOwnProperty("childs")&&(g.initCols(),a(g.cols,f.childs))}}function b(c,d,e){for(var f=0,g=d.length;g>f;f++){var h=d[f],i=c[h.value]=new ValueData;i.initCols(),a(i.cols,e),h.hasOwnProperty("childs")&&(i.initRows(),b(i.rows,h.childs,e))}}for(var c=this._values={},d=this._fieldManager.getValueNames(),e=0;e<d.length;e++){var f=c[d[e]]=new ValueData;this._columnLabels.length>0&&(f.initCols(),a(f.cols,this._columnLabels)),this._rowLabels.length>0&&(f.initRows(),b(f.rows,this._rowLabels,this._columnLabels))}},$_summarizeValues:function(){var a=this._values;calcSummary=function(a,b,c){a.value=c==ValueType.COUNT?a.value+1:$$_calcfuncs[c](a.value,b,a.count),a.count+=1},colProc=function(a,b,c,d,e,f){var g=b.shift();f.push(g);var h;if(h=a[g.value]?a[g.value]:a[g.value]=new ValueData,_defined(c)&&calcSummary(h,c,d.expression()),b.length>0){var i=h.cols||(h.cols={});colProc(i,b.concat(),c,d,e,f)}},rowProc=function(a,b,c,d,e,f){var g=b.shift();f.push(g);var h;h=a[g.value]?a[g.value]:a[g.value]=new ValueData,_defined(d)&&calcSummary(h,d,e.expression());var i=h.cols||(h.cols={});if(c.length>0&&colProc(i,c.concat(),d,e,f,[]),b.length>0){var j=h.rows||(h.rows={});rowProc(j,b.concat(),c.concat(),d,e,f)}};for(var b,c,d,e,f=this._filteredValues,g=this._fieldManager.getValues(),h=this._fieldManager.getValueNames(),i=this._fieldManager.getColumns(),j=this._fieldManager.getRows(),k=0,l=f.length;l>k;k++){b=f[k],colLabels=this.$_getValueLabels(b,i),rowLabels=this.$_getValueLabels(b,j);for(var m=0,n=h.length;n>m;m++)d=h[m],e=g[m],c=a[d],v=b[e.getOrgIndex()],_defined(v)&&calcSummary(c,v,e.expression()),colLabels.length>0&&colProc(c.cols,colLabels.concat(),v,e,[],[]),rowLabels.length>0&&rowProc(c.rows,rowLabels.concat(),colLabels.concat(),v,e,[])}}});PivotDataProvider.DATA_REFRESHED="onPivotDataRefreshed";var PivotModelItem=defineClass("PivotModelItem",null,{init:function(a,b){this._super(),this._level=a,this._summaryItem=!!b},destroy:function(){this._super()},summaryItem:!1,level:0,prepareChildren:function(){this._childs||(this._childs={})}},{ITEM_SUMMARY:"$$sum"}),PivotCellGroup=defineClass("PivotCellGroup",null,{init:function(){this._super()},destroy:function(){if(this._childs){for(var a in this._childs)this._childs[a].destroy(),this._childs[a]=null;this._childs=null}for(var b in this)this[b]instanceof BaseClass&&(this[b].destroy(),this[b]=null);this._super()},prepareChildren:function(){this._childs||(this._childs={})}}),PivotCellItem=defineClass("PivotCellItem",PivotModelItem,{init:function(a,b,c,d,e){this._super(c,d),this._field=b,this._dataObj=a,this._rowLevel=e.level()},destroy:function(){for(var a in this._childs)this._childs[a].destroy(),this._childs[a]=null;this._field=null,this._dataObj=null,this._super()},rowLevel:0,field:null,width:0,height:0,getValue:function(){return this._dataObj.value},getCount:function(){return this._dataObj.count}}),PivotRowItem=defineClass("PivotColumnModel",PivotModelItem,{init:function(a,b,c,d,e){this._super(d,e),this._childs={},this._cells={},this._dataObjs={},this._dataObjs[c]=a},destroy:function(){var a;for(a in this._childs)this._childs[a].destroy(),this._childs[a]=null;this._childs=null;for(a in this._cells)this._cells[a].destroy(),this._cells[a]=null;this._cells=null,this._dataObjs=null,this._super()},appendCells:function(a,b,c,d){this._dataObjs[c]=a,this.$_buildCells(a,b,c,d)},getCell:function(a,b){for(var c,d=this._cells,e=0,f=a.length;f>e;e++)c=d[a[e]],d=c._childs;return _isEmptyObj(d)||(c=d[PivotModelItem.ITEM_SUMMARY]),c instanceof PivotCellItem?c:c[b]},$_buildCells:function(a,b,c,d){function e(a,b,c,d,f,g,h){var i=new PivotCellItem(b,c,f,!0,h);a[PivotModelItem.ITEM_SUMMARY]=i;for(var j in b.cols){var k=b.cols[j];i=new PivotCellItem(k,c,f+1,g,h),a[j]=i,t=performance.now(),k.cols&&(a[j].prepareChildren(),e(a[j]._childs,k,c,d,f+1,g,h))}}function f(a,b,c,d,e,g,h){var i=new PivotCellItem(b,c,e,!0,h),j=PivotModelItem.ITEM_SUMMARY;a[j]||(a[j]=new PivotCellGroup),a[j][d]=i;for(j in b.cols){var k=b.cols[j];i=new PivotCellItem(k,c,e+1,g,h),a[j]||(a[j]=new PivotCellGroup),a[j][d]=i,_isEmptyObj(k.cols)||(a[j].prepareChildren(),f(a[j]._childs,k,c,d,e+1,g,h))}}d?e(this._cells,a,b,c,0,this._summaryItem,this):f(this._cells,a,b,c,0,this._summaryItem,this)}}),PivotModelManager=defineClass("PivotModelManager",EventAware,{init:function(a){this._super(),this._items={},this._dataSource=a,a.addListener(this)},destroy:function(){this._dataSource.removeListener(this),this._dataSource=null,this.$_clearItems(),this._items=null,this._super()},getRow:function(a){for(var b,c=this._items,d=0,e=a.length;e>d;d++)b=c[a[d]],c=b._childs;return _isEmptyObj(c)||(b=c[PivotModelItem.ITEM_SUMMARY]),b},onPivotDataRefreshed:function(){var a=_performenceCountStart();this.$_clearItems(),this.$_buildItems(this._dataSource),_trace("model build "+_performenceCountEnd(a))},$_clearItems:function(){for(var a in this._items)this._items[a].destroy(),this._items[a]=null},$_buildItems:function(a){function b(a,c,d,e,f,g){a[PivotModelItem.ITEM_SUMMARY]||(a[PivotModelItem.ITEM_SUMMARY]=new PivotRowItem(c,d,e,f,!0)),a[PivotModelItem.ITEM_SUMMARY].appendCells(c,d,e,g);for(var h in c.rows){var i=c.rows[h],j=a[h];j||(j=new PivotRowItem(i,d,e,f+1),a[h]=j),_isEmptyObj(i.rows)?j.appendCells(i,d,e,g):b(j._childs,i,d,e,f+1,g)}}for(var c=a.getValues(),d=a.fieldManager().getValues(),e=this._items={},f=0,g=d.length;g>f;f++){var h=d[f],i=h.name();b(e,c[i],h,i,0,1==g)}this.fireEvent(PivotModelManager.BUILED)}});PivotModelManager.BUILED="onPivotModelManagerBuild";var Request=defineClass("Request",null,{init:function(){this._super()},cursor:function(){return Cursor.AUTO},source:function(){return null},isSelectable:function(){return!1},isDblClickable:function(){return!1}}),CellRequest=defineClass("CellRequest",Request,{init:function(a){this._super(),this._cell=a,a&&(this._grid=a.grid())},destroy:function(){this._super(),this._cell=null},grid:function(){return this._grid},cell:function(){return this._cell},cursor:function(){return null},source:function(){return this._cell},isSelectable:function(){return!0},isDblClickable:function(){return!1}}),ColumnResizeRequest=defineClass("ColumnResizeRequest",CellRequest,{init:function(a){this._super(a)},delta:0,cursor:function(){return Cursor.HORZ_RESIZE},isSelectable:function(){return!1}}),RowResizeRequest=defineClass("RowResizeRequest",CellRequest,{init:function(a){this._super(a)},cursor:function(){return Cursor.VERT_RESIZE},isSelectable:function(){return!1}}),ColumnLevelResizeRequest=defineClass("ColumnLevelResizeRequest",Request,{init:function(a,b){this._super(),this._grid=a,this._level=b},destroy:function(){this._super(),this._grid=null},delta:0,grid:function(){return this._grid},level:function(){return this._level},cursor:function(){return Cursor.VERT_RESIZE},isSelectable:function(){return!1}}),RowLevelResizeRequest=defineClass("RowLevelResizeRequest",Request,{init:function(a,b){this._super(),this._grid=a,this._level=b},destroy:function(){this._super(),this._grid=null},grid:function(){return this._grid},level:function(){return this._level},cursor:function(){return Cursor.HORZ_RESIZE},isSelectable:function(){return!1}}),HeaderResizeRequest=defineClass("HeaderResizeRequest",Request,{init:function(a){this._super(),this._grid=a,this._view=a.headerView()},destroy:function(){this._super(),this._grid=null},grid:function(){return this._grid},view:function(){return this._view},cursor:function(){return Cursor.VERT_RESIZE},isSelectable:function(){return!1}}),DataCellRequest=defineClass("DataCellRequest",Request,{init:function(a){this._super(),this._index=a},cursor:function(){return null},source:function(){return null},isSelectable:function(){return!0}}),DragTracker=defineClass("DragTracker",null,{init:function(a,b,c,d){this._super(),this._container=a,this._name=b,this._active=!1,this._completed=!1,this._dragging=!1,this._startX=c,this._startY=d,this._currentX=0,this._currentY=0},cancelabel:!1,container:function(){return this._container},name:function(){return this._name},isActive:function(){return this._active},isDragging:function(){return this._dragging},startWhenCreated:function(){return!1},isCompleted:function(){return this._completed},activate:function(){this._active||(this._doActivate(),this._active=!0)},deactivate:function(){this._active&&(this.cancel(),this._doDeactivate(),this._active=!1)},start:function(a,b,c){return this.cancel(),this._active&&this._doStart(a,b,c)?(this._currentX=this._startX=a,this._currentY=this._startY=b,this._dragging=!0,this._completed=!1,this._showFeedback(a,b),!0):!1},drag:function(a,b){return this._dragging&&(this._currentX=a,this._currentY=b,this._doDrag(a,b))?(this._moveFeedback(a,b),!0):!1},cancel:function(){try{if(this._dragging)try{this._dragging=!1,this._doCanceled()}finally{this._doEnded()}}finally{this._hideFeedback()}},drop:function(a,b){try{if(this._dragging)try{this._currentX=a,this._currentY=b,this._dragging=!1,this._canAccept(a,b)?(this._doCompleted(a,b),this._completed=!0):this._doCanceled(a,b)}finally{this._doEnded()}}finally{this._hideFeedback()}},getNextRequest:function(a,b){return null},startX:function(){return this._startX},startY:function(){return this._startY},currentX:function(){return this._currentX},currentY:function(){return this._currentY},offsetX:function(){return this._currentX-this._startX},offsetY:function(){return this._currentY-this._startY},_showFeedback:function(a,b){},_moveFeedback:function(a,b){},_hideFeedback:function(){},_doActivate:function(){trace(this._name+" activated")},_doDeactivate:function(){trace(this._name+" deactivated")},_doStart:function(a,b){return!0},_doDrag:function(a,b){return!0},_doCanceled:function(){},_canAccept:function(a,b){return!0},_doCompleted:function(){},_doEnded:function(){},_findElementAt:function(a,b,c){return this._container.findElementAt(a,b,c)}}),GridDragTracker=defineClass("GridDragTracker",DragTracker,{init:function(a,b){this._destroying=!0,this._request=a,this._grid=a.grid(),this._super(this._grid.container(),b)},destroy:function(){this._grid=null,this._super()},request:function(){return this._request},grid:function(){return this._grid},isStartWhenCreated:function(){return!1},checkScrolling:function(){return this._grid.checkScrolling()},checkHScrolling:function(){return this._grid.checkHSCrolling()}}),$$_RESIZE_MIN_W=3,$$_RESIZE_MIN_H=13,ColumnResizeTracker=defineClass("ColumnResizeTracker",GridDragTracker,{init:function(a,b,c){var d=this._cell=a.cell();this._super(a,"columnResizeTracker"),this._startWidth=d.width(),this._offset=b-this._startWidth,this._changeOffset=0,this._descendantCount=_max(1,d.getDescendantCount(!0))},_doStart:function(a,b){return!0},_doDrag:function(a,b){var c=this._cell,d=(this._grid,a-this._offset);if(d>=$$_RESIZE_MIN_W*this._descendantCount){var e=d-this._startWidth;c.changeSize(e,0),this._startWidth=d,this._changeOffset+=e}return!0},_doEnded:function(){var a=this._cell,b=this._grid;a.changeSizeComplete(),b.changeClientSize(a,this._changeOffset,0,LayoutMode.CELL_SIZE);for(var c=a.getFamilyTree(),d=c.length;d--;)b.setOrgColumnWidth(c[d],c[d].width())}}),RowResizeTracker=defineClass("RowResizeTracker",GridDragTracker,{init:function(a,b,c){var d=this._cell=a.cell();this._super(a,"rowResizeTracker"),this._startHeight=d.height(),this._offset=c-this._startHeight,this._changeOffset=0,this._descendantCount=_max(1,d.getDescendantCount(!0))},_doStart:function(a,b){return!0},_doDrag:function(a,b){var c=this._cell,d=(this._grid,b-this._offset);if(d>=$$_RESIZE_MIN_H*this._descendantCount){var e=d-this._startHeight;c.changeSize(0,e),this._changeOffset+=e,this._startHeight=d}return!0},_doEnded:function(){var a=this._cell,b=this._grid;a.changeSizeComplete(),b.changeClientSize(a,0,this._changeOffset,LayoutMode.CELL_SIZE);for(var c=a.getFamilyTree(),d=c.length;d--;)b.setOrgRowHeight(c[d],c[d].height())}}),ColumnLevelResizeTracker=defineClass("ColumnResizeTracker",GridDragTracker,{init:function(a,b,c){this._super(a,"columnLevelResizeTracker"),this._level=a.level(),this._startHeight=this._grid.columnLevelHeight(this._level),this._offset=c-this._startHeight,this._changeOffset=0},_doStart:function(a,b){return!0},_doDrag:function(a,b){var c=this._level,d=this._grid,e=b-this._offset;if(e>=$$_RESIZE_MIN_H){var f=e-this._startHeight;d.changeColumnLevelHeight(c,f),this._changeOffset+=f,this._startHeight=e}return!0},_doEnded:function(){this._grid.changeClientSize(null,0,this._changeOffset,LayoutMode.CELL_SIZE)}}),RowLevelResizeTracker=defineClass("RowLevelResizeTracker",GridDragTracker,{init:function(a,b,c){this._super(a,"rowLevelResizeTracker"),this._level=a.level(),this._startWidth=this._grid.rowLevelWidth(this._level),this._offset=b-this._startWidth,this._changeOffset=0},_doStart:function(a,b){return!0},_doDrag:function(a,b){var c=this._level,d=this._grid,e=a-this._offset;if(e>=$$_RESIZE_MIN_W){var f=e-this._startWidth;d.changeRowLevelWidth(c,f),this._changeOffset+=f,this._startWidth=e}return!0},_doEnded:function(){this._grid.changeClientSize(null,this._changeOffset,0,LayoutMode.CELL_SIZE)}}),HeaderResizeTracker=defineClass("HeaderReiszeTracker",GridDragTracker,{init:function(a,b,c){this._super(a,"headerResizeTracker");var d=this._view=a.view();this._startPos=d.rowSplitPos(),this._top=d.titleHeight(),this._offset=c-this._top-this._startPos},_doStart:function(a,b){return!0},_doDrag:function(a,b){var c=b-this._offset;return c>=$$_RESIZE_MIN_H&&c<=this._view.height()-$$_RESIZE_MIN_H&&(this._view.setRowSplitPos(c-this._top),this._startPos=c),!0},_doEnded:function(){}}),DefaultPivotUITool=defineClass("DefaultPivotUITool",VisualTool,{init:function(a){this._super(a),this._request=null,this._scrollTool=new GridScrollTool(a),this._hoveredCell=null,this._tooltipCell=null,this._tooltipIndex=null,this._focused=!1;var b=this.$_createCopyElement(a._element);Dom.addEventListener(b,"focusin",this.$_focusinHandler.bind(this),!1),Dom.addEventListener(b,"blur",this.$_blurHandler.bind(this),!1),Dom.addEventListener(b,"focusout",this.$_focusoutHandler.bind(this),!1),Dom.addEventListener(b,"copy",this.$_copyHandler.bind(this),!1)},destroy:function(){var a=this._copyElement;Dom.removeEventListener(a,"focusin",this.$_focusinHandler.bind(this),!1),Dom.removeEventListener(a,"blur",this.$_blurHandler.bind(this),!1),Dom.removeEventListener(a,"focusout",this.$_focusoutHandler.bind(this),!1),Dom.removeEventListener(this._copyElement,"copy",this.$_copyHandler.bind(this),!1),this._owner._element.removeChild(this._copyContainer),this._scrollTool.destroy(),this._scrollTool=null,this._copyElement=null,this._copyContainer=null,this._super()},$_createCopyElement:function(a){var b=this._copyContainer=document.createElement("div");b.spellcheck=!1,b.setAttribute("aria-hidden","true"),b.style.outline="none",b.style.position="absolute",b.style.border="none",b.style.width="0px",b.style.height="0px",b.style["z-index"]=10,b.style["box-sizing"]="border-box",b.style.overflow="hidden",b.style.border="none",b.style.width="0px",b.style.height="0px",b.style.padding="0px",b.style.margin="0px";var b=this._copyElement=_doc.createElement("input");return b.setAttribute("aria-hidden","true"),b.autocomplete="off",b.style.position="absolute",b.style.margin="0px",b.style.padding="0px",b.style.wordWrap="normal",b.style.left="0px",b.style.top="0px",b.style.width="100%",b.style.height="100%",this._copyContainer.appendChild(b),a.appendChild(this._copyContainer),b},isFocused:function(){return this._focused},setFocus:function(a){_trace("setfocus",a),this._focused=a,this._copyElement.focus()},changeClipboardData:function(a){var b=this._owner.getClipboardValue();this._copyElement.value=b;var c=this._copyElement;c.select()},$_setFocusedCell:function(a,b){var c=this._owner,d=c.tmpSummaryOptions(),e=d.isTotalFixed(),f=c.bodyView(),g=c.leftPos(),h=c.topPos(),i=c.bodyWidth(),j=c.bodyHeight(),k=g,l=h,m=e&&d.isColumnVisible()?c.columnView().rootElement().summaryCell().width():0,n=e&&d.isRowVisible()?c.rowView().rootElement().summaryCell().height():0;e&&(d.columnPosition()==SummaryPosition.FIRST&&(k+=m),i-=m,d.rowPosition()==SummaryPosition.FIRST&&(l+=n),j-=n);var o=!1;if((!e||!b.isTotalSummary()&&d.rowPosition()==SummaryPosition.LAST)&&(b.bottom()-1>l+j?(h=b.bottom()-j,o=!0):b.top()<l&&(h=b.top()-n,o=!0)),(!e||!a.isTotalSummary()&&d.columnPosition()==SummaryPosition.LAST)&&(a.right()-1>k+i?(g=a.right()-i,o=!0):a.left()<k&&(g=a.left()-m,o=!0)),o)c.scrollTo(g,h,function(){setTimeout(function(){c._updateScroll();var d=f.getBodyCell(a,b);f.setFocusCell(d)},20)});else{var p=f.getBodyCell(a,b);f.setFocusCell(p)}},_doKeyDown:function(a,b,c,d){var e=this._owner,f=this._focused&&e.displayOptions().isShowFocus();if(trace("tool: keyDown("+a+")"),27==a){var g=e.tooltipManager();g.isVisible()&&this.$_hideTooltip()}else{if(f&&b&&d&&_included(a,Keys.RIGHT,Keys.LEFT,Keys.DOWN,Keys.UP)){for(var h=e.bodyView(),i=h.focusColumn(),j=h.focusRow(),k=i,l=i.valueField();!(k instanceof GroupCellElement);)k=k.group();var m=j.group(),n=!1;switch(a){case Keys.LEFT:for(;!k.expanded()||1==k._lowers.length;)k=k.group();if(k instanceof GroupCellElement&&!k.isRoot()){k.collapse();var o=k.summaryCell();o.isValueLabel()||(o=o.findValueLower(l)),n=i!=o,i=o}break;case Keys.RIGHT:k instanceof GroupCellElement&&!k.expanded()&&k.expand();break;case Keys.UP:for(;!m.expanded()||1==m._lowers.length;)m=m.group();if(m instanceof GroupCellElement&&!m.isRoot()&&m.expanded()){m.collapse();var p=m.summaryCell();n=j!=p,j=m.summaryCell()}break;case Keys.DOWN:m instanceof GroupCellElement&&!m.expanded()&&m.expand()}return n&&this.$_setFocusedCell(i,j),!1}if(f&&_included(a,Keys.HOME,Keys.END,Keys.RIGHT,Keys.LEFT,Keys.DOWN,Keys.UP,Keys.PAGEDOWN,Keys.PAGEUP)){var h=e.bodyView(),q=e.columnView(),r=e.rowView(),i=(e.focusView(),h.focusColumn()),j=h.focusRow(),s=h.visibleRowCount()-1,t=h.visibleColCount()-1;switch(a){case Keys.LEFT:i=q.prevCell(i);break;case Keys.RIGHT:i=q.nextCell(i);break;case Keys.UP:j=r.prevCell(j);break;case Keys.DOWN:j=r.nextCell(j);break;case Keys.PAGEUP:b?i=q.beforeCell(i,t):j=r.beforeCell(j,s);break;case Keys.PAGEDOWN:b?i=q.afterCell(i,t):j=r.afterCell(j,s);break;case Keys.HOME:b?j=r.firstCell():i=q.firstCell();break;case Keys.END:b?j=r.lastCell():i=q.lastCell()}return i&&j?this.$_setFocusedCell(i,j):_trace("not found focus label"),!1}}return!0},_doKeyUp:function(a,b,c,d){return trace("tool: keyUp("+a+")"),!1},_doKeyPress:function(a){trace("tool: keyPress("+a+")")},_doClick:function(a,b){trace("tool: click("+a+","+b+")");var c=this.findElementAt(a,b,!0);this._owner._fireClick(c)},_doDblClick:function(a,b){trace("tool: dblClick("+a+","+b+")");var c=this.findElementAt(a,b,!0);this._owner._fireDblClick(c)},_doMouseDown:function(a,b,c,d,e,f){if(this.setFocus(!0),this._scrollTool.stop(),this._request){var g=this._getDragTracker(this._request,a,b);this.setDragTracker(g)}else if(!this._owner.contextMenuManager().isVisible()){var h=this.findElementAt(a,b);if(h){if(this._scrollTool.start(h,a,b))return;var i=h.containerToClient(a,b);h instanceof ClickableElement&&h.click(i.x,i.y),h instanceof BodyCellElement&&this.$_setFocusedCell(h.columnLabel(),h.rowLabel())}}f.preventDefault()},_doMouseMove:function(a,b){var c=this._owner;if(this._scrollTool.isScrolling())this._scrollTool.move(a,b);else{c.setCursor(Cursor.DEFAULT);var d=this.findElementAt(a,b,!0);if(d!=this._hoveredCell&&(this.$_hideTooltip(),this._hoveredCell=d),!this.isDragging()&&!c.isPopuped()){this._request&&(this._request.destroy(),this._request=null);var e=this._request=this._getRequest(d,a,b);e&&e.cursor()?c.setCursor(e.cursor()):this._changeTooltip(d)}}},_doMouseUp:function(a,b){this._scrollTool.isScrolling()&&this._scrollTool.stop(a,b)},_doMouseEnter:function(a,b){trace("tool: mouseEnter("+a+","+b+")")},_doMouseLeave:function(a,b){trace("tool: mouseLeave("+a+","+b+")")},_doMouseOver:function(a,b){trace("tool: mouseOver("+a+","+b+")")},_doMouseOutside:function(){},_doMouseWheel:function(a,b,c,d){trace("tool: mouseWheel("+c+","+d+")");var e=this._owner._scrollContainer.wheelScroll(c,d);if(e){this.$_hideTooltip();var f=this.findElementAt(a,b,!0);this._changeTooltip(f)}return e},_doTouchStart:function(a){trace("tool: touchStart")},_doTouchMove:function(a){trace("tool: touchMove")},_doTouchEnd:function(a){trace("tool: touchEnd")},_doTouchCancel:function(a){trace("tool: touchCancel")},_changeTooltip:function(a){var b=this._owner,c=b.tooltipManager(),d=b.displayOptions().tooltipDelay();a instanceof BodyCellElement&&b.displayOptions().isShowTooltip()?d>0?(c._showTimer&&clearTimeout(c._showTimer),c._showTimer=setTimeout(function(){this._showTooltip(a)}.bind(this),d)):this._showTooltip(a):a instanceof LabelCellElement&&b.displayOptions().isShowLabelTooltip()?d>0?(c._showTimer&&clearTimeout(c._showTimer),c._showTimer=setTimeout(function(){this._showLabelTooltip(a)}.bind(this),d)):this._showLabelTooltip(a):c.isVisible()&&c.close()},_getRequest:function(a,b,c,d,e){var f,g;this._owner;return a instanceof ScrollThumb?new ScrollThumbRequest(a):a instanceof PivotCellElement?(f=this.$_getHeaderResizeRequest(b,c))?f:(g=a,(f=this.$_getColumnResizeRequest(b,c))?f:(f=this.$_getRowResizeRequest(b,c),f?f:null)):null},_getDragTracker:function(a,b,c){return a instanceof ScrollThumbRequest?new ScrollThumbTracker(a,b,c):a instanceof ColumnResizeRequest?new ColumnResizeTracker(a,b,c):a instanceof RowResizeRequest?new RowResizeTracker(a,b,c):a instanceof ColumnLevelResizeRequest?new ColumnLevelResizeTracker(a,b,c):a instanceof RowLevelResizeRequest?new RowLevelResizeTracker(a,b,c):a instanceof HeaderResizeRequest?new HeaderResizeTracker(a,b,c):void 0},$_getColumnResizeRequest:function(a,b){var c=this._owner,d=c.columnView(),e=d.boundsByContainer();if(e.inflate(0,0,VisualTool.DRAG_BORDER,VisualTool.DRAG_BORDER),a>=0&&a<=e.left()&&this.inDraggablePt(b,e.bottom()))return new ColumnLevelResizeRequest(c,d.depth()-1);if(!e.contains(a,b))return null;for(var f=a-e.left(),g=b-e.top(),h=d.getChildren(),i=0,j=h.length;j>i;i++){var k=h[i];if(k.isVisible()&&k.right()+d.left()>0){if(g>=k.top()&&g<=k.bottom()&&this.inDraggablePt(f,k.right()))return new ColumnResizeRequest(k);if(f>=k.left()&&f<=k.right()&&this.inDraggablePt(g,k.bottom()))return new ColumnLevelResizeRequest(c,k.level()+k.mergeCount())}}return null},$_getRowResizeRequest:function(a,b){var c=this._owner,d=c.headerView(),e=c.tmpHeaderOptions().formType()==HeaderFormType.GRID,f=c.rowView();if(b>=0&&b<=d.height()){if(this.inDraggablePt(a,c._centralPt.x-1))return new RowLevelResizeRequest(c,f.depth()-1);if(e)for(var g=c.headerView(),h=g.getGridRowHeaderCells(),i=h.length;i--;){var j=h[i];if(this.inDraggablePt(a,j.right()))return new RowLevelResizeRequest(c,i)}}var k=f.boundsByContainer();if(k.inflate(0,0,VisualTool.DRAG_BORDER,VisualTool.DRAG_BORDER),!k.contains(a,b))return null;for(var l=a-k.left(),m=b-k.top(),n=f.getChildren(),i=0,o=n.length;o>i;i++){var p=n[i];if(p.isVisible()&&p.bottom()+f.top()>0){if(l>=p.left()&&l<=p.right()&&this.inDraggablePt(m,p.bottom()))return new RowResizeRequest(p);if(m>=p.top()&&m<=p.bottom()&&this.inDraggablePt(l,p.right()))return new RowLevelResizeRequest(c,p.level()+p.mergeCount())}}return null},$_getHeaderResizeRequest:function(a,b){var c=this._owner,d=c.headerView(),e=d.rowSplitPos();return-1!=e&&this.inDraggablePt(b,d.titleHeight()+e)&&a>=d.left()&&a<=c._centralPt.x?new HeaderResizeRequest(c):void 0},_showTooltip:function(a){if(a){var b=this._owner,c=b.tooltipManager(),d=a.getCellIndex();if(!c.isVisible()||this._tooltipCell!=a||!CellIndex.areEquals(d,this._tooltipIndex)){var e=a.getTooltip();if(e){var f=b._fireShowTooltip(d,e);if(f){var g={};"object"==typeof f?(g.message=f.message,f.styles&&(g.styles=f.styles)):"string"==typeof f&&(g.message=f),this.$_showTooltip(a,g)}}}}},_showLabelTooltip:function(a){if(a){var b=this._owner,c=b.tooltipManager(),d=a.getCellIndex();if(!c.isVisible()||this._tooltipCell!=a||!CellIndex.areEquals(d,this._tooltipIndex)){var e=a.getTooltip();if(e){var f=b._fireShowLabelTooltip(d,e);if(f){var g={};"object"==typeof f?(g.message=f.message,f.styles&&(g.styles=f.styles)):"string"==typeof f&&(g.message=f),this.$_showTooltip(a,g)}}}}},$_showTooltip:function(a,b){var c=this._owner,d=c.tooltipManager(),e=c.contextMenuManager(),f=a.getCellIndex();this.$_hideTooltip();var g=a.boundsBy(),h=g.x,i=g.y+a.height();_trace("showtooltip x="+h+", y="+i),e.isVisible()?d.show(b,h,i,a,e.getView()):d.show(b,h,i,a),this._tooltipCell=a,this._tooltipIndex=f},$_hideTooltip:function(){this._owner.tooltipManager().close(),this._tooltipCell=null,this._tooltipIndex=null},$_copyHandler:function(a){var b=a.target.value;return null!=b&&(_win.clipboardData?_win.clipboardData.setData("Text",b):a.clipboardData.setData("text/plain",b)),a.preventDefault()},$_focusinHandler:function(a){_trace("copyElement focus"),this._focused=!0},$_blurHandler:function(a){_trace("copyElement blur"),this._focused=!1},$_focusoutHandler:function(a){_trace("copyElement focusout"),this._focused=!1}}),SummaryPosition=_enum({FIRST:"first",LAST:"last"}),FieldRole=_enum({NONE:"none",COLUMN:"column",ROW:"row",VALUE:"value",FILTER:"filter"}),SetupDragAction=_enum({NONE:"none",ADD:"add",REMOVE:"remove",MOVE:"move",ORDER:"order",DENIED:"denied"}),SetupDragDenied=_enum({NONE:"none",DISABLED:"disabled",DUPLICATED:"duplicated"}),LayoutMode=_enum({INIT:"init",SCROLL:"scroll",RESIZE:"resize",CELL:"cell",CELL_SIZE:"cellSize"}),HeaderFormType=_enum({NORMAL:"normal",GRID:"grid"}),ValueAlignment=_enum({NEAR:"near",CENTER:"center",FAR:"far"}),DisplayOptions=defineClass("DisplayOptions",PivotOptions,{columnHeight:25,rowHeight:25,columnWidth:70,rowLabelWidth:90,rowGroupWidth:70,cellSpaceWidth:0,cellSpaceHeight:0,showTooltip:!1,showLabelTooltip:!1,tooltipDelay:100,blankFillValue:0,showProgress:!1,virtualRendering:!0,showFocus:!1,showFocusGuide:!1,keepLabelSpace:!1,notReadyMessage:RealPivotMessages.notReadyText,emptyMessage:RealPivotMessages.emptyDataText}),GroupOptions=defineClass("GroupOptions",PivotOptions,{columnExpand:-1,rowExpand:-1}),SummaryOptions=defineClass("SummaryOptions",PivotOptions,{columnVisible:!0,rowVisible:!0,columnGroupVisible:!0,rowGroupVisible:!0,columnPosition:SummaryPosition.FIRST,rowPosition:SummaryPosition.FIRST,columnTotalText:RealPivotMessages.columnTotalText,rowTotalText:RealPivotMessages.rowTotalText,totalFixed:!1}),HeaderOptions=defineClass("HeaderOptions",PivotOptions,{formType:HeaderFormType.NORMAL,titleVisible:!0,titleHeight:20,rowHeadVisible:!0,columnHeadVisible:!0,valueHeadVisible:!0,menuButtonVisible:!0,setupButtonVisible:!0}),CopyOptions=defineClass("CopyOptions",PivotOptions,{copyDisplayText:!1}),EmptyElement=defineClass("PivotEmptyElement",PivotElement,{init:function(a){this._super(a,"realpivot-empty"),this._mouseEnabled=!1,this._messageDiv=null},destroy:function(){this._messageDiv&&this._element.removeChild(this._messageDiv),this._messageDiv=null,this._super()},_layoutCells:function(){var a=this.grid(),b=a.tmpDisplayOptions().emptyMessage();this._messageDiv||(this._messageDiv=_doc.createElement("span"),this._messageDiv.className=this.cssClass(),this._element.appendChild(this._messageDiv)),this._messageDiv.textContent=b},_doRender:function(a){}}),NotReadyElement=defineClass("PivotEmptyElement",PivotElement,{init:function(a){this._super(a,"realpivot-noready"),this._mouseEnabled=!1,this._messageDiv=null,this._productSpan=null},destroy:function(){this._setupImg&&(Dom.removeEventListener(this._setupImg,"click",this._setupButtonClicked.bind(this),!1),this._messageDiv.removeChild(this._setupImg)),this._messageDiv&&this._element.removeChild(this._messageDiv),this._productSpan&&this._element.removeChild(this._productSpan),this._messageDiv=null,this._productSpan=null,this._super()},_layoutCells:function(){var a=this.grid(),b=a.tmpDisplayOptions().notReadyMessage(),c=AppInfo.toString();this._messageDiv||(this._messageDiv=_doc.createElement("span"),this._messageDiv.className=this.cssClass(),this._element.appendChild(this._messageDiv)),this._messageDiv.textContent=b,a.dataSource().fieldManager().fieldCount()>0&&(this._setupImg=_doc.createElement("div"),this._setupImg.className="realpivot-title-setup",Dom.addEventListener(this._setupImg,"click",this._setupButtonClicked.bind(this),!1),this._setupImg.style.position="absolute",this._setupImg.style.left=_int(this._width/2)+"px",this._setupImg.style.top=_int(this._height/2)+20+"px",this._element.appendChild(this._setupImg)),this._productSpan||(this._productSpan=_doc.createElement("span"),this._productSpan.className=this.cssClass()+"-product",this._productSpan.style.position="absolute",this._productSpan.style.right="5px",this._productSpan.style.bottom="5px",this._element.appendChild(this._productSpan)),this._productSpan.textContent=c},_setupButtonClicked:function(a){this._grid.setupView().show()},_doRender:function(a){}}),HeaderElement=defineClass("HeaderElement",PivotElement,{init:function(a){this._super(a,"realpivot-header"),this._isContainer=!0,this._childFixed=!0,this._titleCell=null,this._colHeaderCell=null,this._rowHeaderCell=null,this._valHeaderCell=null,this._gridRowHeaderCells=[],
this._rowSize=0,this._rowSplitPos=-1,this._layouted=!1,this._titleHeight=0,this._rowHeaderHeight=0,this._valHeaderHeight=0},destroy:function(){this._rowFields=null,this._super()},formType:HeaderFormType.normal,columnFields:null,rowFields:null,valueFields:null,setWidth:function(a){var b=!1;if(this._width&&this._width!=a&&(b=!0),this._super(a),b&&this._colHeaderCell&&this._colHeaderCell.isVisible()){var c=this.clientRect();this._colHeaderCell.setWidth(c.width-this._grid._centralPt.x)}},rowSize:function(){return this._rowSize},rowSplitPos:function(){return this._rowSplitPos},setRowSplitPos:function(a){a!=this._rowSplitPos&&(this._layouted&&(this._valHeaderCell.setHeight(a),this._rowHeaderCell.offset(0,a-this._rowSplitPos),this._rowHeaderCell.setHeight(this._rowSize-a)),this._rowSplitPos=a)},titleHeight:function(){return this._titleHeight},getTitleCell:function(){return this._titleCell},getColHeaderCell:function(){return this._colHeaderCell},getRowHeaderCell:function(){return this._rowHeaderCell},getValHeaderCell:function(){return this._valHeaderCell},getGridRowHeaderCell:function(a){return this._gridRowHeaderCells?this._gridRowHeaderCells[a]:null},getGridRowHeaderCells:function(){return this._gridRowHeaderCells},changeWidth:function(a,b){var c=this._formType;if(c==HeaderFormType.GRID)for(var d=this._gridRowHeaderCells.length;d--;)d==a?this._gridRowHeaderCells[d].inflate(b,0):d>a&&this._gridRowHeaderCells[d].offset(b,0);else{var e=this._grid.tmpHeaderOptions(),f=e.isValueHeadVisible(),g=e.isRowHeadVisible(),h=e.isTitleVisible(),i=e.isColumnHeadVisible();(h||i)&&(this._titleCell.inflate(b,0),this._colHeaderCell.offset(b),this._colHeaderCell.inflate(-b,0)),f&&this._valHeaderCell.inflate(b,0),g&&this._rowHeaderCell.inflate(b,0)}this.inflate(b,0)},changeHeight:function(a){var b=this._formType;if(b==HeaderFormType.GRID)for(var c=this._gridRowHeaderCells.length;c--;)this._gridRowHeaderCells[c].inflate(0,a);else{var d=this._grid.tmpHeaderOptions(),e=d.isValueHeadVisible(),f=d.isRowHeadVisible(),g=this._rowSplitPos,h=g/this._rowSize;this._rowSize+=a,this._height+=a;var i=this._rowSize;e&&f&&(g+=_round(a*h)),this._rowSplitPos=g,e&&(this._valHeaderHeight=f?g:this._rowSize,this._valHeaderCell.setHeight(this._valHeaderHeight),i-=this._valHeaderHeight),f&&(this._rowHeaderHeight=i,e&&this._rowHeaderCell.setTop(this._valHeaderCell.bottom()),this._rowHeaderCell.setHeight(this._rowHeaderHeight))}this.inflate(0,a)},$_clearHeaders:function(){this._titleCell&&(this.removeChild(this._titleCell),this._titleCell.destroy(),this._titleCell=null),this._colHeaderCell&&(this.removeChild(this._colHeaderCell),this._colHeaderCell.destroy(),this._colHeaderCell=null),this._rowHeaderCell&&(this.removeChild(this._rowHeaderCell),this._rowHeaderCell.destroy(),this._rowHeaderCell=null),this._valHeaderCell&&(this.removeChild(this._valHeaderCell),this._valHeaderCell.destroy(),this._valHeaderCell=null);for(var a=this._gridRowHeaderCells.length;a--;)this.removeChild(this._gridRowHeaderCells[a]),this._gridRowHeaderCells[a].destroy(),this._gridRowHeaderCells[a]=null;this._gridRowHeaderCells=[]},_layoutCells:function(){var a=this.clientRect(),b=this._grid,c=b.tmpHeaderOptions(),d=c.titleHeight(),e=c.isTitleVisible(),f=c.isColumnHeadVisible(),g=c.isValueHeadVisible(),h=c.isRowHeadVisible(),i=b._centralPt,j=this._formType=c.formType();if(j==HeaderFormType.GRID){var k=b.rowLevelWidths();this.$_clearHeaders();for(var l=0,m=0,n=this._rowFields.length;n>m;m++){var o=this._rowFields[m],p=new SingleFieldHeaderCellElement(this._grid);this._gridRowHeaderCells.push(p),p.setField(o),this.addChild(p);var q=k[m];p.setBoundsI(l,a.top,q,a.height),p.setText(o.getFieldHeader()),p.draw(),l+=q}}else{this.$_clearHeaders(),this._titleCell||(this._titleCell=new TitleCellElement(this._grid),this.addChild(this._titleCell)),this._colHeaderCell||(this._colHeaderCell=new FieldHeaderCellElement(this._grid,FieldType.COLUMN),this.addChild(this._colHeaderCell)),this._rowHeaderCell||(this._rowHeaderCell=new FieldHeaderCellElement(this._grid,FieldType.ROW),this.addChild(this._rowHeaderCell)),this._valHeaderCell||(this._valHeaderCell=new FieldHeaderCellElement(this._grid,FieldType.VALUE),this.addChild(this._valHeaderCell));var r=a.clone(),s=0;if(e||f?(r.width=i.x,r.height=d,this._titleHeight=d,this._titleCell.setVisible(!0),this._titleCell.setSpace(this._cellSpaceWidth,this._cellSpaceHeight),this._titleCell.setRectI(r),this._titleCell.setContentsVisible(e),this._titleCell.setMenuVisible(c.isMenuButtonVisible()),this._titleCell.setSetupVisible(c.isSetupButtonVisible()),this._titleCell.layoutContent(),r.leftBy(i.x),r.width=a.width-i.x,this._colHeaderCell.setFields(this._columnFields),this._colHeaderCell.setVisible(!0),this._colHeaderCell.setSpace(this._cellSpaceWidth,this._cellSpaceHeight),this._colHeaderCell.setRectI(r),this._colHeaderCell.setContentsVisible(f),this._colHeaderCell.layoutContent(),s+=d):(this._titleHeight=0,this._titleCell.setVisible(!1),this._colHeaderCell.setVisible(!1)),a.setTop(s),a.width=i.x,h&&g?this._rowSplitPos=this._rowSplitPos>0?_round(this._rowSplitPos/this._rowSize*a.height):_floor(a.height/2):this._rowSplitPos=-1,this._rowSize=a.height,this._valHeaderCell.setVisible(g),g){this._valHeaderCell.setFields(this._valueFields);var t=this._rowSplitPos;r=a.clone(),r.height=t,this._valHeaderCell.setSpace(this._cellSpaceWidth,this._cellSpaceHeight),this._valHeaderCell.setRectI(r),this._valHeaderCell.layoutContent(),a.setTop(a.y+t)}else this._valHeaderCell.setVisible(!1);h||!g?(this._rowHeaderCell.setFields(this._rowFields),this._rowHeaderCell.setVisible(!0),this._rowHeaderCell.setSpace(this._cellSpaceWidth,this._cellSpaceHeight),this._rowHeaderCell.setRectI(a),this._rowHeaderHeight=a.height,this._rowHeaderCell.setContentsVisible(h),this._rowHeaderCell.layoutContent()):this._rowHeaderCell.setVisible(!1)}this._layouted=!0},_doRender:function(a){}}),LabelElement=defineClass("LabelElement",PivotElement,{init:function(a,b){this._super(a,b),this._isContainer=!0,this._sumOptions=a.tmpSummaryOptions(),this._rootElement=this._createRootCell()},destroy:function(){this._labels=null,this._rootElement.destroy(),this._rootElement=null,this._super()},labels:null,depth:0,cellIndexes:null,sumIndexes:null,rootElement:function(){return this._rootElement},getLeafCells:function(){var a=this._rootElement.getLeafDescendants();return a.filter(function(a){return a.isVisible()})},getBoundLeafCells:function(){return null},$_addIndexCell:function(a,b,c){this._cellIndexes[b]=a,this._totCellIndexes[c]=a,a.setIndex(c)},$_addSumCell:function(a,b,c){var d=this._sumIndexes.length,e=0==d?b:d;this._sumIndexes[e]=a,this._totCellIndexes[c]=a,a.setIndex(c)},_layoutCells:function(){this._super(),this._cellIndexes=[],this._sumIndexes=[],this._totCellIndexes=[],this._layoutChildren({expand:!0,childs:this._labels},0,0,0,0,this._rootElement)},_layoutChildren:function(a,b,c,d,e){},_doRender:function(a){},_createRootCell:function(){},findCellWithTree:function(a){return this._rootElement.findLowerWithTree(a,0)},prevCell:function(a){for(var b=a.index();b--;)if(a=this._totCellIndexes[b],a&&a.isVisible())return a;return null},nextCell:function(a){for(var b=a.index()+1,c=this._totCellIndexes.length;c>b;b++)if(a=this._totCellIndexes[b],a&&a.isVisible())return a;return null},firstCell:function(){for(var a=0,b=this._totCellIndexes.length;b>a;a++)if(cell=this._totCellIndexes[a],cell&&cell.isVisible())return cell},lastCell:function(){for(var a=this._totCellIndexes.length,b=a;b--;)if(cell=this._totCellIndexes[b],cell&&cell.isVisible())return cell},beforeCell:function(a,b){for(var c,d=b,e=a.index()-1;e>=0;e--)if(a=this._totCellIndexes[e],a&&a.isVisible()){if(c=a,1==d)return a;d--}return c},afterCell:function(a,b){for(var c,d=b,e=a.index()+1,f=this._totCellIndexes.length;f>e;e++)if(a=this._totCellIndexes[e],a&&a.isVisible()){var c=a;if(0==d)return a;d--}return c},scroll:function(a,b){if(this._totalFixed){var c=this._rootElement.summaryCell();c&&c.isVisible()&&c.offsetMembers(a,b)}this.offset(-a,-b)}}),ColumnLabelElement=defineClass("ColumnLabelElement",LabelElement,{init:function(a){this._super(a,"realpivot-col")},destroy:function(){this._values=null,this._super()},values:[],getCellAt:function(a){for(var b=this._rootElement.getLeafDescendants(),c=b.length;c--;){var d=b[c];if(d.isVisible()&&d.left()<=a&&d.right()>a)return d}return null},getBoundLeafCells:function(a,b,c){var d=this._rootElement.getLeafDescendants(),e=d.filter(function(d){return d instanceof PivotCellElement&&d.isVisible()&&(c&&d instanceof LabelSummaryCellElement&&0==d.level()||d.right()>=a&&d.left()<=b)});return c&&e.sort(function(a,b){var c=a.isTotalSummary(),d=b.isTotalSummary();return c&&!d?1:!c&&d?-1:0}),e},changeHeight:function(a,b){this.setHeight(this._height+b);for(var c=this._childs.length;c--;){var d=this._childs[c];d._level==a?d.inflate(0,b):d._level<a&&d instanceof LabelSummaryCellElement&&d._level+d._mergeCount>=a?d.inflate(0,b):d._level>a&&d.offset(0,b)}},findCellWithTree:function(a,b){var c=this._super(a);return c&&!c.isValueLabel()&&(c=c.findValueLower(b)),c},_createRootCell:function(){var a=new ColumnRootCellElement(this._grid);return a.setVisible(!1),a},_layoutChildren:function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q=cnt=0,r=this._grid,s=r._dataSource.fieldManager(),t=s.getColumn(b),u=this._values.length,v=r.columnPoints(),w=this._cellSpaceWidth,x=this._cellSpaceHeight,y=u>1?this._depth-2:this._depth-1,z=0==b?this._sumVisible:this._groupSumVisible,A=z||b>0,B=z||!a.expand,C=r.tmpDisplayOptions().columnWidth(),D=[],E=0,F=this._sumPosition,G=F==SummaryPosition.FIRST,H=this._sumVisible&&this._totalFixed&&this._sumPosition==SummaryPosition.LAST,I=1==u?this._values[0]:null,J=e;for(g=0;u>g;g++)k=this._values[g].width()||C,D.push(k),E+=k;if(z&&G&&(m=e,n=d,J+=v[n+u]-v[n],d+=u,c+=u),a.expand)for(g=0,i=a.childs.length;i>g;g++){var K=a.childs[g];if(K.hasOwnProperty("childs")?o=new ColumnGroupCellElement(r,b,t,f,-1,K):(cnt=u,k=v[d+u]-v[d],o=new LabelCellElement(r,FieldType.COLUMN,b,t,I,f,-1,K.value,K.label),2>u&&this.$_addIndexCell(o,d++,c++)),this.addChild(o),l=r.getColumnLevelSumHeight(0,b-1),j=r.columnLevelHeight(b),o instanceof ColumnGroupCellElement&&(cnt=this._layoutChildren(K,b+1,c,d,J,o),k=v[d+cnt]-v[d],d+=cnt,c=this._totCellIndexes.length),o.setBounds(J,l,k,j,w,x),o.draw(),o.layoutContent(),p=o,q+=cnt,u>1&&!(o instanceof ColumnGroupCellElement))for(h=0;u>h;h++){var L=this._values[h],M=L.getFieldHeader();o=new LabelCellElement(r,FieldType.COLUMN,this._depth-1,null,L,p,-1,null,M),this.addChild(o),k=v[d+1]-v[d],l=r.getColumnLevelSumHeight(0,this._depth-2),j=r.columnLevelHeight(this._depth-1),this.$_addIndexCell(o,d++,c++),o.setBounds(J,l,k,j,w,x),o.draw(),J+=k}else J+=k}else a.hasOwnProperty("childs")&&a.childs.length>0&&f.setPartial();if(A){void 0===m&&(m=J,n=d,c+=u),t=s.getColumn(b-1);var N=b>0?a.value:null,O=0==b?this._totalText:t.getSummaryLabel(a.value,a.label);if(o=new LabelSummaryCellElement(r,FieldType.COLUMN,b,y-b,F,t,I,f,N,O),this.addChild(o),l=r.getColumnLevelSumHeight(0,b-1),j=r.getColumnLevelSumHeight(b,y),B?(k=v[n+u]-v[n],o.setBounds(m,l,k,j,w,x)):(m=e,o.setBounds(m,l,E,j,w,x)),1==u&&(z?this.$_addIndexCell(o,n,n++):b>0&&this.$_addSumCell(o,v.length,c++),o.setValueField(this._values[0])),f.setSummaryVisible(z),o.setGroup(f,this._sumPosition==SummaryPosition.FIRST?0:void 0),H&&0==b&&o.setFixedSplit(!0),o.draw(),p=o,B?q+=u:o.setVisible(!1),u>1)for(h=0;u>h;h++){var L=this._values[h],M=this._values[h].getFieldHeader();o=new LabelSummaryCellElement(r,FieldType.COLUMN,this._depth-1,0,F,null,L,p,-1,M,!0),this.addChild(o),l=r.getColumnLevelSumHeight(0,y),j=r.columnLevelHeight(this._depth-1),k=B?v[n+1]-v[n]:D[h],o.setBounds(m,l,k,j,w,x),z?this.$_addIndexCell(o,n,n++):b>0&&(this.$_addSumCell(o,v.length,c++),n++),H&&0==b&&0==h&&o.setFixedSplit(!0),o.draw(),!B&&o.setVisible(!1),m+=k}}return q},_layoutCells:function(){if(this._cellWidth=this._options.columnWidth(),this._sumVisible=this._sumOptions.isColumnVisible(),this._groupSumVisible=this._sumOptions.isColumnGroupVisible(),this._sumPosition=this._sumOptions.columnPosition(),this._totalText=this._sumOptions.columnTotalText(),this._cellHeight=this._options.columnHeight(),this._totalFixed=this._sumOptions.isTotalFixed(),this._super(),this._sumVisible&&this._totalFixed&&this._sumPosition==SummaryPosition.LAST){var a=this._parent.width();if(this._grid.columnWidth()>a){var b=this._rootElement.summaryCell();b.offsetMembers(a-b.width()-b.left(),0)}}},_doRender:function(a){}}),RowLabelElement=defineClass("RowLabelElement",LabelElement,{init:function(a){this._super(a,"realpivot-row")},getCellAt:function(a){for(var b=this._rootElement.getLeafDescendants(),c=b.length;c--;){var d=b[c];if(d.isVisible()&&d.top()<=a&&d.bottom()>a)return d}return null},getBoundLeafCells:function(a,b,c){var d=this._rootElement.getLeafDescendants(),e=d.filter(function(d){return d instanceof PivotCellElement&&d.isVisible()&&(c&&d instanceof LabelSummaryCellElement&&d.isTotalSummary()||d.bottom()>=a&&d.top()<=b)});return c&&e.sort(function(a,b){var c=a instanceof LabelSummaryCellElement&&a.isTotalSummary(),d=b instanceof LabelSummaryCellElement&&b.isTotalSummary();return c&&!d?1:!c&&d?-1:0}),e},changeWidth:function(a,b){this.setWidth(this._width+b);for(var c=this._childs.length;c--;){var d=this._childs[c];d._level==a?d.inflate(b,0):d._level<a&&d instanceof LabelSummaryCellElement&&d._level+d._mergeCount>=a?d.inflate(b,0):d._level>a&&d.offset(b,0)}},_createRootCell:function(){var a=new RowRootCellElement(this._grid);return a.setVisible(!1),a},_layoutChildren:function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o=cnt=0,p=this._grid,q=p._dataSource.fieldManager(),r=q.getRow(b),s=p.rowPoints(),t=p.rowLevelWidths(),u=this._cellSpaceWidth,v=this._cellSpaceHeight,w=0==b?this._sumVisible:this._groupSumVisible,x=w||b>0,y=w||!a.expand,z=p.tmpDisplayOptions().rowHeight(),A=this._sumPosition,B=A==SummaryPosition.FIRST,C=this._sumVisible&&this._totalFixed&&this._sumPosition==SummaryPosition.LAST,D=e;if(w&&B&&(l=e,m=d,D+=s[m+1]-s[m],d++,c++),a.expand)for(g=0,h=a.childs.length;h>g;g++){var E=a.childs[g];E.hasOwnProperty("childs")?n=new RowGroupCellElement(p,b,r,f,-1,E):(cnt=1,j=s[d+1]-s[d],i=this._cellWidth,n=new LabelCellElement(p,FieldType.ROW,b,r,null,f,-1,E.value,E.label),this.$_addIndexCell(n,d++,c++)),this.addChild(n),k=p.getRowLevelSumWidth(0,b-1),i=p.rowLevelWidth(b),n instanceof RowGroupCellElement&&(cnt=this._layoutChildren(E,b+1,c,d,D,n),j=s[d+cnt]-s[d],i=t[b],d+=cnt,c=this._totCellIndexes.length),n.setBounds(k,D,i,j,u,v),n.draw(),n.layoutContent(),o+=cnt,D+=j}else a.hasOwnProperty("childs")&&a.childs.length>0&&f.setPartial();if(x){void 0===l&&(l=D,m=d,c++),r=q.getRow(b-1);var F=b>0?a.value:null,G=0==b?this._totalText:r.getSummaryLabel(a.value,a.label);n=new LabelSummaryCellElement(p,FieldType.ROW,b,this._depth-b-1,A,r,null,f,F,G),this.addChild(n),k=p.getRowLevelSumWidth(0,b-1),i=p.getRowLevelSumWidth(b,this._depth-1),w?(j=s[m+1]-s[m],n.setBounds(k,l,i,j,u,v)):n.setBounds(k,e,i,z,u,v),w?this.$_addIndexCell(n,m,m):b>0&&this.$_addSumCell(n,s.length,c++),f.setSummaryVisible(w),C&&0==b&&n.setFixedSplit(!0),n.draw(),y?o++:n.setVisible(!1)}return o},_layoutCells:function(){if(this._groupWidth=this._options.rowGroupWidth(),this._cellWidth=this._options.rowLabelWidth(),this._sumVisible=this._sumOptions.isRowVisible(),this._groupSumVisible=this._sumOptions.isRowGroupVisible(),this._sumPosition=this._sumOptions.rowPosition(),this._totalText=this._sumOptions.rowTotalText(),this._cellHeight=this._options.rowHeight(),this._totalFixed=this._sumOptions.isTotalFixed(),this._super(),this._sumVisible&&this._totalFixed&&this._sumPosition==SummaryPosition.LAST){var a=this._parent.height();if(this._grid.columnHeight()>a){var b=this._rootElement.summaryCell();b.offsetMembers(0,a-b.height()-b.top(),0)}}},_doRender:function(a){}}),BodyElement=defineClass("BodyElement",PivotElement,{init:function(a){this._super(a,"realpivot-body"),this._isContainer=!0,this._cells=[],this._queCells=[],this._queSumCells=[],this._cellCount=0,this._visibleHorzStart=0,this._visibleHorzEnd=-1,this._visibleVertStart=0,this._visibleVertEnd=-1,this._sumOptions=a.tmpSummaryOptions()},destroy:function(){this._columnView=null,this._rowView=null,this._valueFields=null,this._values=null,this._super()},columnView:null,rowView:null,valueFields:null,values:null,summaries:null,focusColumn:function(){return this._focusColLabel},focusRow:function(){return this._focusRowLabel},backupFocusLabel:function(){this._backupColpath=this._focusColLabel?this._focusColLabel.treePath():null,this._backupRowpath=this._focusRowLabel?this._focusRowLabel.treePath():null},restoreFocusLabel:function(){this._backupColpath&&(this._focusColLabel=this._columnView.findCellWithTree(this._backupColpath)),this._backupRowpath&&(this._focusRowLabel=this._rowView.findCellWithTree(this._backupRowpath))},setFocusWithLabel:function(a,b){var c=this.getBodyCell(a,b);this.setFocusCell(c)},setFocusCell:function(a){if(a){this._focusCell=a;var b=a.columnLabel(),c=a.rowLabel();b!=this._focusColLabel||c!=this._focusRowLabel?(this._grid.focusView().moveToCell(a,this._grid.leftPos(),this._grid.topPos()),this._focusColLabel=b,this._focusRowLabel=c):a.isVisible()&&this._grid.focusView().redraw(a),this._grid.activeTool().changeClipboardData()}},redrawFocus:function(){var a=this._grid.focusView();this._parent.containsChildInBound(a.bounds())&&(this._focusCell.columnLabel()==this._focusColLabel&&this._focusCell.rowLabel()==this._focusRowLabel?this._grid.focusView().redraw(this._focusCell):this.setFocusWithLabel(this._focusColLabel,this._focusRowLabel))},getFocusCell:function(){return this.getBodyCell(this._focusColLabel,this._focusRowLabel)},visibleColCount:function(){return this._visibleColCount},visibleRowCount:function(){return this._visibleRowCount},borrowCellView:function(){return this._queCells.pop()},borrowSumCellView:function(a,b){var c=this._queSumCells.pop();return c&&c.setLevel(a,b),c},returnAllCellView:function(){for(var a=this._childs.length;a--;){var b=this._childs[a];b instanceof SummaryCellElement?-1==this._queSumCells.indexOf(b)&&this._queSumCells.push(b):-1==this._queCells.indexOf(b)&&this._queCells.push(b),b.setVisible(!1)}},returnCellViews:function(a){for(var b=a.length;b--;){var c=a[b];c instanceof SummaryCellElement?this._queSumCells.push(c):this._queCells.push(c),c.setVisible(!1)}},updateCells:function(a,b,c,d){this._options.isVirtualRendering()?this._layoutCells(d,a,b,c):d()},getBodyCell:function(a,b){var c=b.treePath(),d=a.treePath(),e=a.valueField(),f=this._grid.modelManager().getRow(c),g=f.getCell(d,e.name());return this._findCellWithModel(g)},_clearCells:function(){this._queCells=[],this._queSumCells=[],this._super()},_getBoundCells:function(a,b,c,d){return this._childs.filter(function(e){return e._visible&&e.right()>=a&&e._left<=c&&e.bottom()>=b&&e._top<=d})},_findCellWithModel:function(a){var b=this._childs.filter(function(b){return b._model==a});return b.length>0?b[0]:null},_layoutCells:function(a,b,c,d){var e=this._grid,f=e.modelManager(),g=e.dataSource().fieldManager(),h=g.getValues(),i=(e.columnPoints(),e.rowPoints(),e.leftPos()),j=e.topPos(),k=this._parent.innerWidth(),l=this._parent.innerHeight(),m=this._cellSpaceWidth,n=this._cellSpaceHeight,o=e.tmpSummaryOptions(),p=o.isTotalFixed(),q=p&&o.isColumnVisible()&&o.columnPosition()==SummaryPosition.LAST,r=p&&o.isRowVisible()&&o.rowPosition()==SummaryPosition.LAST;b=b?b:LayoutMode.INIT;var s,t;if(b==LayoutMode.SCROLL){var u=c,v=d;i+=u,j+=v}var w=i+k,x=j+l;this.returnAllCellView();var p=this._sumOptions.isTotalFixed();s=this._columnView.getBoundLeafCells(i,w,p),t=this._rowView.getBoundLeafCells(j,x,p),this._visibleColCount=s.length,this._visibleRowCount=t.length,this._options.isVirtualRendering()||(s=this._columnView.getLeafCells(),t=this._rowView.getLeafCells());var y=this._options.blankFillValue(),z=this._options.isShowProgress()&&b==LayoutMode.INIT,A=s.length,B=t.length,C=A*B,D=z?_max(1e3,_int(C/3)):C;z&&this._grid.showProgress(C,RealPivotMessages.progressMessage);var E=_performenceCountStart();PivotHelper.asyncLoop(0,C-1,D,this,function(a){var c,d=_int(a/A),e=a%A,g=t[d],k=s[e],l=(g.index(),k.index(),g.treePath()),o=k.treePath(),u=k.valueField(),v=f.getRow(l),w=v.getCell(o,u.name()),x=!1,z=v.level(),B=w.level();c=w.isSummaryItem()?this.borrowSumCellView(z,B):this.borrowCellView(),c||(x=!0,c=w.isSummaryItem()?new SummaryCellElement(this._grid,z,B):new ValueCellElement(this._grid),c.setEmptyValue(y)),c.setRowLabel(g),c.setColumnLabel(k),c.setModel(w);var C=c instanceof SummaryCellElement&&(0==B||0==z);x?p&&!C?this.insertChildAt(c,0):this.addChild(c):p&&(C?this.moveChildTo(c,-1):this.moveChildTo(c,0));var D=k.left()-i,E=g.top()-j,F=k.width(),G=g.height();if(c instanceof SummaryCellElement){var H=h.indexOf(u);c.setFixedSplit(0==B&&q&&0==H,0==z&&r)}c.setBounds(D,E,F,G,m,n),c.setVisible(!0),c.draw(),b==LayoutMode.INIT&&0==d&0==e&&this.setFocusCell(c)}.bind(this),function(a){z&&this._grid.setCurrentProgress(a)}.bind(this),function(){_trace("rendering time = "+_performenceCountEnd(E)),_trace("body children cell = "+this._childs.length),setTimeout(function(){if(z&&this._grid.closeProgress(),b!=LayoutMode.INIT&&this._focusCell){var a=this._focusColLabel,c=this._focusRowLabel,d=this._grid.focusView();a&&a.isVisible()||(a=this._columnView.getCellAt(d.centerX()+i),a||(a=s[s.length-1])),c&&c.isVisible()||(c=this._rowView.getCellAt(d.centerY()+j),c||(c=t[t.length-1])),this.setFocusWithLabel(a,c)}}.bind(this)),a&&a()}.bind(this))},_doRender:function(a){}}),PivotCellElement=defineClass("PivotCellElement",PivotElement,{init:function(a,b){this._super(a,"realpivot-cell "+b),this._cellIndex=new CellIndex(a)},destroy:function(){this._cellIndex.destroy(),this._cellIndex=null,this._visible=!1,this._super()},value:null,text:null,span:null,setText:function(a){this._text!=a&&(_defined(a)?this._text=a+"":this._text="")},_doRender:function(a){this.$_prepareSpan(this._text)},getCellIndex:function(){return this._cellIndex},getTooltip:function(){return null},$_prepareSpan:function(a){this._span||(this._span=document.createElement("span"),this._element.appendChild(this._span)),this._span.className=this.cssClass(),this._span.innerHTML=this.$_getCellText()},$_getCellText:function(){return this._text||""}}),HeaderCellElement=defineClass("HeaderCellElement",PivotCellElement,{init:function(a,b){this._super(a,b)},destroy:function(){this._super()},contentsVisible:!0}),TitleCellElement=defineClass("TitleCellElement",HeaderCellElement,{init:function(a){this._super(a,"realpivot-title"),this._menuImg=_doc.createElement("div"),this._menuImg.className="realpivot-title-menu",this._menuImg.style.display="none",Dom.addEventListener(this._menuImg,"click",this._menuButtonClicked.bind(this),!1),this._element.appendChild(this._menuImg),this._setupImg=_doc.createElement("div"),this._setupImg.className="realpivot-title-setup",this._setupImg.style.display="none",Dom.addEventListener(this._setupImg,"click",this._setupButtonClicked.bind(this),!1),this._element.appendChild(this._setupImg)},destroy:function(){Dom.removeEventListener(this._menuImg,"click",this._menuButtonClicked.bind(this),!1),Dom.removeEventListener(this._setupImg,"click",this._setupButtonClicked.bind(this),!1),this._element.removeChild(this._menuImg),this._element.removeChild(this._setupImg),this._super()},menuVisible:!0,setupVisible:!0,_menuButtonClicked:function(a){this._grid.showGlobalContextMenu(this.left()+5,this.bottom()+1)},_setupButtonClicked:function(a){this._grid.setupView().show()},_doLayoutContent:function(){this._contentsVisible&&this._menuVisible?this._menuImg.style.display="inline-block":this._menuImg.style.display="none",this._contentsVisible&&this._setupVisible?this._setupImg.style.display="inline-block":this._setupImg.style.display="none"},_doRender:function(a){}}),SingleFieldHeaderCellElement=defineClass("SingleFieldHeaderCellElement",HeaderCellElement,{init:function(a){this._super(a,"realpivot-header-label")},destroy:function(){this._field=null,this._super()},field:null,_clearElements:function(){this._field=null}}),FieldHeaderCellElement=defineClass("FieldHeaderCellElement",HeaderCellElement,{init:function(a,b){var c=b==FieldType.VALUE?"realpivot-value-header":b==FieldType.ROW?"realpivot-row-header":"realpivot-col-header";this._super(a,c),this._type=b,this._headers=[]},destroy:function(){this._fields=null,this._clearElements(),this._super()},type:null,fields:null,_clearElements:function(){var a,b;for(a=this._headers.length;a--;){var c=this._headers[a];for(b=c.childElementCount;b--;)c.removeChild(c.children[b]);this._element.removeChild(this._headers[a]),delete this._headers[a]}this._headers=[]},_doLayoutContent:function(){this._clearElements();for(var a,b,c,d=this._grid.dataSource().fieldManager(),e=this.cssClass()+"-text",f="realpivot-header-sort",g=0,h=this._fields.length;h>g;g++){a=_doc.createElement("div"),a.className=e,this._element.appendChild(a),this._headers.push(a),b=_doc.createElement("span"),b.className=e,a.appendChild(b);var i=this._fields[g].getFieldHeader();this._type==FieldType.VALUE&&(i=RealPivotMessages.valueTypeTexts[this._fields[g].expression()]+": "+i),b.textContent=i;var j=this._fields[g],k=d.getFieldSortDir(j.fieldType(),j.name());k!=SortDirection.NONE&&(c=_doc.createElement("div"),c.className=f+" "+f+(k==SortDirection.ASCENDING?"-asc":"-desc"),a.appendChild(c))}}}),LabelCellElement=defineClass("LabelCellElement",PivotCellElement,{init:function(a,b,c,d,e,f,g,h,i){var j,k=_defined(e)&&!_defined(d);if(this instanceof LabelSummaryCellElement){j=b==FieldType.ROW?"realpivot-row-sum":"realpivot-col-sum";var l=k?f.level():c;j+=(b==FieldType.ROW?" realpivot-row-sum-":" realpivot-col-sum-")+(0==l?"tot":c+1)}else{var j=b==FieldType.ROW?"realpivot-row-label":"realpivot-col-label";j+=(b==FieldType.ROW?" realpivot-row-d":" realpivot-col-d")+(c+1),this instanceof ColumnGroupCellElement?j+=" realpivot-col-group":this instanceof RowGroupCellElement&&(j+=" realpivot-row-group")}b==FieldType.VALUE&&(j+=" realpivot-value-label"),this._super(a,j),this._baseCssClass=this.cssClass(),this._type=b,this._level=c,this._lowers=[],this._bodies=[],this._widthOffset=0,this._heightOffset=0,this._treePath=[],this._keepSpace=a.tmpDisplayOptions().isKeepLabelSpace(),this.setLabelField(d),this.setValueField(e),this.setValueLabel(k),this.setValue(h),this.setText(i||h),this.setGroup(f,g)},destroy:function(){this.releaseGroup();var a;for(a=this._lowers.length;a--;)delete this._lowers[a];for(this._lowers=[],a=this._bodies.length;a--;)delete this._bodies[a];this._bodies=[],this._labelField=null,this._valueField=null,this._super()},type:null,level:INIT_INDEX,mergeCount:0,index:INIT_INDEX,valueLabel:!1,labelField:null,valueField:null,group:null,setValue:function(a){this._value=a},treePath:function(){return this._treePath},findLowerWithTree:function(a,b){if(b>a.length-1)return this._summaryCell;for(var c=this._lowers.length;c--;)if(a[b]==this._lowers[c]._value)return this._lowers[c].findLowerWithTree(a,b+1)},findValueLower:function(a){for(var b=this._lowers.length;b--;)if(this._lowers[b]._valueField==a)return this._lowers[b]},isRoot:function(){return!1},isTotalSummary:function(){return!1},setGroup:function(a,b){a!=this._group&&(this.releaseGroup(),b>-1?a.$_insertLower(this,b):a.$_addLower(this),this._group=a,this.$_resetIndex(),this.$_resetTree())},releaseGroup:function(){this._group&&this._group.$_removeLower(this),this._group=null},addBody:function(a){this._bodies.push(a)},removeBody:function(a){var b=this._bodies.indexOf(a);b>-1&&this._bodies.splice(b,1)},hasLower:function(){return this._lowers.length>0},getLower:function(a){return this._lowers.filter(function(b){return b._index==a})},getLowers:function(){return this._lowers},getDescendantCount:function(a){for(var b=0,c=this._lowers.length;c--;){var d=this._lowers[c];!(d._lowers.length>0)||a&&d instanceof GroupCellElement&&!d._expanded?b++:b+=d.getDescendantCount(a)}return b},getDescendants:function(a){for(var b=this._lowers.slice(),c=0,d=b.length;d>c;c++){var e=b[c];!(e._lowers.length>0)||a&&e instanceof GroupCellElement&&!e._expanded||b.push.apply(b,e.getDescendants(a))}return b},getLeafDescendants:function(){var a=[];if(this._lowers.length>0)for(var b=0,c=this._lowers.length;c>b;b++)a.push.apply(a,this._lowers[b].getLeafDescendants());else a.push(this);return a},getAncestors:function(){for(var a=this.group(),b=[];a&&!a.isRoot();)b.push(a),a=a.group();return b},getFamilyTree:function(){var a=[];return a.push.apply(a,this.getAncestors()),a.push(this),a.push.apply(a,this.getDescendants()),a},setFixedSplit:function(a){var b=this._baseCssClass;a&&(b+=this._type==FieldType.ROW?" realpivot-row-split":" realpivot-col-split"),this.setCssClass(b)},$_toggleMembers:function(a){this.setVisible(a);for(var b=this._bodies.length;b--;){var c=this._bodies[b];(!a||c.columnLabel().isVisible()&&c.rowLabel().isVisible())&&c.setVisible(a)}if(this instanceof GroupCellElement&&a&&!this._expanded)this._summaryCell.$_toggleMembers(a);else for(b=this._lowers.length;b--;){var d=this._lowers[b];a&&d instanceof LabelSummaryCellElement&&0==this._summaryVisible||d.$_toggleMembers(a)}},offsetMembers:function(a,b){if(this.isVisible()){var c;if(this.offset(a,b),this._type==FieldType.ROW){if(0!=b)for(c=this._bodies.length;c--;)this._bodies[c].offset(0,b)}else if(0!=a)for(c=this._bodies.length;c--;)this._bodies[c].offset(a,0);for(c=this._lowers.length;c--;)this._lowers[c].isVisible()&&this._lowers[c].offsetMembers(a,b)}},$_inflateGroup:function(a,b,c){for(var d=this._lowers.length;d--;){var e=this._lowers[d];e.isVisible()&&(0!=b&&e._left>a._left||0!=c&&e._top>a._top)&&e.offsetMembers(b,c)}this.inflate(b,c),this._group&&this._group.$_inflateGroup(this,b,c)},$_inflateWithLowers:function(a,b){var c;for(this.inflate(a,b),c=this._bodies.length;c--;)this._bodies[c].inflate(a,b);var d=this.getVisibleLowers(!0,!0);if(d.length>0){var e=d.length,f=a/e,g=b/e,h=0,i=0;for(c=0;e>c;c++){var j=d[c],k=c==e-1?a-h:f,l=c==e-1?b-i:g;c>0&&j.offsetMembers(h,i),j.$_inflateWithLowers(k,l),h+=f,i+=g}}},$_trimLowerSize:function(){var a=this.getVisibleLowers(!0,!0),b=a.length;if(b>0)for(var c=this._type==FieldType.COLUMN,d=0,e=c?this.left():this.top(),f=c?this.width():this.height(),g=0;b>g;g++){var h=a[g],i=c?h.width():h.height(),i=g==b-1?f-d:_int(i);c?(h.setLeft(e+d),h.setWidth(i)):(h.setTop(e+d),h.setHeight(i)),d+=i}},changeSize:function(a,b){this._group&&this._group.$_inflateGroup(this,a,b),this.$_inflateWithLowers(a,b),this._grid.bodyView().redrawFocus()},changeSizeComplete:function(){this.$_trimLowerSize()},setTop:function(a){this._super(a)},$_insertLower:function(a,b){this._lowers.splice(b,0,a)},$_addLower:function(a){this._lowers.push(a)},$_removeLower:function(a){var b=this._lowers.indexOf(a);b>-1&&this._lowers.splice(b,1)},_doLayoutContent:function(){},getVisibleLowers:function(a,b){for(var c=[],d=this._lowers.length,e=0;d>e;e++){var f=this._lowers[e];!a&&f instanceof LabelSummaryCellElement||!f.isVisible()||c.push(this._lowers[e])}return b&&d>0&&c.sort(function(a,b){var c=a.index(),d=b.index();return d>c?-1:c>d?1:0}),c},$_resetTree:function(){var a=this._group?this._group._treePath.slice(0):[];this instanceof LabelSummaryCellElement||this._valueLabel&&!_defined(this._value)||a.push(this._value),this._treePath=a},$_resetIndex:function(){var a,b;this._group.isRoot()||(b=this._type==FieldType.ROW?this._group._cellIndex.rows():this._group._cellIndex.columns()),a=b?_clone(b):{},this._valueLabel&&!_defined(this._value)?a.valueField=this._valueField.name():this instanceof LabelSummaryCellElement?a[CellIndex.ATTR_ISSUM]=!0:a[this._labelField.name()]=this._value,this._type==FieldType.ROW?this._cellIndex.setRows(a):this._cellIndex.setColumns(a)},getTooltip:function(){for(var a="",b=this;b&&!b.isRoot();)""!=a&&(a=" - "+a),a=b._text+a,b=b._group;return a},$_getCellText:function(){return this._text&&this._keepSpace?this._text.replace(/(\s)/g,"&nbsp;"):this._super();
}}),GroupCellElement=defineClass("GroupCellElement",LabelCellElement,{init:function(a,b,c,d,e,f,g){this._super(a,b,c,d,null,e,f,g?g.value:null,g?g.label:null),this._expander=new GroupExpander(a,this,!0),this.addChild(this._expander),this._dataObj=g,this._expander.addListener(this),this._expanded=!0,this._sumDeltaX=0,this._sumDeltaY=0,this._deflateW=0,this._deflateH=0,this._orgWidth=0,this._orgHeight=0,this._partial=!1},destroy:function(){this._expander.removeListener(this),this._super()},expander:null,summaryCell:null,summaryVisible:!0,expanded:function(){return this._expanded},setExpanded:function(a){a!=this._expanded&&(this._expanded=a,this._dataObj&&(this._dataObj.expand=a))},expand:function(){if(this._partial)this._dataObj.expand=!0,this._grid.expandPartialGroup(this);else if(!this._expanded){var a=this instanceof ColumnGroupCellElement,b=a?this._orgWidth-this._width:this._orgHeight-this._height;this._summaryVisible&&this._summaryCell._labelPosition==SummaryPosition.FIRST?(this._summaryChangeSize=(a?this._summaryCell.width():this._summaryCell.height())-this._orgSumSize,b+=this._summaryChangeSize):this._summaryChangeSize=0,this.setExpanded(!0),this._doExpand(this),!this._summaryVisible&&this._summaryCell.$_toggleMembers(!1),this._expander.setExpanded(!0),a?(this._group&&this._group.$_inflateGroup(this,b,0),this._grid.changeClientSize(this,b,0)):(this._group&&this._group.$_inflateGroup(this,0,b),this._grid.changeClientSize(this,0,b))}},collapse:function(){this._expanded&&(this._prepareCollapse(),this.inflate(this._deflateW,this._deflateH),this._doCollapse(this),this.setExpanded(!1),this._summaryVisible||(this._summaryCell.$_toggleMembers(!0),this instanceof ColumnGroupCellElement?this._summaryCell.offsetMembers(this._left-this._summaryCell._left,0):this._summaryCell.offsetMembers(0,this._top-this._summaryCell._top)),this._expander.setExpanded(!1),this._group&&this._group.$_inflateGroup(this,this._deflateW,this._deflateH),this._grid.changeClientSize(this,this._deflateW,this._deflateH))},setPartial:function(){this._partial=!0,this._expanded=!1,this._expander.setExpanded(!1)},_prepareCollapse:function(){this._orgWidth=this._width,this._orgHeight=this._height,this._orgSumSize=this._type==FieldType.ROW?this._summaryCell._height:this._summaryCell._width},_doExpand:function(a){},_doCollapse:function(a){for(var b=this._lowers.length;b--;){var c=this._lowers[b];this==a&&c instanceof LabelSummaryCellElement&&this._summaryVisible?c.offsetMembers(this._sumDeltaX,this._sumDeltaY):c.$_toggleMembers(!1)}},$_getExpenderRect:function(){return new Rectangle(2,2,GroupExpander.SIZE,GroupExpander.SIZE)},_doLayoutContent:function(){var a=this.$_getExpenderRect();this._expander.setSize(a.width,a.height)},onGroupExpanderExpand:function(){this.expand()},onGroupExpanderCollapse:function(){this.collapse()}}),ColumnGroupCellElement=defineClass("ColumnGroupCellElement",GroupCellElement,{init:function(a,b,c,d,e,f){this._super(a,FieldType.COLUMN,b,c,d,e,f)},_doRender:function(a){this._super(a)},_prepareCollapse:function(){this._super(),this._sumDeltaX=this._left-this._summaryCell._left,this._deflateW=this._summaryCell._width-this._width;for(var a=MAX_INT,b=this._lowers.length;b--;)this._lowers[b]instanceof LabelSummaryCellElement||(a=_min(a,this._lowers[b]._left));this._collapseX=this._left},_doExpand:function(a){for(var b=this._left-this._collapseX+this._summaryChangeSize,c=0,d=this._lowers.length;d>c;c++){var e=this._lowers[c];e instanceof LabelSummaryCellElement?this==a?e.offsetMembers(-this._sumDeltaX,0):(e.$_toggleMembers(!0),e.offsetMembers(e._labelPosition==SummaryPosition.FIRST?this._sumDeltaX:b,0)):(e.$_toggleMembers(!0),e.offsetMembers(b,0))}this.setWidth(this._orgWidth+this._summaryChangeSize)}}),RowGroupCellElement=defineClass("RowGroupCellElement",GroupCellElement,{init:function(a,b,c,d,e,f){this._super(a,FieldType.ROW,b,c,d,e,f)},_doRender:function(a){this._super(a)},_prepareCollapse:function(){this._super(),this._sumDeltaY=this._top-this._summaryCell._top,this._deflateH=this._summaryCell._height-this._height;for(var a=MAX_INT,b=this._lowers.length;b--;)this._lowers[b]instanceof LabelSummaryCellElement||(a=_min(a,this._lowers[b]._top));this._collapseY=this._top},_doExpand:function(a){for(var b=this._top-this._collapseY+this._summaryChangeSize,c=0,d=this._lowers.length;d>c;c++){var e=this._lowers[c];e instanceof LabelSummaryCellElement?this==a?e.offsetMembers(0,-this._sumDeltaY):(e.$_toggleMembers(!0),e.offsetMembers(0,e._labelPosition==SummaryPosition.FIRST?this._sumDeltaY:b)):(e.$_toggleMembers(!0),e.offsetMembers(0,b))}this.setHeight(this._orgHeight+this._summaryChangeSize)}}),ColumnRootCellElement=defineClass("ColumnRootCellElement",ColumnGroupCellElement,{init:function(a){this._super(a,-1),this.setLeft(0)},isRoot:function(){return!0}}),RowRootCellElement=defineClass("RowRootCellElement",RowGroupCellElement,{init:function(a){this._super(a,-1),this.setTop(0)},isRoot:function(){return!0}}),LabelSummaryCellElement=defineClass("LabelSummaryCellElement",LabelCellElement,{init:function(a,b,c,d,e,f,g,h,i,j){var k=h instanceof GroupCellElement&&e==SummaryPosition.FIRST?0:void 0;this._super(a,b,c,f,g,h,k,i,j),this._mergeCount=d?d:0,this._labelPosition=e,h instanceof LabelSummaryCellElement||h.setSummaryCell(this)},labelPosition:SummaryPosition.FIRST,_doLayoutContent:function(){},_doRender:function(a){this._super(a)},isTotalSummary:function(){return this._valueLabel?0==this._group._level:0==this._level}}),BodyCellElement=defineClass("BodyCellElement",PivotCellElement,{init:function(a,b){this._super(a,b)},destroy:function(){this._columnLabel&&this._columnLabel.removeBody(this),this._columnLabel=null,this._rowLabel&&this._rowLabel.removeBody(this),this._rowLabel=null,this._valueField=null,this._model=null,this._super()},columnLabel:null,rowLabel:null,model:null,emptyValue:null,setWidth:function(a){this._super(a),this._model&&this._model.setWidth(this._width)},setHeight:function(a){this._super(a),this._model&&this._model.setHeight(this._height)},setColumnLabel:function(a){a!=this._columnLabel&&(this._columnLabel&&this._columnLabel.removeBody(this),a&&a.addBody(this),this._columnLabel=a,this._cellIndex.setColumns(a.getCellIndex().columns()))},setRowLabel:function(a){a!=this._rowLabel&&(this._rowLabel&&this._rowLabel.removeBody(this),a&&a.addBody(this),this._rowLabel=a,this._cellIndex.setRows(a.getCellIndex().rows()))},setModel:function(a){a!=this._model&&(this.setValueField(a.field()),this.setValue(0==a.getCount()?this._emptyValue:a.getValue()),this._model=a)},setValueField:function(a){a!=this._valueField&&(this._valueField=a,this._cellIndex.setValueField(a.name()))},setValue:function(a){this._valueField.expression();this._value=a;var b;b=_isObject(a)?a.value:a;var c=this._valueField.getDisplayText(b);this._text=c?c:""},_doLayoutContent:function(){},_doRender:function(a){if(this._super(a),this._valueField){var b=this._valueField.valueAlignment();b?this._span.className=this.cssClass()+" "+b:this._valueField.expression()==ValueType.DISTINCT?this._span.className=this.cssClass()+" center":this._span.className=this.cssClass()}},getTooltip:function(){for(var a="",b=this._columnLabel;b&&!b.isRoot();)b.isValueLabel()&&0!=b.level()||(""!=a&&(a=" - "+a),a=b.text()+a),b=b.group();var c=RealPivotMessages.columnText+" : "+a;for(a="",b=this._rowLabel;b&&!b.isRoot();)""!=a&&(a=" - "+a),a=b.text()+a,b=b.group();var d=RealPivotMessages.rowText+" : "+a,e=this._valueField.getFieldHeader(),f=RealPivotMessages.valueText+" : "+this._text,g="<br/>"+RealPivotMessages.countText+" : "+this._model.getCount();return e+"<br/>"+f+"<br/>"+c+"<br/>"+d+g},isTotalSummary:function(){return!1}}),ValueCellElement=defineClass("ValueCellElement",BodyCellElement,{init:function(a){this._super(a,"realpivot-body-value")},_doLayoutContent:function(){},_doRender:function(a){this._super(a)}}),SummaryCellElement=defineClass("SummaryCellElement",BodyCellElement,{init:function(a,b,c){this._super(a,"realpivot-body-sum"),this._levelCssClass=this._baseClass=this.cssClass(),this.setLevel(b,c)},colLevel:0,rowLevel:0,_doLayoutContent:function(){},_doRender:function(a){this._super(a)},setLevel:function(a,b){this._colLevel=b,this._rowLevel=a;var c=this._baseClass;(0==b||0==a)&&(c+=" realpivot-body-sum-tot"),this.setCssClass(c),this._levelCssClass=c},isTotalSummary:function(){return 0==this._colLevel||0==this._rowLevel},setFixedSplit:function(a,b){var c=this._levelCssClass;a&&(c+=" realpivot-body-left-split"),b&&(c+=" realpivot-body-top-split"),this.setCssClass(c)}}),HandleElement=defineClass("HandleElement",ClickableElement,{init:function(a,b,c){this._super(a,c),this._css.removeProperty("position"),this._cellView=b},cellView:function(){return this._cellView}}),GroupExpander=defineClass("GroupExpander",HandleElement,{init:function(a,b,c){this._expanded=arguments.length>2?c:!0,this._super(a,b,this.$_getCssClass())},destroy:function(){this._super()},expanded:!0,setExpanded:function(a){this._expanded!=a&&(this._expanded=a,this.setCssClass(this.$_getCssClass()))},$_getCssClass:function(){return this._expanded?"realpivot-expander-expand":"realpivot-expander-collapse"},_doClick:function(a){this._expanded?this.fireEvent(GroupExpander.COLLAPSE):this.fireEvent(GroupExpander.EXPAND)}},{SIZE:15});GroupExpander.EXPAND="onGroupExpanderExpand",GroupExpander.COLLAPSE="onGroupExpanderCollapse";var LayerElement=defineClass("LayerElement",VisualElement,{init:function(a){this._super(),this._grid=a,this._element.style.pointerEvents="none",this._css.position="absolute",this._layers=[]},destroy:function(){for(var a=0,b=this._layers.length;b>a;a++)this._element.removeChild(this._layers[0]);this._layers=[],this._grid=null,this._super()},isLayer:function(){return!0}}),_wmv_=function(){var a=new Image;a.src="data:image/png;base64,"+_wm_,a.style.position="absolute",a.style.pointerEvents="none",a.style.zIndex=0;var b=new LayerElement;return b.setVisible(!1),b._element.appendChild(a),b.resize=function(b,c){this.setVisible(!0),this.setSize(b,c),a.style.left=(this.width()-a.width)/2+STYLE_PIXEL,a.style.top=(this.height()-a.height)/2+STYLE_PIXEL},b},MaskElement=defineClass("MaskElement",LayerElement,{init:function(){this._super(),this._element.className="realpivot-mask",this.setVisible(!1)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)}}),FocusCellElement=defineClass("FocusCellElement",LayerElement,{init:function(a){this._super(a),this._element.className="realpivot-focus"},draw:function(a,b,c,d){this.setBounds(a,b,c,d)}}),FocusGuideElement=defineClass("FocusCellElement",LayerElement,{init:function(a){this._super(a),this._element.className="realpivot-focus-guide"},draw:function(a,b,c,d){this.setBounds(a,b,c,d)}}),FocusElement=defineClass("FocusElement",LayerElement,{init:function(a,b){this._super(a),this._cell=new FocusCellElement(a),this.addChild(this._cell),this._leftGuide=new FocusGuideElement(a),this.addChild(this._leftGuide),this._rightGuide=new FocusGuideElement(a),this.addChild(this._rightGuide),this._topGuide=new FocusGuideElement(a),this.addChild(this._topGuide),this._bottomGuide=new FocusGuideElement(a),this.addChild(this._bottomGuide),this._originalX=0,this._originalY=0,this._offsetX=0,this._offsetY=0},guideVisible:!1,moveToCell:function(a,b,c){var d=a.isTotalSummary();this._totalColCell=d&&0==a.colLevel(),this._totalRowCell=d&&0==a.rowLevel(),a&&(this._originalX=a.left(),this._originalY=a.top(),arguments.length>2?(this._offsetX=b,this._offsetY=c):(this._offsetX=0,this._offsetY=0),this.$_draw(this._originalX,this._originalY,a.width(),a.height())),this.fireEvent(FocusElement.MOVED,a)},resetSize:function(){var a=top=0,b=this._parent.width(),c=this._parent.height();this.setBounds(a,top,b,c)},redraw:function(a){this.$_draw(a.left(),a.top(),a.width(),a.height())},scrollTo:function(a,b){_defined(a)&&this._cell.setLeft(this._originalX+this._offsetX-a),_defined(b)&&this._cell.setTop(this._originalY+this._offsetY-b),this._guideVisible&&this.$_drawGuide(this._bound)},$_drawGuide:function(a){var b=this._cell.getBounds(),c=b.bottom()>a.y&&b.y<a.bottom(),d=b.right()>a.x&&b.x<a.right(),e=b.x>a.x&&c,f=b.right()<a.right()&&c,g=b.y>a.y&&d,h=b.bottom()<a.bottom()&&d,i=this._cell.isVisible();this._leftGuide.setVisible(e),this._rightGuide.setVisible(f),this._topGuide.setVisible(g),this._bottomGuide.setVisible(h),e&&(f||i?this._leftGuide.draw(a.x,b.y,b.x-a.x,b.height):this._leftGuide.draw(a.x,b.y,a.width,b.height)),f&&(e||i?this._rightGuide.draw(b.right(),b.y,a.right()-b.right(),b.height):this._rightGuide.draw(a.x,b.y,a.width,b.height)),g&&(h||i?this._topGuide.draw(b.x,a.y,b.width,b.y-a.y):this._topGuide.draw(b.x,a.y,b.width,a.height)),h&&(g||i?this._bottomGuide.draw(b.x,b.bottom(),b.width,a.bottom()-b.bottom()):this._bottomGuide.draw(b.x,a.y,b.width,a.height))},$_draw:function(a,b,c,d){console.log("##focus draw");var e=this._grid,f=e.tmpSummaryOptions(),g=!0,h=this._bound=this.getClientRect(),i=e.columnWidth(),j=e.rowHeight();if(i<h.width&&(h.width=i),j<h.height&&(h.height=j),f.isTotalFixed()){var k=e.columnView().rootElement().summaryCell(),l=e.rowView().rootElement().summaryCell();if(k&&!this._totalColCell){var m=k.left(),n=k.width();f.columnPosition()==SummaryPosition.FIRST?n>a&&(h.leftBy(n),a+c>n?(c-=n-a,a=n):g=!1):a+c>m&&(h.rightBy(-n),m>a?c-=a+c-m:g=!1)}if(l&&!this._totalRowCell){var o=l.top(),p=l.height();f.rowPosition()==SummaryPosition.FIRST?p>b&&(h.topBy(p),b+d>p?(d-=p-b,b=p):g=!1):f.rowPosition()==SummaryPosition.LAST&&b+d>o&&(h.bottomBy(p),o>b?d-=b+d-o:g=!1)}}this._cell.setVisible(g),this._cell.draw(a--,b--,c--,d--),this._guideVisible&&this.$_drawGuide(h)}});FocusElement.MOVED="onFocusElementMoved";var ScrollEventType={LINE_UP:"lineUp",LINE_DOWN:"lineDown",LINE_LEFT:"lineLeft",LINE_RIGHT:"lineRight",PAGE_UP:"pageUp",PAGE_DOWN:"pageDown",PAGE_LEFT:"pageLeft",PAGE_RIGHT:"pageRight",WHEEL_X:"wheelX",WHEEL_Y:"wheelY",THUMB_TRACK:"thumbTrack",THUMB_END:"thumbEnd"},ScrollContainer=defineClass("ScrollContainer",VisualElement,{init:function(a){this._super(),this._owner=a,this._isContainer=!0,this._css.position="absolute",this._css.pointerEvents="none",this._hscrollBar=new ScrollBar(a,this,!1),this.addChild(this._hscrollBar),this._vscrollBar=new ScrollBar(a,this,!0),this.addChild(this._vscrollBar),this._hscrollBar.addListener(this),this._vscrollBar.addListener(this),this._corner=new ScrollBarCorner(a),this.addChild(this._corner),this._scrollWidth=0,this._scrollHeight=0},destroy:function(){this._super(),this._hscrollBar=null,this._vscrollBar=null,this._corner=null},hscrollBar:null,vscrollBar:null,hscrollable:!1,vscrollable:!1,scrollBarSize:15,scrollUnitSize:25,setLeftPos:function(a){a=_max(0,_min(a,this._maxWidth-this._scrollWidth)),this._owner.scrollTo(a,void 0)},setTopPos:function(a){a=_max(0,_min(a,this._maxHeight-this._scrollHeight)),this._owner.scrollTo(void 0,a)},wheelScroll:function(a,b){var c=!1,d=this._scrollUnitSize;return a=_ceil(a/d)*d,b=_ceil(b/d)*d,this._hscrollable&&(c=this._hscrollBar._doScroll(ScrollEventType.WHEEL_X,-a,0)),this._vscrollable&&(c=c||this._vscrollBar._doScroll(ScrollEventType.WHEEL_Y,-b,0)),c},clientWidth:function(){return this._width-(this._vscrollable?this._scrollBarSize:0)},clientHeight:function(){return this._height-(this._hscrollable?this._scrollBarSize:0)},updateScroll:function(a,b,c,d,e){var f=b+d,g=c+e,h=this._owner.topPos(),i=this._owner.leftPos(),j=a.clone();this.setRect(j),this._measure(f,g),j.width=j.width-(this._vscrollable?this._scrollBarSize:0),j.height=j.height-(this._hscrollable?this._scrollBarSize:0),this._maxWidth=b,this._maxHeight=c;var k,l;this.layoutContent(),i>f-j.width&&this.setLeftPos(_max(f-j.width,0)),h>g-j.height&&this.setTopPos(_max(g-j.height,0)),this._hscrollable&&(k=b,this._scrollWidth=j.width-d,l=Math.min(this._scrollWidth,b-i),this._hscrollBar.setProperties(0,k,l),this._hscrollBar.setPosition(i)),this._vscrollable&&(k=c,this._scrollHeight=j.height-e,l=Math.min(this._scrollHeight,c-h),this._vscrollBar.setProperties(0,k,l),this._vscrollBar.setPosition(h))},_measure:function(a,b){this._hscrollable=a>this._width,this._vscrollable=b>this._height;var c=this._scrollBarSize;this._hscrollable&&(this._vscrollable=b>this._height-c),this._vscrollable&&(this._hscrollable=a>this._width-c)},_doLayoutContent:function(){var a=this._width,b=this._height,c=this._scrollBarSize,d=this._vscrollable?c:0,e=this._hscrollable?c:0;if(this._hscrollBar.setVisible(this._hscrollable),this._hscrollable){var f=this._hscrollBar.width();this._hscrollBar.setBounds(0,b-c,a-d,c),a-d!=f&&this._hscrollBar.layoutContent()}if(this._vscrollBar.setVisible(this._vscrollable),this._vscrollable){var f=this._vscrollBar.height();this._vscrollBar.setBounds(a-c,0,c,b-e),b-e!=f&&this._vscrollBar.layoutContent()}this._corner.setVisible(this._hscrollable&&this._vscrollable),this._corner.isVisible()&&this._corner.setBounds(a-c,b-c,c,c)},onScrollBarScrolled:function(a,b,c,d){var e=this._owner.topPos(),f=this._owner.leftPos(),g=a.getScrollUnit(b);if(a.isVertical())switch(b){case ScrollEventType.LINE_DOWN:case ScrollEventType.LINE_UP:case ScrollEventType.PAGE_DOWN:case ScrollEventType.PAGE_UP:this.setTopPos(e+c*g);break;case ScrollEventType.WHEEL_Y:this.setTopPos(e+c);break;default:this.setTopPos(d)}else switch(b){case ScrollEventType.LINE_RIGHT:case ScrollEventType.LINE_LEFT:case ScrollEventType.PAGE_RIGHT:case ScrollEventType.PAGE_LEFT:this.setLeftPos(f+c*g);break;case ScrollEventType.WHEEL_X:this.setLeftPos(f+c);break;default:this.setLeftPos(d)}}}),ScrollBar=defineClass("ScrollBar",ClickableElement,{init:function(a,b,c){this._super(a,"realpivot-sbar"),this._vertical=c,this._container=b,this._nearButton=new ScrollButton(a,this,!1),this.addChild(this._nearButton),this._farButton=new ScrollButton(a,this,!0),this.addChild(this._farButton),this._thumb=new ScrollThumb(a,this),this.addChild(this._thumb),this._buttonSize=20,this._min=0,this._max=0,this._pos=0,this._page=0,this._maxPosition=0},destroy:function(){this._super(),this._nearButton=null,this._farButton=null,this._thumb=null},lineScrollCount:1,pageScrollCount:10,minThumbSize:20,mouseX:0,mouseY:0,isVertical:function(){return this._vertical},maxPosition:function(){return this._maxPosition},getScrollUnit:function(a){var b=this._container.scrollUnitSize();switch(a){case ScrollEventType.LINE_DOWN:case ScrollEventType.LINE_UP:case ScrollEventType.LINE_RIGHT:case ScrollEventType.LINE_LEFT:return this._lineScrollCount*b;case ScrollEventType.PAGE_DOWN:case ScrollEventType.PAGE_UP:case ScrollEventType.PAGE_RIGHT:case ScrollEventType.PAGE_LEFT:return this._pageScrollCount*b;default:return 1}},setProperties:function(a,b,c){a=Math.max(0,a),b=Math.max(a,b),(a!=this._min||b!=this._max||c!=this._page)&&(this._min=a,this._max=b,this._page=c,this._pos=Math.min(this._max,Math.max(this._min,this._pos)),this._maxPosition=Math.max(0,this._max-this._page),this._doLayoutContent())},setPosition:function(a){return a=Math.min(this._maxPosition,Math.max(this._min,a)),a!=this._pos?(this._pos=a,this._doLayoutContent(),!0):!1},ptInTrack:function(a,b,c){var d=this.containerToClient(a,b);if(this._vertical){if(d.y>=this._nearButton.height()&&d.x<this._farButton.top())return!c&&d.y<this._thumb.top()||c&&d.y>=this._thumb.bottom()}else if(a>=this._nearButton.width()&&a<this._farButton.left())return!c&&d.x<this._thumb.left()||c&&d.x>=this._thumb.right();return!1},_doLayoutContent:function(){var a=this._vertical,b=this._buttonSize,c=(a?this._height:this._width)-2*b,d=Math.min(c,Math.max(this._minThumbSize,_int(c*this._page/(this._max-this._min+1)))),e=b+Math.min(c-d,Math.max(0,_int((c-d)*this._pos/(this._maxPosition-this._min))));a?(this._nearButton.setBounds(0,0,this._width,b),this._farButton.setBounds(0,this._height-b,this._width,b),c>=d&&this._thumb.setBounds(1,e,this._width-2,d)):(this._nearButton.setBounds(0,0,b,this._height),this._farButton.setBounds(this._width-b,0,b,this._height),c>=d&&this._thumb.setBounds(e,1,d,this._height-2))},_doScroll:function(a,b,c){var d=!1;return 0!=b?d=this.setPosition(this._pos+b*this.getScrollUnit(a)):c&&(d=this.setPosition(c)),d&&this.fireEvent(ScrollBar.SCROLLED,a,b,c),d},_mouseOut:function(){this._nearButton.setPressed(!1),this._farButton.setPressed(!1),this._thumb.setPressed(!1)},_doClick:function(a,b){this._vertical?b<this._thumb.top()?this._doScroll(ScrollEventType.PAGE_UP,-1,0):this._doScroll(ScrollEventType.PAGE_DOWN,1,0):a<this._thumb.left()?this._doScroll(ScrollEventType.PAGE_LEFT,-1,0):this._doScroll(ScrollEventType.PAGE_RIGHT,1,0)}});ScrollBar.SCROLL_LINE_SIZE=25,ScrollBar.SCROLLED="onScrollBarScrolled";var ScrollButton=defineClass("ScrollButton",ClickableElement,{init:function(a,b,c){var d=this.$_getClassName(b.isVertical(),c);this._super(a,d),this._scrollBar=b,this._far=c},destroy:function(){this._scrollBar=null,this._super()},far:!1,enabled:!0,pressed:!1,setPressed:function(a){a!=this._pressed&&(this.setCssClass(this.$_getClassName(this.isVertical(),this._far,a)),this._pressed=a)},isVertical:function(){return this._scrollBar.isVertical()},scrollBar:function(){return this._scrollBar},_doClick:function(a,b){this.isVertical()?this._far?this._scrollBar._doScroll(ScrollEventType.LINE_DOWN,1,0):this._scrollBar._doScroll(ScrollEventType.LINE_UP,-1,0):this._far?this._scrollBar._doScroll(ScrollEventType.LINE_RIGHT,1,0):this._scrollBar._doScroll(ScrollEventType.LINE_LEFT,-1,0)},$_getClassName:function(a,b,c){var d=c?"realpivot-sbar-button-pressed":"realpivot-sbar-button",e=a?"realpivot-sbar-v":"realpivot-sbar-h";return e+=b?"fbutton":"nbutton",d+" "+e}}),ScrollThumb=defineClass("ScrollThumb",ClickableElement,{init:function(a,b){this._scrollBar=b,this._request=null,this._super(a,this.$_getClassName())},pressed:!1,setPressed:function(a){a!=this._pressed&&(this.setCssClass(this.$_getClassName(a)),this._pressed=a)},destroy:function(){this._scrollBar=null,this._request=null,this._super()},scrollBar:function(){return this._scrollBar},isVertical:function(){return this._scrollBar._vertical},getRequest:function(){return this._request||(this._request=new ScrollThumbRequest(this)),this._request},getTracker:function(a,b){return new ScrollThumbTracker},$_getClassName:function(a){return cls=a?"realpivot-sbar-thumb-pressed":"realpivot-sbar-thumb"}}),ScrollBarCorner=defineClass("ScrollBarCorner",PivotElement,{init:function(a){this._super(a,"realpivot-sbar-corner")}}),ScrollThumbRequest=defineClass("ScrollThumbRequest",Request,{init:function(a){this._super(),this._thumb=a,this._scrollBar=a.scrollBar(),this._grid=this._scrollBar.grid()},thumb:function(){return this._thumb},scrollBar:function(){return this._scrollBar},grid:function(){return this._grid},cursor:function(){return Cursor.POINTER},isSelectable:function(){return!1}}),ScrollThumbTracker=defineClass("ScrollThumbTracker",GridDragTracker,{init:function(a,b,c){this._super(a,"scrollThumbTracker"),this._request=a,this._thumb=a.thumb(),this._scrollBar=a.scrollBar(),this._vertical=this._scrollBar.isVertical();var d=this._scrollBar.containerToClient(b,c);this._scrollBar.isVertical()?this._offset=d.y-this._thumb.top():this._offset=d.x-this._thumb.left()},destroy:function(){this._request=null,this._thumb=null,this._scrollBar=null,this._super()},isStartWhenCreated:function(){return!0},_doStart:function(a,b){return this._thumb.setPressed(!0),!0},_doDrag:function(a,b){return this.$_doScroll(a,b,ScrollEventType.THUMB_TRACK)},_doCompleted:function(a,b){return this.$_doScroll(a,b,ScrollEventType.THUMB_END)},_doCanceled:function(a,b){},_doEnded:function(){this._thumb.setPressed(!1)},$_doScroll:function(a,b,c){var d=this._scrollBar._maxPosition-this._scrollBar._min+1,e=this._scrollBar._buttonSize,f=this._scrollBar.containerToClient(a,b);if(this._scrollBar.isVertical()){var g=this._scrollBar.height()-2*e-this._thumb.height();if(0>=g)return;f.y-=this._offset,f.y=(f.y-e)*d/g,this._scrollBar._doScroll(c,0,_int(f.y))}else{var g=this._scrollBar.width()-2*e-this._thumb.width();if(0>=g)return;f.x-=this._offset,f.x=(f.x-e)*d/g,this._scrollBar._doScroll(c,0,_int(f.x))}return!0}}),ScrollButtonTimer=defineClass("ScrollButtonTimer",EventAware,{init:function(a){this._super(),this._button=a,this._scrollBar=a.scrollBar(),this._active=!1,this._timer=UNDEFINED,this._ready=!1},start:function(){this._button.setPressed(!0),this._active=!0,this.$_fireEvent(),setTimeout(function(){this._ready&&(this._ready=!1,this._timer=setInterval(function(){this._active&&this.$_fireEvent()}.bind(this),50))}.bind(this),200),this._ready=!0},move:function(a,b){var c=this._button.containerToClient(a,b);this._active=this._button.containsInClient(c.x,c.y)},stop:function(a,b){this._ready=!1,this._timer&&clearInterval(this._timer),this._button.setPressed(!1)},$_fireEvent:function(){var a=null,b=1;this._scrollBar.isVertical()?this._button.isFar()?a=ScrollEventType.LINE_DOWN:(a=ScrollEventType.LINE_UP,b=-1):this._button.isFar()?a=ScrollEventType.LINE_RIGHT:(a=ScrollEventType.LINE_LEFT,b=-1),this._scrollBar._doScroll(a,b,0)}}),ScrollTrackTimer=defineClass("ScrollTrackTimer",EventAware,{init:function(a,b){this._super(a),this._scrollBar=a,this._isFar=b,this._active=!1,this._timer=UNDEFINED,this._ready=!1},start:function(){this._active=!0,this.$_fireEvent(),setTimeout(function(){this._ready&&(this._ready=!1,this._timer=setInterval(function(){this._active&&this.$_fireEvent()}.bind(this),50))}.bind(this),200),this._ready=!0},move:function(a,b){var c=this._scrollBar.containerToClient(a,b);this._active=this._scrollBar.ptInTrack(c.x,c.y,this._isFar)},stop:function(a,b){this._ready=!1,this._timer&&clearInterval(this._timer)},$_fireEvent:function(){var a=null,b=0,c=this._scrollBar._thumb;if(this._scrollBar.isVertical()){var d=this._scrollBar.mouseY();this._isFar&&d>c.bottom()?(a=ScrollEventType.PAGE_DOWN,b=1):d<c.top()&&(a=ScrollEventType.PAGE_UP,b=-1)}else{var e=this._scrollBar.mouseX();this._isFar&&e>c.right()?(b=1,a=ScrollEventType.PAGE_RIGHT):e<c.left()&&(a=ScrollEventType.PAGE_LEFT,b=-1)}0!=b&&this._scrollBar._doScroll(a,b,0)}}),GridScrollTool=defineClass("GridScrollTool",null,{init:function(a){this._super(a,"gridScrollTool"),this._scrollTimer=null},isScrolling:function(){return null!=this._scrollTimer},stop:function(a,b){this._scrollTimer&&(this._scrollTimer.stop(a,b),this._scrollTimer=null)},start:function(a,b,c){return this._curruntScrollBar=null,a instanceof ScrollButton?(a.isEnabled()&&(this._scrollTimer=new ScrollButtonTimer(a),this._scrollTimer.start()),!0):a instanceof ScrollBar&&(this._curruntScrollBar=a,a.ptInTrack(b,c,!0)?this._scrollTimer=new ScrollTrackTimer(a,!0):a.ptInTrack(b,c,!1)&&(this._scrollTimer=new ScrollTrackTimer(a,!1)),this._scrollTimer)?(a.setMouseX(b),a.setMouseY(c),this._scrollTimer.start(),!0):!1},move:function(a,b){this._curruntScrollBar&&(this._curruntScrollBar.setMouseX(a),this._curruntScrollBar.setMouseY(b)),this._scrollTimer.move(a,b)}}),PivotView=defineClass("PivotView",VisualElement,{init:function(a){this._super(),this._container=a,this._setupView=null,this._container.appendChild(this._element),this.setParentElement(this._container),this._element.className="realpivot",this._css.position="relative",this._eventHandlers={},this._eventNodes=[],this._activeTool=this._createDefaultTool(),this._displayOptions=new DisplayOptions,this._groupOptions=new GroupOptions,this._summaryOptions=new SummaryOptions,this._headerOptions=new HeaderOptions,this._copyOptions=new CopyOptions,this._tmpDisplayOptions=new DisplayOptions,this._tmpSummaryOptions=new SummaryOptions,this._tmpHeaderOptions=new HeaderOptions,this._noreadyView=new NotReadyElement(this),this.addChild(this._noreadyView),this._emptyView=new EmptyElement(this),this.addChild(this._emptyView),this._bodyContainer=new OverflowContainer,this.addChild(this._bodyContainer),this._rowContainer=new OverflowContainer,this.addChild(this._rowContainer),this._colContainer=new OverflowContainer,this.addChild(this._colContainer),this._bodyView=new BodyElement(this),this._bodyContainer.addChild(this._bodyView),this._rowView=new RowLabelElement(this),this._rowContainer.addChild(this._rowView),this._columnView=new ColumnLabelElement(this),this._colContainer.addChild(this._columnView),this._headerView=new HeaderElement(this),this.addChild(this._headerView),this._layerView=new LayerElement(this),this.addChild(this._layerView),this._scrollContainer=new ScrollContainer(this),this.addChild(this._scrollContainer),this._focusView=new FocusElement(this),this._bodyContainer.addChild(this._focusView),this._focusView.addListener(this),this._maskView=new MaskElement,this.addChild(this._maskView),this._exporter=null,this._tooltipManager=new TooltipManager(this._element),this._progressManager=new ProgressManager(this._element),this._contextMenuManager=new ContextMenuManager(this._element),this._defContextItems=[{text:"About RealPivot",callback:this.$_aboutMenuHandler}],this._globalContextItems=this._defContextItems.slice(),this._contextItems=[],this._context,this._bodyWidth=0,this._bodyHeight=0,this.addLayerElement(_wmv_()),this._registerListners(),this._layouted=!1,this._fillLayouted=!1,this._offsetX=0,this._offsetY=0;var b=this._element;do b.offsetLeft&&(this._offsetX+=b.offsetLeft),b.offsetTop&&(this._offsetY+=b.offsetTop);while(b=b.offsetParent);this._orgColumnWidths=[],this._orgRowHeights=[],this._columnPoints=[],this._rowPoints=[],this._columnLevelHeights=[],this._rowLevelWidths=[],this._titleHeight=0,this._columnHeight=0,this._colsWidth=0,this._rowsHeight=0,this._centralPt=new Point,this.resetSize()},destroy:function(){this._removeListenerAll(),this._bodyContainer.removeChild(this._focusView),this._focusView.removeListener(this),this._focusView.destroy(),this._focusView=null,this._tooltipManager.destroy(),this._tooltipManager=null,this._progressManager.destroy(),this._progressManager=null,this._contextMenuManager.destroy(),this._contextMenuManager=null,this._focusView=null,this._displayOptions.destroy(),this._displayOptions=null,this._groupOptions.destroy(),this._groupOptions=null,this._summaryOptions.destroy(),this._summaryOptions=null,this._headerOptions.destroy(),this._headerOptions=null,this._copyOptions.destroy(),this._copyOptions=null,this._tmpDisplayOptions.destroy(),this._tmpDisplayOptions=null,this._tmpSummaryOptions.destroy(),this._tmpSummaryOptions=null,this._tmpHeaderOptions.destroy(),this._tmpHeaderOptions=null,this._centralPt=null,this._container=null,this._dataSource=null,this._setupView=null,this._modelManager&&(this._modelManager.removeListener(this),this._modelManager.destroy(),this._modelManager=null),this._activeTool&&(this._activeTool.destroy(),this._activeTool=null),this._exporter&&(this._exporter.destroy(),this._exporter=null),this._super()},displayOptions:null,headerOptions:null,summaryOptions:null,groupOptions:null,tmpDisplayOptions:null,tmpHeaderOptions:null,tmpSummaryOptions:null,dataSource:null,leftPos:0,topPos:0,bodyWidth:function(){return this._bodyWidth},bodyHeight:function(){return this._bodyHeight},setDataSource:function(a){assert(a instanceof PivotDataProvider,"dataSource must be PivotDataProvider"),this._dataSource=a,a&&(this._modelManager?this._modelManager.setDataSource(a):this._modelManager=new PivotModelManager(a),this._modelManager.addListener(this))},modelManager:function(){return this._modelManager},setupView:function(){return this._setupView},setSetupView:function(a){this._setupView=a},headerView:function(){return this._headerView},columnView:function(){return this._columnView},rowView:function(){return this._rowView},bodyView:function(){return this._bodyView},focusView:function(){return this._focusView},columnPoints:function(){return this._columnPoints},rowPoints:function(){return this._rowPoints},titleHeight:function(){return this._titleHeight},columnWidth:function(){return this._colsWidth},columnHeight:function(){return this._columnHeight},rowWidth:function(){return this._rowWidth},rowHeight:function(){return this._rowsHeight},columnLevelHeight:function(a){return this._columnLevelHeights[a]},rowLevelWidth:function(a){return this._rowLevelWidths[a];
},columnLevelHeights:function(){return this._columnLevelHeights},rowLevelWidths:function(){return this._rowLevelWidths},tooltipManager:function(){return this._tooltipManager},contextMenuManager:function(){return this._contextMenuManager},activeTool:function(){return this._activeTool},getColumnDepth:function(){return this._columnLevelHeights.length},getRowDepth:function(){return this._rowLevelWidths.length},getLeafColumnCount:function(){return this._columnPoints.length-1},getLeafRowCount:function(){return this._rowPoints.length-1},getVisibleColumnCount:function(){return this._columnView.getLeafCells().length},getVisibleRowCount:function(){return this._rowView.getLeafCells().length},getColumnLevelSumHeight:function(a,b){a=_max(a,0),b=_min(b,this._columnLevelHeights.length-1);for(var c=0,d=a;b>=d;d++)c+=this._columnLevelHeights[d];return c},getRowLevelSumWidth:function(a,b){a=_max(a,0),b=_min(b,this._rowLevelWidths.length-1);for(var c=0,d=a;b>=d;d++)c+=this._rowLevelWidths[d];return c},valueLabelVisible:function(){return this._dataSource.fieldManager().valueCount()>1},setOrgColumnWidth:function(a,b){var c=_clone(a.getCellIndex().columns());(vfield=a.valueField())&&(c[CellIndex.ATTR_VFIELD]=vfield.name());for(var d=this._orgColumnWidths.length;d--;){var e=this._orgColumnWidths[d];if(_equalsObjEx(e,c,"width"))return void(e.width=b)}c.width=b,this._orgColumnWidths.push(c)},setOrgRowHeight:function(a,b){for(var c=_clone(a.getCellIndex().rows()),d=this._orgRowHeights.length;d--;){var e=this._orgRowHeights[d];if(_equalsObjEx(e,c,"height"))return void(e.height=b)}c.height=b,this._orgRowHeights.push(c)},changeColumnLevelHeight:function(a,b){_trace("changeColumnLevelHeight "+a+b),this._headerView.changeHeight(b),this._columnView.changeHeight(a,b),this._rowContainer.shift(0,b),this._bodyContainer.shift(0,b),this._focusView.resetSize(),this._centralPt.y+=b,this._updateScroll();var c=this._columnLevelHeights[a]+b;this._columnLevelHeights[a]=c},changeRowLevelWidth:function(a,b){_trace("changeRowLevelHeight "+a+b),this._headerView.changeWidth(a,b),this._rowView.changeWidth(a,b),this._colContainer.shift(b,0),this._bodyContainer.shift(b,0),this._focusView.resetSize(),this._centralPt.x+=b,this._updateScroll();var c=this._rowLevelWidths[a]+b;this._rowLevelWidths[a]=c},_registerListners:function(){var a=this._element;this._addListener(_win,"focus",this._focusHandlerFireFox.bind(this),!0),this._addListener(_win,"focusin",this._focusinHandler.bind(this),!0),this._addListener(a,"keydown",this._keyDownHandler.bind(this),!1),this._addListener(a,"keyup",this._keyUpHandler.bind(this),!1),this._addListener(a,"keypress",this._keyPressHandler.bind(this),!1),this._addListener(a,"click",this._clickHandler.bind(this),!1),this._addListener(a,"dblclick",this._dblclickHandler.bind(this),!1),this._addListener(a,"mousedown",this._globalMouseDownHandler.bind(this),!1),this._addListener(a,"mousedown",this._mouseDownHandler.bind(this),!1),this._addListener(_win,"mousemove",this._mouseMoveHandler.bind(this),!1),this._addListener(_win,"mouseup",this._mouseUpHandler.bind(this),!1),this._addListener(a,"mouseenter",this._mouseEnterHandler.bind(this),!1),this._addListener(a,"mouseleave",this._mouseLeaveHandler.bind(this),!1),this._addListener(a,"mouseover",this._mouseOverHandler.bind(this),!1),this._addListener(a,"touchstart",this._touchStartHandler.bind(this),!1),this._addListener(a,"touchmove",this._touchMoveHandler.bind(this),!1),this._addListener(a,"touchend",this._touchEndHandler.bind(this),!1),this._addListener(a,"touchcancel",this._touchCancelHandler.bind(this),!1),this._addListener(a,"touchleave",this._touchLeaveHandler.bind(this),!1),a.ondragstart=function(){return!1},_isFirefox?this._addListener(a,"DOMMouseScroll",this._mouseScrollHandler.bind(this),!1):this._addListener(a,"mousewheel",this._mouseWheelHandler.bind(this),!1)},_addListener:function(a,b,c,d){a in this._eventHandlers||(this._eventHandlers[a]={}),b in this._eventHandlers[a]||(this._eventHandlers[a][b]=[]),this._eventHandlers[a][b].push([c,d]),Dom.addEventListener(a,b,c,d),this._eventNodes.indexOf(a)<0&&this._eventNodes.push(a)},_removeListenerAll:function(){for(var a=this._eventNodes,b=0,c=a.length;c>b;b++){var d=a[b];if(d in this._eventHandlers){var e=this._eventHandlers[d];for(var f in e){for(var g=e[f],h=g.length;h--;){var i=g[h];Dom.removeEventListener(d,f,i[0],i[1]),delete g[h]}delete e[f]}delete this._eventHandlers[d]}delete a[b]}},_createDefaultTool:function(){return new DefaultPivotUITool(this)},$_initLabelPoints:function(a,b,c,d,e,f,g,h,i){d&&f&&h(b,c,!0,g,i);for(var j=0,k=a.length;k>j;j++){var l=a[j],m=b.concat(l.name),n=c.concat(l.value);l.hasOwnProperty("childs")&&l.expand?this.$_initLabelPoints(l.childs,m,n,e,e,f,g,h,i):h(m,n,!1,g,i)}d&&!f&&h(b,c,!0,g,i)},$_addColumnPoints:function(a,b,c,d,e){for(var f=this._columnPoints.length,g=this._columnPoints[f-1],h=0;h<e.length;h++){var i=this.$_findOrgColumnWidth(a.concat(CellIndex.ATTR_VFIELD),b.concat(e[h]),c);_defined(i)||(i=d[h]),this._columnPoints.push(g+i),g+=i}},$_addRowPoints:function(a,b,c,d){var e=this._rowPoints.length,f=this._rowPoints[e-1],g=this.$_findOrgRowHeight(a,b,c);_defined(g)||(g=d),this._rowPoints.push(f+g)},$_findOrgColumnWidth:function(a,b,c){for(var d={},e=a.length;e--;)d[a[e]]=b[e];for(c&&(d[CellIndex.ATTR_ISSUM]=!0),e=this._orgColumnWidths.length;e--;){var f=this._orgColumnWidths[e];if(_equalsObjEx(d,f,"width"))return f.width}return null},$_findOrgRowHeight:function(a,b,c){for(var d={},e=a.length;e--;)d[a[e]]=b[e];c&&(d[CellIndex.ATTR_ISSUM]=!0);for(var e=this._orgRowHeights.length;e--;){var f=this._orgRowHeights[e];if(_equalsObjEx(d,f,"height"))return f.height}return null},$_calcLabelPoints:function(){var a,b=this._dataSource,c=this._displayOptions,d=c.columnWidth(),e=c.columnHeight(),f=c.rowHeight(),g=c.rowLabelWidth(),h=c.rowGroupWidth(),i=this._summaryOptions,j=i.columnPosition()==SummaryPosition.FIRST,k=i.rowPosition()==SummaryPosition.FIRST,l=i.isColumnVisible(),m=i.isColumnGroupVisible(),n=i.isRowVisible(),o=i.isRowGroupVisible(),p=b.fieldManager(),q=p.getValueNames(),r=q.length,s=p.columnCount(),t=p.rowCount(),u=this._columnDepth=_max(s+(r>1?1:0),l?1:0),v=this._rowDepth=_max(t,n?1:0);this._columnPoints=[0],this._rowPoints=[0];var w=[];for(a=0;r>a;a++){var x=p.getValue(a);w.push(x.width()||d)}for(this.$_initLabelPoints(this._columnLabels,[],[],l,m,j,w,this.$_addColumnPoints.bind(this),q),this.$_initLabelPoints(this._rowLabels,[],[],n,o,k,f,this.$_addRowPoints.bind(this)),this._columnHeight=0,this._columnLevelHeights.length=u,a=0;u>a;a++)this._columnLevelHeights[a]=e,this._columnHeight+=this._columnLevelHeights[a];for(this._rowWidth=0,this._rowLevelWidths.length=v,a=0;v>a;a++){if(this._rowLevelWidths[a]=a==v-1?g:h,t>a){var x=p.getRow(a);x.width()&&(this._rowLevelWidths[a]=x.width())}this._rowWidth+=this._rowLevelWidths[a]}},_updateScroll:function(a){if(!a){var a=this.clientRect();a.inflate(0,0,-this._spaceWidth,-this._spaceHeight)}this._scrollContainer.updateScroll(a,this._colsWidth,this._rowsHeight,this._centralPt.x,this._centralPt.y)},$_getCurrentValue:function(a){var b=this._bodyView.getFocusCell();return a?b.text():b.value()},$_prepareLabels:function(a,b){function c(a,b,d){for(var e=a.length;e--;)a[e].hasOwnProperty("childs")&&(a[e].expand=d>b,d>b+1&&c(a[e].childs,b+1,d))}this._columnLabels=_clone(a),this._rowLabels=_clone(b);var d=this._groupOptions.columnExpand();c(this._columnLabels,0,-1==d?MAX_INT:d);var e=this._groupOptions.rowExpand();c(this._rowLabels,0,-1==e?MAX_INT:e)},_doLayoutContent:function(a){var b=this._dataSource,c=b.fieldManager(),d=this._tmpHeaderOptions,e=this._tmpDisplayOptions,f=(e.isShowProgress(),this.clientRect()),g=this._layerView;this._layouting=!0,this._fillLayouted&&(this._scrollContainer.setLeftPos(0),this._scrollContainer.setTopPos(0)),this._colContainer.removeChild(this._columnView),this._rowContainer.removeChild(this._rowView),this._bodyContainer.removeChild(this._bodyView),this._bodyContainer.removeChild(this._focusView),this._columnView._clearCells(),this._rowView._clearCells(),this._bodyView._clearCells(),g.setRect(f);var h=f.clone();h.inflate(0,0,-this._spaceWidth,-this._spaceHeight);var i=b.isEmpty(),j=b.isDataEmpty();if(i||j)this._noreadyView.setVisible(i),this._emptyView.setVisible(!i),this._headerView.setVisible(!1),this._scrollContainer.setVisible(!1),h.inflate(-1,-1),i?(this._noreadyView.setRectI(h),this._noreadyView.layoutContent()):(this._emptyView.setRectI(h),this._emptyView.layoutContent());else{this._noreadyView.setVisible(!1),this._emptyView.setVisible(!1),this._scrollContainer.setVisible(!0),this._headerView.setVisible(!0),this.$_prepareLabels(b.getColumnLabels(),b.getRowLabels()),this.$_calcLabelPoints();var k=this._titleHeight=d.formType()==HeaderFormType.NORMAL&&(d.isTitleVisible()||d.isColumnHeadVisible())?d.titleHeight():0,l=2*k-this._columnHeight;l>0&&(this._columnHeight+=l,this._columnLevelHeights[this._columnLevelHeights.length-1]+=l),this._centralPt.set(this._rowWidth,k+this._columnHeight);var m=this._colsWidth=this._columnPoints[this._columnPoints.length-1],n=this._rowsHeight=this._rowPoints[this._rowPoints.length-1];this._updateScroll(h),this._scrollContainer.isHscrollable()&&(h.height-=this._scrollContainer.scrollBarSize()),this._scrollContainer.isVscrollable()&&(h.width-=this._scrollContainer.scrollBarSize());var o=h.width-this._centralPt.x,p=h.height-this._centralPt.y;this._rowContainer.setBounds(0,this._centralPt.y,h.width,p),this._colContainer.setBounds(this._centralPt.x,k,o,h.height),this._columnView.setBounds(0,0,m,this._centralPt.y-k),this._columnView.setLabels(this._columnLabels),this._columnView.setDepth(this._columnDepth),this._columnView.setValues(c.getValues()),this._rowView.setBounds(0,0,this._centralPt.x,n),this._rowView.setLabels(this._rowLabels),this._rowView.setDepth(this._rowDepth);var q=h.clone();q.height=this._centralPt.y,this._headerView.setColumnFields(c.getColumns()),this._headerView.setRowFields(c.getRows()),this._headerView.setValueFields(c.getValues()),this._headerView.setRectI(q),this._headerView.layoutContent(),this._bodyContainer.setBounds(this._centralPt.x,this._centralPt.y,o,p),this._focusView.setGuideVisible(e.isShowFocusGuide()),this._focusView.resetSize();var r=new Rectangle(0,0,m,n);this._bodyView.setRectI(r),this._bodyView.setColumnView(this._columnView),this._bodyView.setRowView(this._rowView),this._bodyView.setValueFields(c.getValues()),this._bodyView.setValues(b._values),this._bodyView.setSummaries(b._summaries),this._columnView.layoutContent(),this._rowView.layoutContent(),setTimeout(function(){this._bodyView.layoutContent(function(){setTimeout(function(){this._bodyContainer.addChild(this._bodyView),this._colContainer.addChild(this._columnView),this._rowContainer.addChild(this._rowView),this._displayOptions.isShowFocus()&&this._bodyContainer.addChild(this._focusView),a&&a()}.bind(this))}.bind(this));var b=this._scrollContainer.clientWidth(),c=this._scrollContainer.clientHeight();this._bodyWidth=b-this._centralPt.x,this._bodyHeight=c-this._centralPt.y,this._colContainer.resize(b-this._centralPt.x,c),this._rowContainer.resize(b,c-this._centralPt.y),this._headerView.setWidth(b),this._fillLayouted=!0,this._layouting=!1}.bind(this),100)}this._layouted=!0,setTimeout(function(){g.getChild(0).resize(f.width,f.height)})},_doRender:function(a){},onPivotModelManagerBuild:function(){this._layouted&&this.layoutContent()},onFocusElementMoved:function(a,b){this._fireCurrentChanged(b)},draw:function(a){this._tmpDisplayOptions.assign(this._displayOptions),this._tmpSummaryOptions.assign(this._summaryOptions),this._tmpHeaderOptions.assign(this._headerOptions),this._scrollContainer.setScrollUnitSize(this._tmpDisplayOptions.rowHeight()),this.layoutContent(a)},getOptions:function(){return{display:this.getDisplayOptions(),summary:this.getSummaryOptions(),header:this.getHeaderOptions(),copy:this.getCopyOptions(),group:this.getGroupOptions()}},setOptions:function(a){a.display&&this.setDisplayOptions(a.display),a.summary&&this.setSummaryOptions(a.summary),a.header&&this.setHeaderOptions(a.header),a.copy&&this.setCopyOptions(a.copy),a.group&&this.setGroupOptions(a.group)},getDisplayOptions:function(){return this._displayOptions.proxy()},setDisplayOptions:function(a){this._displayOptions.assign(a)},getSummaryOptions:function(){return this._summaryOptions.proxy()},setSummaryOptions:function(a){this._summaryOptions.assign(a)},getHeaderOptions:function(){return this._headerOptions.proxy()},setHeaderOptions:function(a){this._headerOptions.assign(a)},getCopyOptions:function(){return this._copyOptions.proxy()},setCopyOptions:function(a){this._copyOptions.assign(a)},getGroupOptions:function(){return this._groupOptions.proxy()},setGroupOptions:function(a){this._groupOptions.assign(a)},changeClientSize:function(a,b,c,d){var d=arguments.length>3?d:LayoutMode.CELL;this._colsWidth+=b,this._rowsHeight+=c;var e=this._scrollContainer.clientWidth(),f=this._scrollContainer.clientHeight();this._updateScroll();var g=this._scrollContainer.clientWidth(),h=this._scrollContainer.clientHeight(),i=g-this._centralPt.x,j=h-this._centralPt.y;this._colContainer.resize(i,h),this._rowContainer.resize(g,j),this._bodyContainer.resize(i,j),this._focusView.resetSize();var k=h-f,l=g-e,m=this._columnView.width()+b+l,n=this._rowView.height()+c+k;this._bodyWidth+=l,this._bodyHeight+=k,this._columnView.setWidth(m),this._rowView.setHeight(n),this._bodyView.inflate(m,n),this._bodyView.updateCells(d,a)},setCursor:function(a){this._css.cursor=a},resetSize:function(){var a=this._container.getBoundingClientRect();this._calcOuterSpace(),this.setBounds(0,0,a.width-this._spaceWidth,a.height-this._spaceHeight);var b=this._container.getBoundingClientRect();if((a.width!=b.width||a.height!=b.height)&&(b.width-=this._spaceWidth,b.height-=this._spaceHeight,a=b,this.setBounds(0,0,a.width-this._spaceWidth,a.height-this._spaceHeight)),this._fillLayouted){var c=this._layerView.getChild(0);c&&c.resize(a.width,a.height),this._updateScroll();var d=this._scrollContainer.clientWidth(),e=this._scrollContainer.clientHeight(),f=d-this._centralPt.x,g=e-this._centralPt.y;this._bodyWidth=f,this._bodyHeight=g,this._headerView.setWidth(d),this._colContainer.resize(f,e),this._rowContainer.resize(d,g),this._bodyContainer.resize(f,g),this._focusView.resetSize(),this._bodyView.updateCells(LayoutMode.RESIZE,f,g)}},scrollTo:function(a,b,c){var d=this._tmpDisplayOptions.isVirtualRendering(),e=(this._displayOptions.isShowFocus(),void 0!=b&&this._topPos!=b);if(void 0!=a&&this._leftPos!=a){var f=a-this._leftPos;this._columnView.scroll(f,0),this._layouting||(d?this._bodyView.updateCells(LayoutMode.SCROLL,f,0,function(){e||c&&c()}):(this._bodyView.offset(-f,0),c&&c())),this._leftPos=a}if(e){var f=b-this._topPos;this._rowView.scroll(0,f),this._layouting||(d?this._bodyView.updateCells(LayoutMode.SCROLL,0,f,c):(this._bodyView.offset(0,-f),c&&c())),this._topPos=b}this._focusView.scrollTo(a,b)},sort:function(a){var b=this._dataSource.fieldManager(),c=b.getColumns(),d=b.getRows(),e=b.getValues(),f=a.comparer?a.comparer:$$_defComparer;b.clearSort(),a.column&&this.$_sortView(FieldType.COLUMN,a.column,this._columnView,this._rowView,c,e,f),a.row&&this.$_sortView(FieldType.ROW,a.row,this._rowView,this._columnView,d,e,f),this._headerView.layoutContent()},$_prepareLevelCells:function(a){for(var b=[],c=this._dataSource.fieldManager().getValues(),d=c.length,e=this._rowLevelWidths.length+1,f=d>1?this._columnLevelHeights.length:this._columnLevelHeights.length+1,g=0;d>g;g++){b[g]=[];for(var h=0;e>h;h++){b[g][h]=[];for(var i=0;f>i;i++){var j=h==e-1&&i==f-1?new ValueCellElement(this):new SummaryCellElement(this,h,i);j.setValueField(c[g]),j.draw(),a.appendChild(j._element),b[g][h][i]=j}}}return b},$_disposeLevelCells:function(a,b){for(var c=b.length;c--;){for(var d=b[c].length;d--;){for(var e=b[c][d].length;e--;){var f=b[c][d][e];f.destroy(),b[c][d][e]=null}b[c][d]=null}b[c]=null}},"export":function(a){var b=_doc.createElement("div");b.className="realpivot-body";var c=this.$_prepareLevelCells(b);this._element.appendChild(b),this._exporter||(this._exporter=new GridExcelExporter);var d=a.done;a.done=function(){this.$_disposeLevelCells(b,c),d&&d()}.bind(this),this._exporter["export"](this,a,c),this._element.removeChild(b)},expandPartialGroup:function(a){var b=a.type()==FieldType.COLUMN?this._columnView:this._rowView;this.$_calcLabelPoints(),this._colsWidth=this._columnPoints[this._columnPoints.length-1],this._rowsHeight=this._rowPoints[this._rowPoints.length-1],this._bodyView.backupFocusLabel(),b.layoutContent(),this._bodyView.restoreFocusLabel(),this._columnView.setWidth(this._colsWidth),this._rowView.setHeight(this._rowsHeight),this._updateScroll(),this._bodyView.inflate(this._colsWidth,this._rowsHeight),this._bodyView.updateCells(LayoutMode.CELL,a)},$_expandToLevel:function(a,b,c){for(var d=c>b,e=a.length;e--;)a[e].expand=d,d&&a[e].hasOwnProperty("childs")&&this.$_expandToLevel(a[e].childs,b+1,c)},$_expandTree:function(a,b,c){for(var d=b[c]||null,e=a.length;e--;)if(a[e].value==d&&(a[e].expand=!0,b.length-1>c&&a[e].hasOwnProperty("childs"))){this.$_expandTree(a[e].childs,b,c+1);break}},$_collapseTree:function(a,b,c){for(var d=b[c]||null,e=a.length;e--;)if(a[e].value==d)if(c==b.length-1)a[e].expand=!1;else if(b.length-1>c&&a[e].hasOwnProperty("childs")){this.$_collapseTree(a[e].childs,b,c+1);break}},expandColumnLevel:function(a){this._columnLabels&&this._columnLabels.length>0&&(this.$_expandToLevel(this._columnLabels,0,-1==a?MAX_INT:a),this.expandPartialGroup(this._columnView.rootElement()))},expandRowLevel:function(a){this._rowLabels&&this._rowLabels.length>0&&(this.$_expandToLevel(this._rowLabels,0,-1==a?MAX_INT:a),this.expandPartialGroup(this._rowView.rootElement()))},expandColumn:function(a,b){this._columnLabels&&this._columnLabels.length>0&&(b?this.$_expandTree(this._columnLabels,a,0):this.$_collapseTree(this._columnLabels,a,0),this.expandPartialGroup(this._columnView.rootElement()))},expandRow:function(a,b){this._rowLabels&&this._rowLabels.length>0&&(b?this.$_expandTree(this._rowLabels,a,0):this.$_collapseTree(this._rowLabels,a,0),this.expandPartialGroup(this._rowView.rootElement()))},showMask:function(){this._maskView.show()},hideMask:function(){this._maskView.hide()},showProgress:function(a,b){this._progressManager.show(b,!1),this._progressMin=0,this._progressCurr=0,this._progressMax=a,this._progressManager.setProperties(this._progressMin,a,this._progressCurr)},completeProgress:function(){this._progressManager.setProperties(this._progressMin,this._progressMax,this._progressMax)},setCurrentProgress:function(a){this._progressCurr=a,this._progressManager.setProperties(this._progressMin,this._progressMax,this._progressCurr)},closeProgress:function(){this._progressManager.close()},addLayerElement:function(a){return a&&!this._layerView.contains(a)?(this._layerView.addChild(a),!0):!1},removeLayerElement:function(a){return this._layerView.contains(a)?(this._layerView.removeChild(a),!0):!1},toOffset:function(a){var b=this._element,c=b.getBoundingClientRect();return a.mouseX=a.clientX-c.left,a.mouseY=a.clientY-c.top,a},toScreen:function(a){return a.x+=this._offsetX,a.y+=this._offsetY,a},toScreenPt:function(a){a.x+=this._offsetX,a.y+=this._offsetY},isPopuped:function(){return this._setupView&&this._setupView.isActive()||this._contextMenuManager&&this._contextMenuManager.isVisible()},focus:function(){this._element.focus()},getGlobalContextMenu:function(){return this._globalContextItems.slice()},setGlobalContextMenu:function(a){a&&_isFillArray(a)?this._globalContextItems=this._defContextItems.concat({text:"-"}).concat(a.slice()):this._globalContextItems=this._defContextItems.slice()},showGlobalContextMenu:function(a,b){this._contextMenuManager.isVisible()&&this._contextMenuManager.close(),this._contextMenuManager.setItems(this._globalContextItems),this._contextMenuManager.show(a,b)},$_contextMenuHandler:function(a){var b=(a.target||a.srcElement,this._element.getBoundingClientRect()),c=a.clientX-b.left,d=a.clientY-b.top,e=this.findChildAt(c,d),f=!0;this._contextItems&&(a.preventDefault(),f&&(this._contextMenuManager.isVisible()&&this._contextMenuManager.close(),this._contextMenuManager.setItems(this._contextItems),this._contextMenuManager.show(c,d,e)))},$_aboutMenuHandler:function(){alert("RealPivot version "+RealPivotClass.getVersion())},getContextMenu:function(){return this._contextItems.slice()},setContextMenu:function(a){a?(Dom.addEventListener(this._element,"contextmenu",this.$_contextMenuHandler.bind(this),!1),this._contextItems=a.slice()):(this._contextItems=null,Dom.removeEventListener(this._element,"contextmenu",this.$_contextMenuHandler.bind(this),!1))},getClipboardValue:function(){var a=this._copyOptions.isCopyDisplayText();return this.$_getCurrentValue(a)},_fireClick:function(a){if(a instanceof LabelCellElement||a instanceof BodyCellElement){var b=a.getCellIndex();b=b?b.toProxy():null,this.fireEvent(PivotView.CLICK,a instanceof LabelCellElement?a.type():"body",b)}},_fireDblClick:function(a){if(a instanceof LabelCellElement||a instanceof BodyCellElement){var b=a.getCellIndex();b=b?b.toProxy():null,this.fireEvent(PivotView.DBL_CLICK,a instanceof LabelCellElement?a.type():"body",b)}},_fireShowTooltip:function(a,b){return a=a?a.toProxy():null,this.fireObjectEvent(PivotView.SHOW_TOOLTIP,a,b)},_fireShowLabelTooltip:function(a,b){return a=a?a.toProxy():null,this.fireObjectEvent(PivotView.SHOW_LABEL_TOOLTIP,a,b)},_fireCurrentChanged:function(a){if(a){var b=a.getCellIndex();b=b?b.toProxy():null,this.fireEvent(PivotView.CURRENT_CHANGED,b)}else this.fireEvent(PivotView.CURRENT_CHANGED,null)},_keyDownHandler:function(a){if(this._activeTool){_isMac&&a.metaKey||!_isMac&&a.ctrlKey;this._activeTool.keyDown(a.keyCode,a.ctrlKey,a.shiftKey,a.altKey)||a.preventDefault()}},_keyUpHandler:function(a){if(this._activeTool){_isMac&&a.metaKey||!_isMac&&a.ctrlKey;this._activeTool.keyUp(a.keyCode,a.ctrlKey,a.shiftKey,a.altKey)}},_keyPressHandler:function(a){this._activeTool&&this._activeTool.keyPress(a.keyCode)},_clickHandler:function(a){this._activeTool&&this._activeTool.click(this.toOffset(a))},_dblclickHandler:function(a){this._activeTool&&this._activeTool.dblclick(this.toOffset(a))},_globalMouseDownHandler:function(a){if(this._contextMenuManager.isVisible()){for(var b=a.target;b&&!b.menuItem;)b=b.parentNode;b||this._contextMenuManager.close()}},_mouseDownHandler:function(a){this._activeTool&&this._activeTool.mouseDown(this.toOffset(a))},_mouseMoveHandler:function(a){this._activeTool&&this._activeTool.mouseMove(this.toOffset(a))},_mouseUpHandler:function(a){this._activeTool&&this._activeTool.mouseUp(this.toOffset(a))},_mouseEnterHandler:function(a){this._activeTool&&this._activeTool.mouseEnter(this.toOffset(a))},_mouseLeaveHandler:function(a){this._activeTool&&this._activeTool.mouseLeave(this.toOffset(a))},_mouseOverHandler:function(a){this._activeTool&&this._activeTool.mouseLeave(this.toOffset(a))},_mouseWheelHandler:function(a){this._activeTool&&this._activeTool.mouseWheel(this.toOffset(a))&&_stopEvent(a)},_mouseScrollHandler:function(a){this._activeTool&&(a.wheelDelta=3*-a.detail,this._activeTool.mouseWheel(this.toOffset(a))&&_stopEvent(a))},_touchStartHandler:function(a){this._activeTool&&this._activeTool.touchStart(a)},_touchMoveHandler:function(a){this._activeTool&&this._activeTool.touchMove(a)},_touchEndHandler:function(a){this._activeTool&&this._activeTool.touchEnd(a)},_touchCancelHandler:function(a){this._activeTool&&this._activeTool.touchCancel(a)},_touchLeaveHandler:function(a){this._activeTool&&this._activeTool.touchEnd(a)},_focusinHandler:function(a){a.target===this._element&&this._activeTool&&this._activeTool.setFocus(!0)},_focusHandlerFireFox:function(a){a.target===this._element&&this._activeTool&&this._activeTool.setFocus(!0)},_focusoutHandler:function(a){a.target===this._element&&this._activeTool&&this._activeTool.setFocus(!1)},_blurHandler:function(a){a.target===this._element&&this._activeTool&&this._activeTool.setFocus(!1)}});PivotView.CLICK="onPivotViewClick",PivotView.DBL_CLICK="onPivotViewDblClick",PivotView.SHOW_TOOLTIP="onPivotViewTooltip",PivotView.SHOW_LABEL_TOOLTIP="onPivotViewLabelTooltip",PivotView.CURRENT_CHANGED="onPivotViewCurrentChanged";var PivotSetupField=defineClass("PivotSectionField",VisualElement,{init:function(a,b,c){this._super(),this._owner=a,this._section=b,this._dataField=c,this._name=c.name(),this.setCssClass("realpivot-setup-field"),this._removerVisible=!1,this._createElements()},destroy:function(){this._removeImg=null,this._dataField=null,this._super()},name:null,dataField:null,section:null,_createElements:function(){var a=this._dataField.getFieldHeader(),b=_doc.createElement("span");if(b.className="realpivot-setup-field",b.innerText=a,this._element.appendChild(b),this._section.type()!=FieldRole.NONE){var c=this._removeImg=_doc.createElement("div");c.className="realpivot-setup-field-remove",this._element.appendChild(c),Dom.addEventListener(c,"click",this.$_removerClick.bind(this),!1)}},$_removerClick:function(a){this.fireEvent(PivotSetupField.REMOVE_CLICK,this)}});PivotSetupField.REMOVE_CLICK="onPivotSetupFieldRemoveClick";var PivotSetupLabelField=defineClass("PivotSectionLabelField",PivotSetupField,{init:function(a,b,c){this._super(a,b,c),Dom.addEventListener(this._element,"click",this.$_click.bind(this),!1)},destroy:function(){Dom.removeEventListener(this._element,"click",this.$_click.bind(this),!1),this._super()},sortDir:SortDirection.ASCENDING,_createElements:function(){this._super(),this._sortImg=_doc.createElement("div"),this._setSortDir(this._dataField.sortDir()),this._element.appendChild(this._sortImg)},_setSortDir:function(a){this._sortImg&&(a=a==SortDirection.NONE?SortDirection.NONE:a==SortDirection.DESCENDING?SortDirection.DESCENDING:SortDirection.ASCENDING,this._sortDir=a,this._sortImg.className="realpivot-setup-field-sort-"+(a==SortDirection.ASCENDING?"asc":a==SortDirection.DESCENDING?"desc":"none"))},$_click:function(a){if(this._dataField&&!this._dataField.sortCallback()){var b=this._sortDir,c=b==SortDirection.ASCENDING?SortDirection.DESCENDING:b==SortDirection.ASCENDING;this._setSortDir(c)}}}),PivotSetupValueField=defineClass("PivotSectionLabelField",PivotSetupField,{init:function(a,b,c){this._super(a,b,c),this.setExpression(c.expression()),this._numberFormat=c.numberFormat(),this._valueAlignment=c.valueAlignment(),this.$_assignFrom(this._owner.dataProvider().fieldManager())},destroy:function(){Dom.removeEventListener(this._expressionSelect,"change",this.$_expressionChange.bind(this),!1),this._super()},expression:null,setExpression:function(a){this._expression!=a&&(this._expressionSelect&&(this._expressionSelect.value=a),this._expression=a)},columnSort:!1,rowSort:!1,columnSortDir:SortDirection.NONE,rowSortDir:SortDirection.NONE,columnSortConditions:null,rowSortConditions:null,numberFormat:null,valueAlignment:null,_createElements:function(){this._super();var a=this._configButton=_doc.createElement("input");a.type="button",a.className="realpivot-setup btn-default btn-small realpivot-setup-field-value",a.value=RealPivotMessages.setupPanel.valueConfigText,Dom.addEventListener(a,"click",this.$_configButtonClick.bind(this),!1),this._element.appendChild(a);var b=this._expressionSelect=_doc.createElement("select");b.className="realpivot-setup realpivot-setup-field-value";for(type in ValueType){var c=_doc.createElement("option");c.value=ValueType[type],c.text=RealPivotMessages.valueTypeTexts[ValueType[type]],b.appendChild(c)}Dom.addEventListener(b,"change",this.$_expressionChange.bind(this),!1),b.value=this._expression,this._element.appendChild(b)},$_assignFrom:function(a){var b=this._dataField.name(),c=a.getValueSort(FieldType.COLUMN);c&&c.fieldName==b?(this._columnSort=!0,this._columnSortDir=c.direction,this._columnSortConditions=_extend(c.conditions)):this._columnSort=!1;var c=a.getValueSort(FieldType.ROW);c&&c.fieldName==b?(this._rowSort=!0,this._rowSortDir=c.direction,this._rowSortConditions=_extend(c.conditions)):this._rowSort=!1},$_expressionChange:function(a){this._expression=a.currentTarget.value},$_configButtonClick:function(a){this._owner._showValueConfigView(this),a.preventDefault()}}),PivotSetupFilterField=defineClass("PivotSectionLabelField",PivotSetupField,{init:function(a,b,c,d){this._super(a,b,c),this._filterItem=d,d&&(this._type=d.type(),this._values=d.values(),this._criteria=d.criteria())},destroy:function(){this._filterItem=null,Dom.removeEventListener(this._filterButton,"click",this.$_filterImgClick.bind(this),!1),this._super()},filterItem:null,type:FilterType.ALL,values:null,criteria:null,_createElements:function(){this._super();var a=this._filterButton=_doc.createElement("div");a.className="realpivot-setup-field-filter",Dom.addEventListener(a,"click",this.$_filterImgClick.bind(this),!1),this._element.appendChild(a)},$_filterImgClick:function(a){this._owner._showFilterView(this)}}),PivotSetupSection=defineClass("PivotSetupSection",VisualElement,{init:function(a,b,c,d){this._super(),this._owner=a,this._type=b,this._countGet=c,this._itemGet=d,this.setCssClass(b==FieldRole.NONE?"realpivot-setup-section-merged":"realpivot-setup-section"),this._showCaret=!1,this._caretIndex=-1,this.$_createDragCaret()},destroy:function(){this._itemGet=null,this._super()},type:FieldRole.NONE,isLabelSection:function(){return this._type==FieldRole.COLUMN||this._type==FieldRole.ROW},buildItems:function(){this.$_clearItems();for(var a=this._countGet(),b=0;a>b;b++){var c=this._itemGet(b),d=this.$_createField(c);this.addChild(d)}},removeField:function(a){this.removeChild(a),a.destroy(),a=null},insertFieldAtCaret:function(a){var b=this.$_createField(a);-1==this._caretIndex?this.addChild(b):this.insertChildAt(b,this._caretIndex)},moveFieldToCaret:function(a){var b=this._childs.indexOf(a);b!=this._caretIndex&&b+1!=this._caretIndex&&this.moveChildTo(a,this._caretIndex)},showDragCaret:function(a){var b=this.$_getDragPosition(a);-1==b?this._element.appendChild(this._dragCaret):this._element.insertBefore(this._dragCaret,this._childs[b]._element),this._showCaret=!0,this._caretIndex=b},hideDragCaret:function(){this._showCaret&&(this._element.removeChild(this._dragCaret),this._showCaret=!1,this._caretIndex=-1)},checkDragAction:function(a,b){var c,d=SetupDragAction.NONE,e=SetupDragDenied.NONE;if(a.type()!=FieldRole.NONE&&this._type==FieldRole.NONE)d=SetupDragAction.REMOVE;else if(a.type()==FieldRole.NONE&&this._type!=FieldRole.NONE){var f=b.dataField(),g=f.isLabelEnable(),h=f.isValueEnable(),i=f.isFilterEnable();g&&this.isLabelSection()||h&&this._type==FieldRole.VALUE||i&&this._type==FieldRole.FILTER?(c=this._existField(f),c?(d=SetupDragAction.DENIED,e=SetupDragDenied.DUPLICATED):d=SetupDragAction.ADD):(d=SetupDragAction.DENIED,e=SetupDragDenied.DISABLED)}else this==a&&this._type!=FieldRole.NONE?d=SetupDragAction.ORDER:this.isLabelSection()&&a.isLabelSection()&&(d=SetupDragAction.MOVE);return{action:d,denyType:e,denySource:c}},$_clearItems:function(){for(var a=this._childs.length;a--;)this._childs[a].destroy(),this._childs[a]=null;this._childs=[]},$_createField:function(a){var b;switch(this._type){case FieldRole.COLUMN:case FieldRole.ROW:b=new PivotSetupLabelField(this._owner,this,a);break;case FieldRole.VALUE:b=new PivotSetupValueField(this._owner,this,a);break;case FieldRole.FILTER:b=a instanceof FilterItem?new PivotSetupFilterField(this._owner,this,a.field(),a):new PivotSetupFilterField(this._owner,this,a,null);break;default:b=new PivotSetupField(this._owner,this,a)}return b.addListener(this),b},_existField:function(a){for(var b=this._childs.length;b--;)if(this._childs[b].dataField()==a)return this._childs[b];return!1},$_getDragPosition:function(a){for(var b=0,c=0,d=this._childs.length;d>c;c++){var e=this._childs[c]._element;if(b+_int(e.offsetHeight/2)>a)return c;b+=e.offsetHeight}return-1},$_createDragCaret:function(){var a=this._dragCaret=_doc.createElement("div");a.className="realpivot-setup-field-dragcaret";
var b=_doc.createElement("div");b.className="realpivot-setup-field-dragcaret-rarrow",a.appendChild(b);var c=_doc.createElement("div");c.className="realpivot-setup-field-dragcaret-larrow",a.appendChild(c)},onPivotSetupFieldRemoveClick:function(a){this.fireEvent(PivotSetupSection.FIELD_REMOVE,a),this.removeField(a)}});PivotSetupSection.FIELD_REMOVE="onPivotSetupSectionFieldRemove";var PivotSetupFilterSection=defineClass("PivotSetupFilterSection",PivotSetupSection,{init:function(a,b,c,d,e){this._super(a,b,d,e),this._operationGet=c},destroy:function(){this._super()},filterOp:FilterOperation.AND,buildItems:function(){this._super(),this._filterOp=this._operationGet()}}),PivotSetupView=defineClass("PivotSetupView",VisualElement,{init:function(a,b){this._super(),this._container=a,this._pivotView=b,this._dataProvider=this._pivotView.dataSource(),this._columnSection=null,this._rowSection=null,this._valueSection=null,this._filterSection=null,this._fieldSection=null,this._applyButton=null,this._cancelButton=null,this._sections={},this.setCssClass("realpivot-setup"),this._css.position="absolute",this.$_createElements(),this._maskView=new MaskElement,this.addChild(this._maskView),this._filterView=new PivotFilterSetupView(this,this._dataProvider),this._valueConfigView=new PivotValueSetupView(this,this._dataProvider),this._active=!1,this._dragging=!1,this._dragAction=SetupDragAction.NONE,this._dragField=null,this._draggingSection=null,this._draggingElement=null,this._dragMouseX=0,this._dragMouseY=0,this._viewDragging=!1,Dom.addEventListener(_doc,"mousedown",this.$_dragMouseDown.bind(this),!1),Dom.addEventListener(_doc,"mousemove",this.$_dragMouseMove.bind(this),!1),Dom.addEventListener(_doc,"mouseup",this.$_dragMouseUp.bind(this),!1)},destroy:function(){this._active&&this.close(),Dom.removeEventListener(_doc,"mousedown",this.$_dragMouseDown.bind(this),!1),Dom.removeEventListener(_doc,"mousemove",this.$_dragMouseMove.bind(this),!1),Dom.removeEventListener(_doc,"mouseup",this.$_dragMouseUp.bind(this),!1),Dom.removeEventListener(this._applyButton,"click",this.$_applyButtonClick.bind(this),!1),Dom.removeEventListener(this._cancelButton,"click",this.$_cancelButtonClick.bind(this),!1),this._filterView.destroy(),this._filterView=null,this._valueConfigView.destroy(),this._valueConfigView=null,this._super()},dragField:null,dataProvider:function(){return this._dataProvider},isActive:function(){return this._active},show:function(a,b){var c=this._element;this._filterOpSelect.value=this._dataProvider.filterManager().operation();for(var d in this._sections)this._sections[d].buildItems();if(this._pivotView.showMask(),this._container.appendChild(c),!_defined(a)&&!_defined(b)){a=_max(0,_int((this._pivotView.width()-c.offsetWidth)/2)),b=_max(0,_int((this._pivotView.height()-c.offsetHeight)/2));var e=this._container.style.position;"fixed"!=e&&"absolute"!=e&&(a+=this._container.offsetLeft,b+=this._container.offsetTop)}this.setLeft(a),this.setTop(b),this._dragging=!1,this._dragAction=SetupDragAction.NONE,this._dragField=null,this._draggingSection=null,this._draggingElement=null,this._dragMouseX=0,this._dragMouseY=0,this._active=!0},close:function(){this._draggingElement&&(this._element.removeChild(this._draggingElement),this._draggingElement=null,_trace("### dragElement free"));var a=this._element;a&&a.parentNode&&(this._container.removeChild(a),this._pivotView.hideMask(),this._active=!1)},_clearSectionDragging:function(){},_showFilterView:function(a){this._filterView.show(a)},_showValueConfigView:function(a){this._valueConfigView.show(a)},_showMask:function(){this._maskView.show()},_hideMask:function(){this._maskView.hide()},$_findField:function(a){var b,c=a.parentNode;for(var d in this._sections)if(this._sections[d]._element==c){b=this._sections[d];break}if(b)for(var e=0,f=b._childs.length;f>e;e++)if(b._childs[e]._element==a)return b._childs[e];return null},$_createDragElement:function(a){var b=_doc.createElement("div");b.style.position="absolute";var c=a.cloneNode(!0),d=a.getBoundingClientRect(),e=this._element.getBoundingClientRect(),f=d.left-e.left,g=d.top-e.top;c.style.opacity=.7,c.style.width=d.width+"px",c.style.height=d.height+"px",b.appendChild(c);var h=_doc.createElement("span");return h.className="realpivot-setup-message",h.id="message",b.appendChild(h),b.style.left=f+"px",b.style.top=g+"px",b},$_createElements:function(a){var b=this._dataProvider,c=b.fieldManager(),d=b.filterManager(),e=this._element,f=_doc.createElement("div");f.className="realpivot-setup-head",f.innerText=RealPivotMessages.setupPanel.headerText,f.style.cursor="move",e.appendChild(f);var g=_doc.createElement("div");g.className="realpivot-setup-table";var h=_doc.createElement("div");h.className="realpivot-setup-row";var i=_doc.createElement("div");i.className="realpivot-setup-cell realpivot-setup-cell-all";var j=_doc.createElement("div");j.className="realpivot-setup-section-title";var k=_doc.createElement("div");k.className="realpivot-setup-section-title-field",j.appendChild(k);var l=_doc.createElement("span");l.className="realpivot-setup-section-title",l.innerText=RealPivotMessages.setupPanel.fieldSectionText,j.appendChild(l),i.appendChild(j),this._fieldSection=new PivotSetupSection(this,FieldRole.NONE,c.fieldCount.bind(c),c.getField.bind(c)),this._sections.field=this._fieldSection,this.addChild(this._fieldSection,i),h.appendChild(i);var m=_doc.createElement("div");m.className="realpivot-setup-cell realpivot-setup-cell-normal";var n=_doc.createElement("div");n.className="realpivot-setup-section-title";var o=_doc.createElement("div");o.className="realpivot-setup-section-title-column",n.appendChild(o);var p=_doc.createElement("span");p.className="realpivot-setup-section-title",p.innerText=RealPivotMessages.setupPanel.columnSectionText,n.appendChild(p),m.appendChild(n),this._columnSection=new PivotSetupSection(this,FieldRole.COLUMN,c.columnCount.bind(c),c.getColumn.bind(c)),this._sections.column=this._columnSection,this.addChild(this._columnSection,m);var q=_doc.createElement("div");q.className="realpivot-setup-section-title";var r=_doc.createElement("div");r.className="realpivot-setup-section-title-value",q.appendChild(r);var s=_doc.createElement("span");s.className="realpivot-setup-section-title",s.innerText=RealPivotMessages.setupPanel.valueSectionText,q.appendChild(s),m.appendChild(q),this._valueSection=new PivotSetupSection(this,FieldRole.VALUE,c.valueCount.bind(c),c.getValue.bind(c)),this._sections.value=this._valueSection,this.addChild(this._valueSection,m),h.appendChild(m);var t=_doc.createElement("div");t.className="realpivot-setup-cell realpivot-setup-cell-normal";var u=_doc.createElement("div");u.className="realpivot-setup-section-title";var v=_doc.createElement("div");v.className="realpivot-setup-section-title-row",u.appendChild(v);var w=_doc.createElement("span");w.className="realpivot-setup-section-title",w.innerText=RealPivotMessages.setupPanel.rowSectionText,u.appendChild(w),t.appendChild(u),this._rowSection=new PivotSetupSection(this,FieldRole.ROW,c.rowCount.bind(c),c.getRow.bind(c)),this._sections.row=this._rowSection,this.addChild(this._rowSection,t);var x=_doc.createElement("div");x.className="realpivot-setup-section-title";var y=_doc.createElement("div");y.className="realpivot-setup-section-title-filter",x.appendChild(y);var z=_doc.createElement("span");z.className="realpivot-setup-section-title",z.innerText=RealPivotMessages.setupPanel.filterSectionText,x.appendChild(z);var A=this._filterOpSelect=_doc.createElement("select");A.className="realpivot-setup realpivot-setup-field-filter";var B=_doc.createElement("option");B.value="and",B.innerText="AND",A.appendChild(B),B=_doc.createElement("option"),B.value="or",B.innerText="OR",A.appendChild(B),x.appendChild(A),t.appendChild(x),this._filterSection=new PivotSetupFilterSection(this,FieldRole.FILTER,d.operation.bind(d),d.count.bind(d),d.getFilter.bind(d)),this._sections.filter=this._filterSection,this.addChild(this._filterSection,t),h.appendChild(t),g.appendChild(h),e.appendChild(g);var C=_doc.createElement("div");C.className="realpivot-setup-foot";var D=this._applyButton=_doc.createElement("input");D.type="button",D.className="btn-primary realpivot-setup",D.value=RealPivotMessages.setupPanel.applyButtonText,Dom.addEventListener(D,"click",this.$_applyButtonClick.bind(this),!1),C.appendChild(D);var E=this._cancelButton=_doc.createElement("input");E.type="button",E.className="btn-default realpivot-setup",E.value=RealPivotMessages.setupPanel.cancelButtonText,Dom.addEventListener(E,"click",this.$_cancelButtonClick.bind(this),!1),C.appendChild(E),e.appendChild(C)},$_applySetup:function(){var a,b,c,d=[],e=[],f=[],g=[],h=null,i=null;for(a=0,b=this._columnSection.childCount();b>a;a++)c=this._columnSection.getChild(a),d.push({name:c.name(),direction:c.sortDir()});for(a=0,b=this._rowSection.childCount();b>a;a++)c=this._rowSection.getChild(a),e.push({name:c.name(),direction:c.sortDir()});for(a=0,b=this._valueSection.childCount();b>a;a++){c=this._valueSection.getChild(a);var j=c.dataField();j.setNumberFormat(c.numberFormat()),j.setValueAlignment(c.valueAlignment()),f.push({name:c.name(),expression:c.expression()}),c.isColumnSort()&&!h&&(h={},h.method=SortMethod.VALUE,h.fieldName=c.name(),h.direction=c.columnSortDir(),h.conditions=c.columnSortConditions()),c.isRowSort()&&!i&&(i={},i.method=SortMethod.VALUE,i.fieldName=c.name(),i.direction=c.rowSortDir(),i.conditions=c.rowSortConditions())}for(a=0,b=this._filterSection.childCount();b>a;a++){c=this._filterSection.getChild(a);var k=c.type(),l={name:c.name()};k==FilterType.EXPRESSION?l.criteria=c.criteria():k==FilterType.ITEMS?l.values=c.values():l.values=FilterType.ALL,g.push(l)}this._dataProvider.setPivotFields({columns:d,rows:e,values:f,filter:{operation:this._filterOpSelect.value,conditions:g},sort:{column:h,row:i}})},$_dragMouseDown:function(a){if(this._active){_trace("### dragMouseDown",a.target),a=a||window.event;var b=a.target,c=this._draggingElement;"realpivot-setup-field"!=b.className||b==c||Dom.isAncestorOf(c,b)?"realpivot-setup-head"==b.className&&(_trace("view drag start"),this._dragMouseX=a.clientX,this._dragMouseY=a.clientY,this._viewDragging=!0):(this._dragging=!0,b instanceof HTMLSpanElement&&(b=b.parentNode),this._dragField=this.$_findField(b),_trace("### dragField set "+(this._dragField?"":"[ NULL ]")),this._dragField&&(this._dragMouseX=a.clientX,this._dragMouseY=a.clientY,setTimeout(function(){this._dragging&&(this._draggingElement||(this._draggingElement=this.$_createDragElement(b),_trace("### dragElement create"),this._element.appendChild(this._draggingElement)))}.bind(this),200)),_ieOld&&a.preventDefault())}},$_dragMouseMove:function(a){if(this._active){a=a||window.event;var b=this._draggingElement;if(this._dragging&&b){_trace("### dragMouseMove");var c=b.querySelector(".realpivot-setup-field"),d=b.querySelector("#message"),e=a.clientX,f=a.clientY;this._dragAction=SetupDragAction.NONE,this._draggingSection&&(this._draggingSection.hideDragCaret(),this._draggingSection=null),this._oldDuplicateField&&this._oldDuplicateField._css.setProperty("border","");var g=this._element.getBoundingClientRect();if(pointInBound(e,f,g)){var h=e-this._dragMouseX,i=f-this._dragMouseY;this._dragMouseX=e,this._dragMouseY=f,b.style.top=b.offsetTop+i+"px",b.style.left=b.offsetLeft+h+"px";var j;for(var k in this._sections){var l=this._sections[k];if(g=l._element.getBoundingClientRect(),pointInBound(e,f,g)){j=l;break}}if(j&&this._dragField){this._draggingSection=j;var m=j.checkDragAction(this._dragField.section(),this._dragField),n=m.action,o=m.denyType,p=m.denySource,q=j.type();this._dragField.dataField();if(n==SetupDragAction.ADD&&j.isLabelSection()){var r=q==FieldRole.COLUMN?this._rowSection:this._columnSection;p=r._existField(this._dragField.dataField()),p&&(n=SetupDragAction.DENIED,o=SetupDragDenied.DUPLICATED)}if(this._dragAction=n,n==SetupDragAction.NONE||n==SetupDragAction.DENIED){c.style.setProperty("cursor","no-drop");var s=RealPivotMessages.setupPanel.fieldAddUnableText||"",t=RealPivotMessages.setupPanel.fieldDuplicateText||"";d.innerText=n==SetupDragAction.NONE?"":o==SetupDragDenied.DUPLICATED?t:s,p&&p._css.setProperty("border",n==SetupDragAction.DENIED?"1px solid red":"")}else n!=SetupDragAction.REMOVE&&l.showDragCaret(f-g.top+l._element.scrollTop),c.style.setProperty("cursor",n==SetupDragAction.ADD?"copy":"move"),d.innerText="",p&&p._css.setProperty("border","");this._oldDuplicateField=p}}this._draggingSection||(c.style.removeProperty("cursor"),d.innerText="")}this._viewDragging&&(_log("view drag move"),this.setPosition(this._left+a.clientX-this._dragMouseX,this._top+a.clientY-this._dragMouseY),this._dragMouseX=a.clientX,this._dragMouseY=a.clientY)}},$_dragMouseUp:function(a){if(this._active){a=a||window.event,_trace("### dragMouseUp"),this._draggingElement&&(this._element.removeChild(this._draggingElement),this._draggingElement=null,_trace("### dragElement free")),this._oldDuplicateField&&this._oldDuplicateField._css.setProperty("border","");var b=this._draggingSection;if(this._dragging&&b){var c=this._dragField;switch(this._dragAction){case SetupDragAction.ADD:b.insertFieldAtCaret(c.dataField());break;case SetupDragAction.REMOVE:c.section().removeField(c);break;case SetupDragAction.ORDER:b.moveFieldToCaret(c,this._caretIndex);break;case SetupDragAction.MOVE:b.insertFieldAtCaret(c.dataField()),c.section().removeField(c)}}this._draggingSection&&(_trace("    draggingSection hide"),this._draggingSection.hideDragCaret(),this._draggingSection=null),this._dragging=!1,this._dragField=null,this._viewDragging=!1}},$_applyButtonClick:function(a){try{this.$_applySetup()}finally{this.close(),a.preventDefault()}},$_cancelButtonClick:function(a){this.close(),a.preventDefault()}}),PivotFilterSetupView=defineClass("PivotFilterSetupView",VisualElement,{init:function(a,b){this._super(),this.setCssClass("realpivot-filter-setup"),this._owner=a,this._dataProvider=b,this._allCheck=null,this._exprCheck=null,this._itemCheckes=[],this.$_createElements()},destroy:function(){Dom.removeEventListener(this._allCheck,"click",this.$_allCheckClick.bind(this),!1),Dom.removeEventListener(this._exprCheck,"click",this.$_exprCheckClick.bind(this),!1),Dom.removeEventListener(this._exprText,"input",this.$_exprTextInput.bind(this),!1),Dom.removeEventListener(this._applyButton,"click",this.$_applyButtonClick.bind(this),!1),Dom.removeEventListener(this._cancelButton,"click",this.$_cancelButtonClick.bind(this),!1),this.$_clearItems(),this._super()},type:FilterType.ALL,values:null,criteria:null,$_createElements:function(){var a,b,c,d,e=RealPivotMessages.setupPanel.filter,f=this._headDiv=_doc.createElement("div");f.className="realpivot-filter-setup-head",f.innerText=e.headerText,this._element.appendChild(f);var g=_doc.createElement("div");g.className="realpivot-filter-setup-body";var h=_doc.createElement("div");h.className="realpivot-filter-setup-box",a=_doc.createElement("div"),a.className="realpivot-filter-setup-item",c=this._allCheck=_doc.createElement("input"),c.type="checkbox",c.value="all",Dom.addEventListener(c,"click",this.$_allCheckClick.bind(this),!1),c.className="realpivot-filter-setup-checkbox",a.appendChild(c),b=_doc.createElement("span"),b.className="realpivot-filter-setup-item",b.innerText=e.allText,a.appendChild(b),h.appendChild(a),g.appendChild(h);var i=_doc.createElement("div");i.className="realpivot-filter-setup-box",a=_doc.createElement("div"),c=this._exprCheck=_doc.createElement("input"),c.type="checkbox",c.value="expr",Dom.addEventListener(c,"click",this.$_exprCheckClick.bind(this),!1),c.className="realpivot-filter-setup-checkbox",a.appendChild(c),d=this._exprText=_doc.createElement("input"),d.type="text",d.placeholder=e.expressionPlaceholder||"ex) value > 0",d.className="realpivot-filter-setup-textbox",Dom.addEventListener(d,"input",this.$_exprTextInput.bind(this),!1),a.appendChild(d),a.className="realpivot-filter-setup-item",i.appendChild(a),g.appendChild(i);var j=this._itemList=_doc.createElement("div");j.className="realpivot-filter-setup-list-box",g.appendChild(j),this._element.appendChild(g);var k=_doc.createElement("div");k.className="realpivot-filter-setup-foot";var l=this._applyButton=_doc.createElement("input");l.type="button",l.className="btn-primary realpivot-setup",l.value=e.applyButtonText,Dom.addEventListener(l,"click",this.$_applyButtonClick.bind(this),!1),k.appendChild(l);var m=this._cancelButton=_doc.createElement("input");m.type="button",m.className="btn-default realpivot-setup",m.value=e.cancelButtonText,Dom.addEventListener(m,"click",this.$_cancelButtonClick.bind(this),!1),k.appendChild(m),this._element.appendChild(k)},$_clearItems:function(){for(var a=this._itemCheckes.length;a--;)Dom.removeEventListener(this._itemCheckes[a],"click",this.$_listCheckClick.bind(this),!1);this._itemCheckes=[];for(var b=this._itemList;b.firstChild;)b.removeChild(b.firstChild)},$_clearItemCheck:function(){for(var a=this._itemCheckes.length;a--;)this._itemCheckes[a].checked=!1},$_buildItems:function(a,b){var c,d,e,f=this._itemList,g=a.values(),h=this._dataProvider.getDistinctValues(a.dataField(),[],[],!1,SortDirection.ASCENDING),i=h.length;if(i>0)for(var j=0;i>j;j++)c=_doc.createElement("div"),c.className="realpivot-filter-setup-item",d=_doc.createElement("input"),d.type="checkbox",d.value=h[j].value,d.checked=b&&g.indexOf(h[j].value)>-1,Dom.addEventListener(d,"click",this.$_listCheckClick.bind(this),!1),d.className="realpivot-filter-setup-checkbox",c.appendChild(d),this._itemCheckes.push(d),e=_doc.createElement("span"),e.className="realpivot-filter-setup-item",e.innerText=h[j].label||h[j].value,c.appendChild(e),f.appendChild(c)},$_assignValue:function(a){this._headDiv.innerText=RealPivotMessages.setupPanel.filter.headerText+" ("+a.dataField().getFieldHeader()+")";var b=a.type();this._allCheck.checked=!1,this._exprCheck.checked=!1,this._exprText.value="",b==FilterType.ALL?this._allCheck.checked=!0:b==FilterType.EXPRESSION&&(this._exprCheck.checked=!0,this._exprText.value=a.criteria()),this.$_buildItems(a,b==FilterType.ITEMS)},show:function(a){this._owner._showMask(),this._field=a,this.$_clearItems(),this.$_assignValue(a),this._owner._element.appendChild(this._element)},close:function(){this._owner._element.removeChild(this._element),this._owner._hideMask()},$_applyFilter:function(){var a=this._field,b=a.dataField().getDataType();if(this._allCheck.checked)a.setType(FilterType.ALL);else if(this._exprCheck.checked)a.setType(FilterType.EXPRESSION),a.setCriteria(this._exprText.value);else{for(var c=[],d=0,e=this._itemCheckes.length;e>d;d++){var f=this._itemCheckes[d];f.checked&&c.push("number"==b||"datetime"==b?parseFloat(f.value):f.value)}c.length>0?(a.setType(FilterType.ITEMS),a.setValues(c)):a.setType(FilterType.ALL)}},$_allCheckClick:function(a){this._exprCheck.checked=!1,this.$_clearItemCheck()},$_exprCheckClick:function(a){this._allCheck.checked=!1,this.$_clearItemCheck()},$_exprTextInput:function(a){var b=a.target.value;this._allCheck.checked=!b,this._exprCheck.checked=b,this.$_clearItemCheck()},$_listCheckClick:function(a){this._allCheck.checked=!1,this._exprCheck.checked=!1},$_applyButtonClick:function(a){try{this.$_applyFilter()}finally{this.close(),a.preventDefault()}},$_cancelButtonClick:function(a){this.close(),a.preventDefault()}}),PivotValueSetupView=defineClass("PivotSortSetupView",VisualElement,{init:function(a,b){this._super(),this.setCssClass("realpivot-value-setup"),this._owner=a,this._dataProvider=b,this._fieldManager=b.fieldManager(),this._selectes=[],this.$_createElements()},destroy:function(){Dom.removeEventListener(this._colSelect,"change",this.$_colSelectChange.bind(this),!1),Dom.removeEventListener(this._rowSelect,"change",this.$_rowSelectChange.bind(this),!1),Dom.removeEventListener(this._applyButton,"click",this.$_applyButtonClick.bind(this),!1),Dom.removeEventListener(this._cancelButton,"click",this.$_cancelButtonClick.bind(this),!1),this.$_removeItems(),this._dataProvider=null,this._fieldManager=null,this._owner=null,this._super()},$_createElements:function(){var a,b,c,d,e,f=RealPivotMessages.setupPanel.value,g=this._headDiv=_doc.createElement("div");g.className="realpivot-value-setup-head",g.innerText=f.headerText,this._element.appendChild(g);var h=_doc.createElement("div");h.className="realpivot-value-setup-body",d=_doc.createElement("div"),d.className="realpivot-value-setup-group",a=_doc.createElement("span"),a.className="realpivot-setup realpivot-value-setup-group",a.innerText=f.columnGroupText,d.appendChild(a),this._colSelect=b=_doc.createElement("select"),b.className="realpivot-setup",Dom.createOptions(b,[!1,!0],[f.selectNoConfigText,f.selectConfigText]),Dom.addEventListener(b,"change",this.$_colSelectChange.bind(this),!1),d.appendChild(b),this._colList=e=_doc.createElement("div"),e.className="realpivot-value-setup-group-body",e.style.display="none",d.appendChild(e),h.appendChild(d),d=_doc.createElement("div"),d.className="realpivot-value-setup-group",a=_doc.createElement("span"),a.className="realpivot-setup realpivot-value-setup-group",a.innerText=f.rowGroupText,d.appendChild(a),this._rowSelect=b=_doc.createElement("select"),b.className="realpivot-setup",Dom.createOptions(b,[!1,!0],[f.selectNoConfigText,f.selectConfigText]),b.value=!1,Dom.addEventListener(b,"change",this.$_rowSelectChange.bind(this),!1),d.appendChild(b),this._rowList=e=_doc.createElement("div"),e.className="realpivot-value-setup-group-body",e.style.display="none",d.appendChild(e),h.appendChild(d),d=_doc.createElement("div"),d.className="realpivot-value-setup-group",a=_doc.createElement("span"),a.className="realpivot-setup realpivot-value-setup-group",a.innerText=f.formatGroupText,d.appendChild(a),b=this._formatSelect=_doc.createElement("select"),b.className="realpivot-setup";for(var i=RealPivotMessages.numberFormatList,j=0,k=i.length;k>j;j++)c=_doc.createElement("option"),i[j].value&&(c.value=i[j].value),c.text=i[j].labelText,b.appendChild(c);d.appendChild(b),h.appendChild(d),d=_doc.createElement("div"),d.className="realpivot-value-setup-group",a=_doc.createElement("span"),a.className="realpivot-setup realpivot-value-setup-group",a.innerText=f.alignmentGroupText,d.appendChild(a),b=this._alignmentSelect=_doc.createElement("select"),b.className="realpivot-setup";var l=RealPivotMessages.alignmentList;for(j=0,k=l.length;k>j;j++)c=_doc.createElement("option"),c.value=l[j].value,c.text=l[j].labelText,b.appendChild(c);d.appendChild(b),h.appendChild(d),this._element.appendChild(h);var m=_doc.createElement("div");m.className="realpivot-value-setup-foot";var n=this._applyButton=_doc.createElement("input");n.type="button",n.className="btn-primary realpivot-setup",n.value=RealPivotMessages.setupPanel.applyButtonText,Dom.addEventListener(n,"click",this.$_applyButtonClick.bind(this),!1),m.appendChild(n);var o=this._cancelButton=_doc.createElement("input");o.type="button",o.className="btn-default realpivot-setup",o.value=RealPivotMessages.setupPanel.cancelButtonText,Dom.addEventListener(o,"click",this.$_cancelButtonClick.bind(this),!1),m.appendChild(o),this._element.appendChild(m)},show:function(a){this._owner._showMask(),this._field=a,this.$_assignValue(a),this._owner._element.appendChild(this._element)},close:function(){this._owner._element.removeChild(this._element),this._owner._hideMask()},$_initSelectOptions:function(a){for(var b=a.options.length;--b>1;)a.remove(b);if(0==a.options.length){var c=RealPivotMessages.setupPanel.value;Dom.createOptions(a,a.$$parent?["",PivotValueSetupView.SUM_OPTION_VALUE]:[PivotValueSetupView.SUM_OPTION_VALUE],a.$$parent?[c.emptyUpperOptionText,c.summaryOptionText]:[c.summaryOptionText])}},$_buildSelectOptions:function(a,b,c,d){for(var e,f=this._dataProvider.getDistinctValues(b,c,d,!1,SortDirection.ASCENDING),g=0,h=f.length;h>g;g++)e=_doc.createElement("option"),e.value=f[g].value,e.text=f[g].label||f[g].value,a.appendChild(e)},$_removeItems:function(){for(var a=this._selectes.length;a--;)Dom.removeEventListener(this._selectes[a],"change",this.$_valueSelectChange.bind(this),!1),this._selectes[a]=null;this._selectes=[],Dom.clearChildren(this._colList),Dom.clearChildren(this._rowList)},$_buildItems:function(a,b,c,d){var e,f,g,h,i,j=[],k=RealPivotMessages.setupPanel.value;e=_doc.createElement("div"),e.className="realpivot-value-setup-item",f=_doc.createElement("span"),f.className="realpivot-value-setup-item",f.innerText=k.sortDirectionText,e.appendChild(f),g=_doc.createElement("select"),g.className="realpivot-setup realpivot-value-setup-item",Dom.createOptions(g,[SortDirection.ASCENDING,SortDirection.DESCENDING],[k.sortAscendingText,k.sortDescendingText]),this._selectes.push(g);var l=a==this._colList;l?this._colSortSelect=g:this._rowSortSelect=g,e.appendChild(g),a.appendChild(e),l?this._colFirstSelect=null:this._rowFirstSelect=null;for(var m=0,n=b.length;n>m;m++)e=_doc.createElement("div"),e.className="realpivot-value-setup-item",i=b[m].dataField(),f=_doc.createElement("span"),f.className="realpivot-value-setup-item",f.innerText=i.getFieldHeader(),e.appendChild(f),g=_doc.createElement("select"),g.className="realpivot-setup realpivot-value-setup-item",g.$$field=i,g.$$parent=h,Dom.addEventListener(g,"change",this.$_valueSelectChange.bind(this),!1),this._selectes.push(g),this.$_initSelectOptions(g),c&&c[m]?(this.$_buildSelectOptions(g,i,j,c),g.value=c[m]):0==m&&(this.$_buildSelectOptions(g,i,j,[]),g.value=PivotValueSetupView.SUM_OPTION_VALUE),0==m&&(l?this._colFirstSelect=g:this._rowFirstSelect=g),h=g,e.appendChild(g),a.appendChild(e),j.push(i)},$_assignValue:function(a){var b=a.dataField(),c=this._owner._columnSection._childs,d=this._owner._rowSection._childs;if(this._headDiv.innerText=RealPivotMessages.setupPanel.value.headerText+" ("+b.getFieldHeader()+")",this.$_removeItems(),a.isColumnSort()){this._colSelect.value="true";for(var e=a.columnSortConditions(),f=[],g=0,h=e.length;h>g;g++)f.push(e[g].value);this.$_buildItems(this._colList,d,f),this._colSortSelect.value=a.columnSortDir()}else this._colSelect.value="false",this.$_buildItems(this._colList,d,null);if(Dom.fireEvent(this._colSelect,"change"),a.isRowSort()){this._rowSelect.value="true";for(var e=a.rowSortConditions(),f=[],g=0,h=e.length;h>g;g++)f.push(e[g].value);this.$_buildItems(this._rowList,c,f),this._rowSortSelect.value=a.rowSortDir()}else this._rowSelect.value="false",this.$_buildItems(this._rowList,c,null);Dom.fireEvent(this._rowSelect,"change");var i=a.numberFormat();i&&(this._formatSelect.value=i,this._formatSelect.value||(Dom.createOptions(this._formatSelect,[i],[RealPivotMessages.userDefinedFormatText+" "+i]),this._formatSelect.value=i));var j=a.valueAlignment();this._alignmentSelect.value=j},$_makeCondition:function(a){for(var b=this._selectes.indexOf(a),c=[],d=b,e=this._selectes.length;e>d;d++){var a=this._selectes[d];if(""==a.value||a.value==PivotValueSetupView.SUM_OPTION_VALUE||d!=b&&a.$$parent!=this._selectes[d-1])break;var f={};f.name=a.$$field.name(),f.value=a.value,c.push(f)}return c},$_applyValueConfig:function(){var a=this._field,b="true"==this._colSelect.value&&this._colSortSelect;if(a.setColumnSort(b),b){a.setColumnSortDir(this._colSortSelect.value);var c=this.$_makeCondition(this._colFirstSelect);a.setColumnSortConditions(c)}if(b="true"==this._rowSelect.value&&this._rowFirstSelect,a.setRowSort(b),b){a.setRowSortDir(this._rowSortSelect.value);var c=this.$_makeCondition(this._rowFirstSelect);a.setRowSortConditions(c)}var d=this._formatSelect.value;d=d?d:null,a.setNumberFormat(d);var e=this._alignmentSelect.value;a.setValueAlignment(e)},$_colSelectChange:function(a){var b="true"==this._colSelect.value;this._colList.style.display=b?"":"none",this._colSort=b},$_rowSelectChange:function(a){var b="true"==this._rowSelect.value;this._rowList.style.display=b?"":"none",this._rowSort=b},$_valueSelectChange:function(a){var b,c=a.currentTarget,d=this._selectes.indexOf(c);if(d<this._selectes.length-1&&this._selectes[d+1].$$parent==c&&(b=this._selectes[d+1]),b){var e=c.value&&c.value!=PivotValueSetupView.SUM_OPTION_VALUE?PivotValueSetupView.SUM_OPTION_VALUE:"";if(b.value!=e&&(b.value=e,Dom.fireEvent(b,"change")),this.$_initSelectOptions(b),c.value&&c.value!=PivotValueSetupView.SUM_OPTION_VALUE){for(var f=[],g=[];c;)f.splice(0,0,c.$$field),g.splice(0,0,c.value),c=c.$$parent;this.$_buildSelectOptions(b,b.$$field,f,g)}}},$_applyButtonClick:function(a){try{this.$_applyValueConfig()}finally{this.close(),a.preventDefault()}},$_cancelButtonClick:function(a){this.close(),a.preventDefault()}},{SUM_OPTION_VALUE:"$$$SUM"}),ExportCellItem=function(a){this.colIndex=0,this.rowIndex=0,this.colSpan=0,this.rowSpan=0,this.valueType="s",this.cell=a},ExportCellArray=defineClass("ExportCellArray",null,{init:function(a,b){this._super(),this._grid=a,this._columnCells=[],this._rowCells=[],this._dataCells=[],this.$_parse(a,b)},destroy:function(){this._grid=null,this._rows=null,this._super()},grid:function(){return this._grid},colCount:function(){return this._columnCells.length&&this._columnCells[0].length},rowHeaderCount:function(){return this._rowCells.length&&this._rowCells[0].length},columnHeaderCount:function(){return this._columnCells.length},dataRowCount:function(){return this._dataCells.length},getColumnHeader:function(a,b){return!this._columnCells[a],this._columnCells[a][b]},getRowHeader:function(a,b){return!this._rowCells[a],this._rowCells[a][b]},getCell:function(a,b){return!this._dataCells[a],this._dataCells[a][b]},setColumnHeader:function(a,b,c){!this._columnCells[a],this._columnCells[a][b]=c},setRowHeader:function(a,b,c){!this._rowCells[a],this._rowCells[a][b]=c},setCell:function(a,b,c){!this._dataCells[a],this._dataCells[a][b]=c},$_parse:function(a,b){var c,d=(a.modelManager(),a.getColumnDepth()),e=a.getRowDepth(),f=b?a.getLeafRowCount():a.getVisibleRowCount(),g=b?a.getLeafColumnCount():a.getVisibleColumnCount();for(this._columnCells=[],c=d;c--;)this._columnCells.push([]);for(this._rowCells=[],this._dataCells=[],c=f;c--;)this._rowCells.push([]),this._dataCells.push([]);this.$_parseColumnCells(a,this._columnCells,a.valueLabelVisible()?d-1:d,b),this.$_parseRowCells(a,this._rowCells,e,b),this.$_parseDataCells(a,this._dataCells,f,g,b)},$_parseColumnCells:function(a,b,c,d){for(var e=a.columnView().rootElement().getLowers(),f=0,g=0,h=e.length;h>g;g++){var i=e[g];f+=this.$_addColumnGroup(b,i,f,0,c,d)}},$_parseRowCells:function(a,b,c,d){for(var e=a.rowView().rootElement().getLowers(),f=0,g=0,h=e.length;h>g;g++){var i=e[g];f+=this.$_addRowGroup(b,i,0,f,c,d)}},$_parseDataCells:function(a,b,c,d,e){for(var f,g,h,i,j,k,l,m,n,o=r=0,p=this._columnCells,q=this._rowCells,s=a.modelManager();r<c;){if(f=g=0,h=q[o][q[o].length-1].cell,j=h.treePath(),m=s.getRow(j),e||h.isVisible()){for(;d>g;)i=p[p.length-1][f].cell,k=i.treePath(),l=i.valueField().name(),n=m.getCell(k,l),(e||i.isVisible())&&(this.$_addCell(b,g,r,1,1,n),g++),f++;r++}o++}},$_addCell:function(a,b,c,d,e,f){var g,h,i;for(g=0;e>g;g++)for(h=0;d>h;h++)i=new ExportCellItem(f),i.colIndex=h,i.colSpan=d,i.rowIndex=g,i.rowSpan=e,a[c+g][b+h]=i},$_addColumnGroup:function(a,b,c,d,e,f){var g=0,h=b instanceof LabelSummaryCellElement?e-b.level():1,i=b instanceof GroupCellElement;if(f||!i||b.expanded)for(var j,k=i&&b.expanded(),l=i&&b.isSummaryVisible(),m=f?b.getLowers():b.getVisibleLowers(!0,!0),n=c,o=d+h,p=0,q=m.length;q>p;p++){var r=m[p],s=r instanceof LabelSummaryCellElement,t=!1;if(i&&(t=f?!l&&k&&s:k?!l&&s:!s),!t)if(r.hasLower())j=this.$_addColumnGroup(a,r,n,o,e,f),n+=j,g+=j;else{var u=r instanceof LabelSummaryCellElement&&!r.isValueLabel()?e-o:1;this.$_addCell(a,n,o,1,u,r),g++,n++}}return 0==g&&(g=1),this.$_addCell(a,c,d,g,h,b),g},$_addRowGroup:function(a,b,c,d,e,f){var g=0,h=b instanceof LabelSummaryCellElement?e-b.level():1,i=b instanceof GroupCellElement;if(f||!i||b.expanded)for(var j,k=i&&b.expanded(),l=i&&b.isSummaryVisible(),m=f?b.getLowers():b.getVisibleLowers(!0,!0),n=d,o=c+h,p=0,q=m.length;q>p;p++){var r=m[p],s=r instanceof LabelSummaryCellElement,t=!1;
if(i&&(t=f?!l&&k&&s:k?!l&&s:!s),!t)if(r.hasLower())j=this.$_addRowGroup(a,r,o,n,e,f),n+=j,g+=j;else{var u=r instanceof LabelSummaryCellElement&&!r.isValueLabel()?e-o:1;this.$_addCell(a,o,n,u,1,m[p]),g++,n++}}return 0==g&&(g=1),this.$_addCell(a,c,d,h,g,b),g}}),PIXELS_PER_CHAR=7,DocumentTitle=defineClass("DocumentTitle",null,{init:function(a){"string"==typeof a?(this._message=a,this._visible=!0,this._spaceTop=0,this._spaceBottom=0,this._height=-1):"object"==typeof a&&(this._message=a.message,this._visible=a.hasOwnProperty("visible")?a.visible:!0,this._spaceTop=a.spaceTop?isNaN(parseInt(a.spaceTop))?0:parseInt(a.spaceTop):0,this._spaceBottom=a.spaceBottom?isNaN(parseInt(a.spaceBottom))?0:parseInt(a.spaceBottom):0,this._height=a.height?isNaN(parseInt(a.height))?-1:parseInt(a.height):-1)},proxy:function(){var a={message:this._message,visible:this._visible};return this._styles&&(a.styles=this._styles.toProxy()),a},message:null,visible:!0,spaceTop:0,spaceBottom:0,height:-1}),GridExportOptions=defineClass("GridExportOptions",null,{init:function(a){this._super(),this._datetimeWriter=null,a&&this.assign(a)},target:"local",url:void 0,fileName:null,expandAll:!0,documentTitle:null,documentSubtitle:null,documentTail:null,numberFormat:void 0,showProgress:!1,progressMessage:null,applyCssStyle:!0,includeTitle:!1,done:null,start:0,count:-1,setFileName:function(a){a=_trim(a),a&&a.indexOf(".")<0&&(a+=".xlsx"),this._fileName=a},setNumberFormat:function(a){a!=this._numberFormat&&(this._numberFormat=a)},setDocumentTitle:function(a){this._documentTitle=a?new DocumentTitle(a):null},setDocumentSubtitle:function(a){this._documentSubtitle=a?new DocumentTitle(a):null},setDocumentTail:function(a){this._documentTail=a?new DocumentTitle(a):null}}),GridExcelExporter=defineClass("GridExcelExporter",null,{init:function(){this._super()},destroy:function(){this._super()},"export":function(a,b,c){function d(a){var c=(new Date).getTime();f=c-f,_trace("E X C E L: buildBook "+f),f=c;var d=e.book.createParts();c=(new Date).getTime(),f=c-f,_trace("E X C E L: createParts "+f),f=c;var g=[];for(var h in d)g.push({key:h,body:d[h]});a.$_export(g,b),c=(new Date).getTime(),f=c-f,_trace("E X C E L: zip "+f),f=c,b._done&&"function"==typeof b._done&&b._done(),e.options&&(e.options.destroy(),e.options=null),e.book&&(e.book.destroy(),e.book=null),e.colArr&&(e.colArr.destroy(),e.colArr=null),e=null}if(a){b=b instanceof GridExportOptions?b:new GridExportOptions(b);var e={grid:a,levelCells:c,book:new ExcelWorkbook,options:b,colArr:new ExportCellArray(a,b.isExpandAll()),numberFormatId:0,textFormatId:49,showProgress:b.isShowProgress(),progressMessage:b.progressMessage()||"Exporting...",progressMax:0,prepareProgress:10,setProgress:function(b){a.setCurrentProgress(b+this.prepareProgress)}};e.colCount=e.colArr.colCount()+e.colArr.rowHeaderCount(),this._cssStyles={};var f=(new Date).getTime(),g=this;this.$_buildBook(e,function(){d(g)})}},$_buildBook:function(a,b){var c=a.grid;a.start=a.options.start()>0?a.options.start():0;var d=a.options.count(),e=a.colArr.dataRowCount();a.count>0?a.start+d>e?e-a.start:d:e-a.start,a.last=a.start+e,this.$_prepareFormats(a),this.$_prepareStyles(a),this.$_buildColumns(a);for(var f=0,g=0,h=0;h<a.colArr.columnHeaderCount();h++)for(var i=0;i<a.colArr.colCount();i++){a.colArr.getColumnHeader(h,i)}if(f+=this.$_buildDocumentTitle(a,f,g),f+=this.$_buildHeader(a,f,g),a.showProgress){a.progressStep=Math.max(_int(e/10),1),c.showProgress(e+a.prepareProgress,a.progressMessage);var j=this;f+=this.$_buildItemsAsync(a,f,g,function(){f=a.row,f+=j.$_buildDocumentTail(a,f,g),c.completeProgress(),setTimeout(function(){c.closeProgress()}),b()})}else f+=this.$_buildItems(a,f,g),f+=this.$_buildDocumentTail(a,f,g),b()},$_prepareFormats:function(a){var b=a.options,c=a.book,d=b.numberFormat();"number"==typeof d||_int(d)>0?a.numberFormatId=_int(d):d&&(a.numberFormatId=c.addNumberFormat(ExcelFormatConverter.convertNumberFormat(d)))},$_prepareStyles:function(a){var b=a.book,c=a.grid,d=c.dataSource().fieldManager().getValues();if(this._bodyStyles={},a.options.isApplyCssStyle()&&a.levelCells)for(var e=a.levelCells,f=0;f<d.length;f++)for(var g=d[f],h=this._bodyStyles[g.name()]=[],i=0;i<e[f].length;i++){var j=e[f][i];h[i]=[];for(var k=0;k<j.length;k++)h[i][k]=this.$_addStyle(b,j[k],!0,g.exportFormat()||g.numberFormat(),g.prefix(),g.suffix())}},$_createStyles:function(a,b,c,d,e,f){var g;if(d&&d.length>0&&(g=ExcelFormatConverter.convertNumberFormat(d)),g){e&&(g='"'+e+'"'+g),f&&(g=g+'"'+f+'"');var h=a.addNumberFormat(g)}var i=h||c?new ExcelStyle:null;if(h&&(i.formatId=h),c){var j=new ExcelFill,k=getComputedStyle(b._element),l=k.backgroundImage,m="linear-gradient(",n=l.indexOf(m);if(n>-1){j.gradient="linear";var o,p,q=PivotHelper.splitEscape(l.slice(n+m.length,l.length-1));q.length>2?(o=new Color(q[1]),p=new Color(q[2]),deg=parseInt(q[0])):(o=new Color(q[0]),p=new Color(q[1]),deg=180),j.color=o.toColorHex(),j.color2=p.toColorHex(),j.tint=1-o._a,j.degree=deg+270+""}else{j.patternType="solid";var r=new Color(k.backgroundColor);j.color=r.toColorHex(),j.tint=1-r._a}a.addFill(j);var s=new ExcelBorder;s.right=new Pen(k.borderRightColor,k.borderRightWidth),s.bottom=new Pen(k.borderBottomColor,k.borderBottomWidth),s.left=new Pen(k.borderLeftColor,k.borderLeftWidth),s.top=new Pen(k.borderTopColor,k.borderTopWidth),a.addBorder(s),k=b._span?getComputedStyle(b._span):k,font=new ExcelFont,font.name=k.fontFamily;var t=parseInt(k.fontSize);if(k.fontSize.indexOf("pt")>0?t=_round(t/.75):k.fontSize.indexOf("em")>0?t=_round(12*t/.75):k.fontSize.indexOf("%")>0&&(t=_round(t/100*12/.75)),font.size=72*t/96,font.color=new Color(k.color).toColorHex(),font.bold="bold"==k.fontWeight||parseInt(k.fontWeight)>600,font.italic="italic"==k.fontStyle,a.addFont(font),i.fill=j,i.border=s,i.font=font,"flex"==k.display){switch(k.justifyContent){case"center":i.horzAlign=ExcelStyle.ALIGN_CENTER;break;case"flex-end":i.horzAlign=ExcelStyle.ALIGN_FAR;break;default:i.horzAlign=ExcelStyle.ALIGN_NEAR}switch(k.alignItems){case"center":i.vertAlign=ExcelStyle.VALIGN_CENTER;break;case"flex-end":i.vertAlign=ExcelStyle.VALIGN_FAR;break;default:i.vertAlign=ExcelStyle.VALIGN_NEAR}}else{switch(k.textAlign){case"center":i.horzAlign=ExcelStyle.ALIGN_CENTER;break;case"right":i.horzAlign=ExcelStyle.ALIGN_FAR;break;default:i.horzAlign=ExcelStyle.ALIGN_NEAR}switch(k.verticalAlign){case"middle":i.vertAlign=ExcelStyle.VALIGN_CENTER;break;case"bottom":i.vertAlign=ExcelStyle.VALIGN_FAR;break;default:i.vertAlign=ExcelStyle.VALIGN_NEAR}}}return i},$_addStyle:function(a,b,c,d,e,f){var g=this._cssStyles,h="";c&&(h+=b.cssClass()),h+="="+d+"="+e+"="+f;var i;return g[h]?i=g[h]:(i=this.$_createStyles(a,b,c,d,e,f),g[h]=i,a.addStyle(i)),i},$_buildColumns:function(a){var b,c,d=a.grid,e=(a.options,a.book,a.colArr),f=1,g=[],h=e.rowHeaderCount();for(b=0;h>b;b++)c=new ExcelColumn,c.index=f++,c.width=_round(d.rowLevelWidth(b)/PIXELS_PER_CHAR),g.push(c);var i=e.colCount(),j=e.columnHeaderCount()-1;for(b=0;i>b;b++){var k=e.getColumnHeader(j,b);c=new ExcelColumn,c.index=f++,c.width=_round(k.cell.width()/PIXELS_PER_CHAR),g.push(c)}a.book.sheet().setColumns(g)},$_buildDocumentTitle:function(a,b,c){var d,e,f=(a.grid,a.options),g=a.book,h=g.sheet(),i=a.colCount,j=b;if((e=f.documentTitle())&&e._visible){j+=e.spaceTop();var k=e.message();h.addText(j,c,k,null,e.height()),h.addMerge(j,c,1,i);for(var l=1;i>l;l++)h.addBlank(j,c+l,d);j++,j+=e.spaceBottom()}if((e=f.documentSubtitle())&&e._visible){j+=e.spaceTop();var k=e.message();h.addText(j,c,k,null,e.height()),h.addMerge(j,c,1,i);for(var l=1;i>l;l++)h.addBlank(j,c+l,d);j++,j+=e.spaceBottom()}return j-b},$_buildDocumentTail:function(a,b,c){var d,e,f=(a.grid,a.options),g=a.book,h=g.sheet(),i=a.colCount,j=b;if((e=f.documentTail())&&e._visible){j+=e.spaceTop();var k=e.message();h.addText(j,c,k,d,e.height()),h.addMerge(j,c,1,i);for(var l=1;i>l;l++)h.addBlank(j,c+l,d);j++,j+=e.spaceBottom()}return j-b},$_buildHeader:function(a,b,c){var d,e,f,g,h,i,j,k,l=a.grid,m=a.book,n=m.sheet(),o=a.colArr,p=o.colCount(),q=o.columnHeaderCount(),r=o.rowHeaderCount(),s=a.options.isApplyCssStyle(),t=a.options.isIncludeTitle(),u=l.headerView(),v=u.getTitleCell()||u.getGridRowHeaderCell(0),w=this.$_addStyle(m,v,s);if(w.vertAlign=ExcelStyle.VALIGN_CENTER,t){var x=l.dataSource().fieldManager(),y=x.getValues(),z=x.getRows(),A=x.getColumns(),B=z.length,C=x.getFieldsText(y,!0),D=x.getFieldsText(A),E=x.getFieldsText(z);if(n.addText(b,c,C,w),B>1){for(d=1;B>d;d++)n.addBlank(b,c+d,w);n.addMerge(b,c,1,c+B)}var F=c+B;if(n.addText(b,F,D,w),p>1){for(d=1;p>d;d++)n.addBlank(b,F+d,w);n.addMerge(b,F,1,p)}b++}if(u.formType()==HeaderFormType.GRID){var G=u.getGridRowHeaderCells();for(j=this.$_addStyle(m,G[0],s),d=0;q>d;d++)for(e=0;r>e;e++)0==d?(n.addText(b,c+e,G[e].text(),j),q>1&&n.addMerge(b,c+e,q,1)):n.addBlank(b+d,c+e,j)}else{for(d=0;q>d;d++)for(e=0;r>e;e++)t&&0==d&&0==e?n.addText(b,c,E,w):n.addBlank(b+d,c+e,w);(q>1||r>1)&&n.addMerge(b,c,q,r)}for(c+=r,d=0;q>d;d++)for(f=b+d,e=0;p>e;e++)h=o.getColumnHeader(d,e),i=h.cell,j=this.$_addStyle(m,i,s),g=e+c,h.colIndex>0||h.rowIndex>0?n.addBlank(f,g,j):(k=PivotHelper.removeTags(i.text()),k&&k.match($_linereg)&&(j.wrapText=!0),n.addText(f,g,k,j),(h.rowSpan>1||h.colSpan>1)&&n.addMerge(f,g,h.rowSpan,h.colSpan));return q+(t?1:0)},$_buildRow:function(a,b,c,d){var e,f,g,h,i,j,k,l,m=(a.grid,a.book),n=m.sheet(),o=a.colArr,p=o.colCount(),q=o.rowHeaderCount(),r=a.options.isApplyCssStyle();for(e=0;q>e;e++)if(g=o.getRowHeader(d,e),h=g.cell,f=e+c,j=this.$_addStyle(m,h,r),g.colIndex>0||g.rowIndex>0)n.addBlank(b,f,j);else{var l=h.text();l&&l.match($_linereg)&&(j.wrapText=!0),n.addText(b,f,l,j),(g.rowSpan>1||g.colSpan>1)&&n.addMerge(b,f,g.rowSpan,g.colSpan)}for(c+=q,e=0;p>e;e++)if(g=o.getCell(d,e),h=g.cell,i=h.field(),j=this._bodyStyles[i.name()][h.rowLevel()][h.level()],f=e+c,g.colIndex>0||g.rowIndex>0)n.addBlank(b,f,j);else if(k=h.getValue(),"number"==i.getDataType())n.addNumber(b,f,k,j);else{var l=k+"";n.addText(b,f,l,j)}return 1},$_buildItems:function(a,b,c){for(var d=b,e=a.start;e<a.last;e++)d+=this.$_buildRow(a,d,c,e);return d-b},$_buildItemsAsync:function(a,b,c,d){try{this.$_buildItemAsync(a,b,c,a.start,d)}catch(e){throw a.grid.completeProgress(),e}},$_buildItemAsync:function(a,b,c,d,e){for(var f=d+Math.min(a.progressStep,a.last-d),g=d;f>g;g++)b+=this.$_buildRow(a,b,c,g);if(a.row=b,a.setProgress(f-a.start),d=f,d>=a.last)e();else{var h=this;setTimeout(function(){h.$_buildItemAsync(a,b,c,d,e)},0)}},$_export:function(a,b){function c(a){if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,e);else if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(a,e);else{var b=document.createElement("a");document.body.appendChild(b);var c=URL.createObjectURL(a);b.href=c,b.download=e,b.click(),document.body.removeChild(b)}}function d(a){var c=b.url(),d='<form name="tempForm" action="'+c+'" method="post">';d+='<input type="hidden" name="fileName" value = "'+e+'"/>',d+='<input type="hidden" name="data" value = "'+a+'"/>',d+='<input id="submitBtn" type="submit"/>',d+="</form>";var f=document.createElement("div");f.innerHTML=d,document.body.appendChild(f),document.getElementById("submitBtn").click(),document.body.removeChild(f)}var e=b.fileName()||"realpivot.xlsx",f="local"==b.target();if(JSZip.support.blob||!f){for(var g=(navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&navigator.userAgent.toLowerCase().indexOf("edge/")<0,new JSZip),h=0;h<a.length;h++){var i=a[h].body;i=i.replace(/ xmlns=""/g,"").replace(/xmlns=""/g,""),g.file(a[h].key,i)}f?g.generateAsync?g.generateAsync({type:"blob",compression:"DEFLATE"}).then(function(a){c(a)}):c(g.generate({type:"blob",compression:"DEFLATE"})):g.generateAsync?g.generateAsync({type:"base64",compression:"DEFLATE"}).then(function(a){d(a)}):d(g.generate({type:"base64",compression:"DEFLATE"}))}else alert("not supported on this browser")}}),_gk="dkdl",_wm_=function(){return"iVBORw0KG"+_vm__+"V4AAABCCAYAAAAfSL5OAAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAAAJcEhZcwAAFiUAABYlAUlSJPAAAEAASURBVHgB7X0HnBzFlX73xM05r9IKIZQJEiCEjUgSGJM5ZBt8FgaDfMbmDMYmmCD/jcGYs82RDJxlA0Zw5HgywRgFJIwICgitsrRa7Wq1Oc7sxP5/X8+8oXd2dqZntSsJmPf71VR1hVfvvXr1qqa6qlpRUpCSQEoCKQmkJJCSQEoCKQmkJJCSQEoCKQmkJJCSQEoCKQkMmQTUIcOUQvSVkoCmaTYwnIz+BFVVDXylhJRiNiWBASTAzpOClASSkgCMrhUFJsPlwwVNFt6JfLVwFjgtXEb88GPKS0ngqyGBlOH9arTzcHCZC6RFcAlnsYFAQHG5XPuQl0aXRluMNQ2vhBH8YgMGpBylt7dASUtLAyf8N+CD64Rrw2yf4RSkJKBLIGV4U4owWAnQYNKZmrXW1tbS4DrhaHxZjgZbjC5xmMKDfIccwOCSr8PhRoaNLnkkkCef3+9vb2xs3FpSUtKAZ2PaF5ZnMpeCwUtAlGDwGFIlUxIwIYGamhoap0y4dDiG7XDUv2TWiZH90AIYXfJzFBwNL2e6BA4qMrDYACXFxcVHb9v26UjEcwCiI+9feP7BQwoGIYGYM14oEzvDcCmFlnrJMoiW+oIXaW5udoCFLDjOcr1hdsQ46Y/Uu48VxbZj49AaYy5Gv+dWtAU7UPe8oXvBB3otPYpyBEaTijA/sWawjCOfaSNGHD5x4cKFHrjucBxlIS5WWSSn4MsogZiGF4yyk0yB4wxF/g4iOCQQgML6gcnd29vbheWwDoS7UsZ4SGR7yCJpb2+nTmXAse0J9Dnzo1HiQK+1K0ru9LplE49U9mKSaB06Q+RX1fGZ/sBV43v8vl1v+4L2kS6nI9i5r2hiZ5miuBRVHVRdexQlr1xRKkE7IREOzel0Zp599hlVMLzbkZ+DD9d9RR7sZ4lwIEsKvgwSGMjwWqANhUjkC5ShNryUGxVMg9Gl0lH5umCM6/fs2dMwcuRIN54J8hc0pYwheXyhfz0ej3GNV4yutLHOm6cbA767pdjWVedQrIMzhrGFZIUywb5rFs3evk1T7NuDit3mL2za5PXmV7V37dm6t6By3L7wCzChKaHe5aCPgCkuL3DwMAWVlSMKjj322KYPP/yQs17+qyRQHnqf0J9SP196CcQ0vBjJlWIYXCRSoYbD8IpgWT8d18lKysrK2vft21fzzDPP1F1zzTWcEZjuBMibgkNYAnjBJGuasoTFtpX2DVGO/+0wPwFFtQSU4FAaXg1T67CN8/RijqtZEOGwKT0OxVufVWDPrvD37miqXbuqZskHjsYFC2bIwDDgLBQTBSvI5T/CpCAzM9dWWFjIJRf2LfLPOsTxOaHBR54UfMElICPuwWJDRnndx//LPLz5PfKyyy6bvmTJs9yqxFkSDTP9vp0UESn4wklA2pC+hA88E/psmoY9qCken6Z0N6m21o1lI+xbpn/75OajFy9+KC9MH/VOdK8fvVg76Rdnhhmfz82Xi5xscLbMJRjquAxICKbgyy6Bg214o+Wrj/bZ2dllJ5101rRFixZh4q0rPpWftEoniC6Xek5JYD8kALXSMOvsbrXmdO8ace7UvGkPPPAAl9lE78QoRgwtArDaCqbPyRnfrq5mpampifi4q4MGV/x+dSAtBV9SCbCxDzWg8Q1m4j/ZeeedPWnhwl8U4JkKSkfFjyg/wilISWAIJYBZsMelZfmaC8+dlT/5nO98JxvIxTCK7oX0Dy/k8Fa4DesFfEdhWierq7f4qqu3Usdp1AX3odgPQd6XG7hcBJeVhMtAXtNtHU96NGaHKmiFhSXZ//7vV4x98skXN2/bto2zCyq5vMig8tKlICWBoZMAlyH8Xm1khr/w1gXnVS1dvnxHV12dBxWww8lLMF0HmxSlFWemW5RAoFSxWkUvB6JF9Xq9wb/85S8un49qHJlEEC9dyvhSKgcQurArBSPr0aiSg2AiW6LiPYVr165dq5E3+v1TorL9uDqUG1tnZvTow4puuOE67NqJrIlxsCDddEMy+gBPClISMEgA/dDVqEwr08rv+MVPqXvGtdiIkZysqt6a7du3dPr9fC0YTxdVHJvWHnrooZ7nnntpvzutgdBUcD8kgAajweUWR74kNePS33rrLf5LoWNZsUNJ29GkC6CyeEDli3bx8idK06xWq+WMM+aUjR8/nm+C5cSTLDskKp9K/ypIAHdBYNbZ1+033zbN2dNqm3Pc2LLyqonslNQ9eREmOq6MGzeueeuGDevau7uxDVmfNRk7I8NqV1dX4NFHH+q+7bbbesKzXdnFEO0jewoOlARgUDi5M+1458h7773HQVgGYhpgvY3hUydMw1Ab3iD/TokDFWSKIwNdUoQhv0CwoqIq48ILz8G/Op1hdgAaXhlxJF/K/0pKAGtu9kyrkpZlU9LSP3eWIDbvBqDf/sHqHYr6tdE5roxz557AXQ5Gwyu6pxvgGTNmNP/n1Vevf+ONN3Zu3bq1Ey/Peuvq6rwbNmzwYGtkz7e//e32H/3omm4YYOnkNLhcmuDSBX0+M40gfugp9XvISKCzs9O6ZcsWzpC5I4VOBmIxvqZpHao1Xv6VCj799NOu1157zcMFaGwNUyorK1UciLBOmjTJdtRRRzmLioqosEkrFma96ty5Z+T99re/56ZzUVqZLRAfwyn4yklAU2HKgqtqg26314Z956LOfsXS3WapKCuxjiwttBXaeywKTmdg7E9S93xahr/bftLRY3Mfy852e7qwKthX/2h4dZxPPPGEC642PT29bcKECdnQWSfWAy04Ki2TG8lLXeVyA9eN6dPJ2nFKjyGMQxVg41QcBOK/H850ZclI7A/bTto4IQuiqQkzJsrAafiaNWv8zz77LBWKEFEiHIxQpk2bZr/llluyZ82alQ6lDOVI4nfs2DFp48dXpW3ZspNvJjjSGGcLphlOospU1kNdAjhq1tXtD97+m0e7q3c1+GACqQdUfw1zXyU7u0CtqhphvfDU6c5/O21SZpHWhljuAjML0FOvS5kwOje9srjYuaOrizonjjNVY6ejvgfcbrcH/YAViJ6yj4nxZR6WZxpfFhtfGEf6C+JTcGhKQMU1B1xmkBkudYBtGdK7JGgeMsPLOkPXkEZqp1LqytnQ0BCE64VCuh5//PGCb3zjGzhtmRwUFBRbx4+f7IThpbLS8JJhMb7JIUvl/lJJoBcz0c6WfeSJxks3hrgEV8MpSG3btmrt7beXut6+8BzXfdfOKarM8NoVfxLGN6gGK0vy7eXlRc4dO3ZwlsPZDvsNZw9iLMUAyywISTod1P9ow0u9ZT7jjFeMOPGk4BCVAGe82NlA2yO2jTogg2pSVA+qUIIahCgaRSoY717QHda+evCCoRFXBFLpkholnE6HOmpUhaypUJnFyeiDqBR8JSVgpyronYG6J3pHHaPeYaD29b744ovtf3l3d4vLkg1jmdxezAxfu3VUSYG8yTYaXtFh0XkaUOo8JwcuOO52iOXCdOnGV4yuGHEUScGhKAEaXiyjir1h2xtdUiQPl+GlEsnfKSogF9h099FHH7XBNeFZlBZBM2BTcMadIwyd0egaBWEGUb88ECY3UqfBcTN1HlwBXD5cTn19PTdN6z27X8GDFAF67HCkl47hJGV5kAgfpmrV0NqtGD8xfGLwRPd6HnzyhX017b09ipMqZBZUzZmmWCpG6YZX9I6+zHYoe9ZNnRejL5MN1s2FYX6Fgj4d+wPTSSfzs9xXzuhCZ9nn0uFy4NjXpM9lh+MPRJ9juyUFWEpifqPBJY6k8QwHc7GUkEY4Qty+9vZ0jB6V3CpmjEd4QOC6sM2Wxvx0YoDF6A5YLlYCGpZ8c5Gcb6u5W4JLH5xNi1FHUIcgLrDWOxPK9GBhvR1X+7UihddYkqdhB9RLmvgGlbTyFJ9sq2M8gTMmvtDshFK08+XOr371KzeuHox0ZqSJzPQCJn9wmWKyL6NMYh6ebNQvtpUM+JzximHTO8q+LVvUbrW0Q7G0QYb6izITlASgGDlKur1AZCi6R9/y7Gef2S6eNCmi20S4ceNGFf/qgps2bVLwJlxP6+7uVisqKoI7d+4M3n///ZFZLtqGRaCP24jfPGzbqijjVvtU9fN2Nl84lFPTPsLsPTe5ejd6NWXSJNSbnG6AT/5TYJ/jUWzqMU8Fyj9Y0WVE6W1G+fhRpgt9rgO7pNqzs1u6VbWKbdpH1ixgFqL7AUZAO7coJAMFBQU4K2Pl5gELTteqsA/W448/3vr9738/OGnSZHzQ1Ry24TS87PjsBHQc3SlMfXZQVlHRix6hWxTEmYZAgHLXcRg7AXHyOWJomCkW7MQMcYx+8Zp+cXUR8rDh4wJ3Z4ShAEZ3JML6p1w6Ojoaenp66tGZOIMhmKIhlDXxL5SEt18VQ3iV0FjSmkhHSmF0sQPK3/2zn/1s7/z58/dUVVV1oJyGTl+YlZV1OMJU8ESKC3n6evfubf4MecmbqFKicsh6UIH0UQfE+FLn6EQvyEfQllbcEwi06YLAszmwQgdCeiC6phuriy++2DqnomICkNCISD2wS5N0N2fOHJGdXg/ahnt6t8DwNiCCOEizBVo9al3LiNE1Xf6ATSdfzz7gDzqSmpVZ6j983zFbFGVhIzJKPabbCPpl+6i+fcq2PV1ZVsw9B6wsnEChao50y2lV6a2lirIJj+zPAgOWRz0Z4K8M5csgRdmWJ+Vi+cY+mY8+B9HbUFd6J3A14OrYRtzh0h6eWCTFN/525KETTQIdLBdEmFsEpR1i0WKM07BJwPLcc89xZh5EXws4HI5gTk6OH30rqGkdnr//fclaRTmLOmeEmLKJWBVjziEKUxHp2EBsN4ZJhDZl6lTNiVEDYdPAXROtrfrsgYJiWaOLiweCosEZAyJGgZhcPPBZ6IlbNkaiHYpQgtGuBEoxBvs1a1euXLl73rx5FLgYNp3PGGVNRUHDCpFxHKYH0HH9ZY5pWkEb9CD9iPT0kSO7ulpq/vrXxdsxY+CbWBpvtndMRUC8gNXjCfZs3ryZHYA86UoKX3hKVF7wHDg/NPsS+igr6hsHfPpGAxEcOaLSrzTBXiUJwWDQqG/UQQs6ngUvlGlMKFvW1QfQFiwTATxrGLD574V6ousxZo4Braurs8WvZf5lZ4c9oHkSyjeAZsy2qNaLKp0+7ZFH2tQFC6SMyED8SN3Rge2treWPLN09al1Ns9Vmt0v56GyRZ48vqE4oywhk9Gi7//ummxgvuiR1ia+XQZ/jP7PRcOWwbhyYKIs+efBsCsL/jPnPtLC8vHzszTf/vOk73/nOziOOOKINccQpOhoXH4TuQMbicH7mTYoetLc6ZcoU9os+7UpEOJjo2blzNWf11D+C0Wc9fYCNP9wgldLXDUhFSUkueoM0nKn68ZdDaWysF2bIuNENiAMKkIkeeAwyTEGF+RA+y7EzCl0Dlh0gQecDyhCE4c3BjHfC2WefeTT2L1MxiFvvlOHwAChiR4NWLt5XQUtnIEclHDtosrSCPmsA9KVnZeWOv+SSi6fh7X4aBi5d9sBH+uM5ZPUoH320jApGx3aiE2OB4CEN5I1AnzxTfuK0nDxHmlXVjSiiTUIANtUfsau6wURJtjVB6oklU9ZvdBr29lKWchiDHdX+3OWXtx6XbW2YmGnVel0BLehP5Dxae68vUO/Rit7M0I0+8UgbJewXXGJ4p7p59Gf1rRZVCQbxH06L5wJId6D1x6d7mpY9cnf70qVLjfSzXpGJEtbhCsQdDzcejst4RhnhcVBAHNRrp92eMXL06NEzWlr2Trj++us5kLF+0U9pl1iVcAYm/UD8WPnixQkvfdoVLAaXLv1M+oy0x4C2gAkHFLZiMT3L4agIC8B03Tz1s307vhzQF+IJWWnDizJknw4pjIBPXgcr7L61fv5EfJb09OyyOXNOOepvf3uEoykVQFxc+j5Hg2bDrBx/yQ5H3FQ4LivsL60ob1Xz8oorx44dexjwkSYqjSlYs2YLFZp00GdHkw6G4BcT/rBKSw/u/TRf8egvSEwyYVUCfo/W2tlI2Ul70pewSTyhbDC8lKXIlf9E7POee05t6+zcddaoTK8VFo6jRDxgQ6paQPu0XXP0jpk0akJlNvHpuOCzneLStn7fiPylm3C/DxTOqqsFSsQBP2b7BWlKoGvzytZ7H3uZRoVrtdQLGhqSo/ct6LAdf5Em4JkTHdkySj0eStANHyY96QUFZYfffPPNRz311CPs56RBaInL/1ASI7j8/oDa1LSZ7SBtIZOWmLpyoAwvhY91EC1zNNZYEOZfD9NGAHmVvXv3BHbu3EGdNCXURvzVwX+do5Cff9tZV1L1Ib9ZIF7MfjNzzjnn/Mk//elP+eKAykklEIfgwLAQL7/wqucw9BgqLcsMFa2860KhksI3JTdS6fF4Lbg3lh0rVgczjYe4DiW4dlJNWZrigkHgCopZ0FR8sEKrr2/tZ0CwhJO0LPDvg4aXf8PFcOkd9Ntnn90+Nl3bN7MoW/UksrwoTCXZ096l7MwaWTRz9mzqXPQAGbNva9oj9mWftlQ2tLvtAUvitV3gVbKdDmVihtu15Ik/kzLSTr2goRfjorz20UcZuIdiKiKowzT+w9nngD7UR3Jy8kvPOutb0x588EH2c9ZL0ZD3mPwjflgAf8jVhoZuMbzSFkIL9aSPrgwpcRZLZGM6lVQXfGlpqfLuu++m4437GLxcOAEWqTyclpQAVqz4p6e1tSuCN4xDnvvgqsU2Ffzvn4pWEKPbJz3Ogwgo2o9TJJIUzM0tycGLrSO+/vXpHO3ZwWiAKWM2wIDwU6yFocUmIBPzDZXRNdaXFE4YFEt7eyeViAokHYy0iVyMuA9+2M/l3D4dXTq9biwvfhZbl2rXVgZ2vzVBaa2DWtjMywO5m/0Zwe31raYH/XgCaWtrM854GdaNxccff6x59+7deUqJvTfLacUR/HhYkIbWUK2KtqrD7zjmnPlliGE7ic4RZ8y2WrHt3LwNDe6Kjl6/qZfbXsy/p1SkBb3rX+qq3rGDdfQzuvi7bz9t0qRpdru9CukHFDCvQL/LzZs//9Ipd9zxS5n0GCc+lMOwg9frtmDWS9lEyyemjWUDDQlwRnX66Weml5ZWWrDlwg9h5FRVVWG3RbEzPz8/HS8R0pCHRJhX+hBlant7c+D555/DH6MISMcSP5LA2WNJaPZIZUykvlLOwjVQbP3x85RdY2Oj3mGxfmsB/ba8vDwRXiLatfLykvxbbrlz1EUXXbSDW4jCFXCBUGjtg6Ne04rQUuOH0egKj0n5mL1QeTmjIXCKSBnE7MzMcLCAM/qyEVWWsZrNmunIsmZnO224I8Q+efIs5/z5JztLS4uzbM0flisd28qs7m7oe3LboJSg3bJzT6O/qV5/v2BsOw0vW4zPpkSACQj7HA0kgeGIXJf/8Y+ds2+8tW5yXsa4j/d1JTSMYF1pRMs0lk3JvejcMzteePUN6i11nvpGv8/ERHv3Xds9u9tGbqrvcdowS0J6XAgARV52tlLh2d579+OPEx/ppk++qQtB3M6m/PznPz8Mb/k5oepTH54PFODDCbnZV1xx5fgVK5ZvevPNFdgQFHm5ShpI87ADbAj7DGVDORj7TL+6h8rw6n9pZ8+enUbXr5ZQBAlKWlEhM/X5519wf/LJp/q0BjjIFB2FKUoQwfszzHJhLUYjzSyo+Pvnw8km9wsvvODB3ks/dipoGL01fP/NgrslrJdccknGaaedlo5PEnHWx7oHAsjBYfna12YWXXjhhW24NKU9nJFlSKP4ejTXdRE4DI6jZDy8ev4D+YO3+DQIpI++GIcDSULiunB7WFFutuXBu6/JC/h9WrrdHnQ47MHM9LQA9nwrTt9Om7JtQ5oSdKuKhztikv1kPNQrLU9btW6Hr7GxTdpH2jExfTFyoHOKPMWXwUxd8Oij/lWXXbhneskxFRta1QwtqEmdMTCFolS/om1Jy7RN/MZFBTlvvuHq9OhGlwaAfUP0jTQrm6ZPz13/YnV5t8+jOS2sPj5wB/PkAr/2wTOL3Z2dPhYgHulz9H33PvxwEfrJ6DAmvZ5w+EB7WnHxiLxbb/1/o1euPIeTHqlfJj0JZSkFBumrwaDen6Vd6cvES/wI6sTSj2Q1FaDgB3KmEERlsmzdWu254467etxufJQwpEhscHEUZkS53sXeRFiKcYjjTM2EEgQsdXU7fJdeeimu7ftR1zvvvOOF0SW+AGZ8AV7th317PRdccEHTtdde28xnpPUTIuKMgPXenLTzzz+7BDNlWeshPTRi0sn0/BiWi4GQM3MTtOpFon8EXyw/Om9SzxgUBGdS5Q5oZqtNs3rd6lj/Nvvhyh7HCN/OtJKeLRmZzeuznQ2rs5WWXemKex8WrXsgX4o/WbCrXV6r751/remFjWEbGV0Aa+cat4glizWcn/IliJyJR/3jrDM7jgm2N5xcnKX5vQl1Tf/wRXOvV+2aMDNr1te+zuUhGl060Te9j3O2+9TS7WN3NXU7YHQT0swlhoIcm2rd/ZEbS4XGSY9ucIHf8+8//KHt5BNPrEKYE7iEOJEnGoT3WH503oTP/Pdz9NHTS3CYgdv7ZOlF/lUkLD9EGciLgDEscbo/VDPePkiH6MFSX7/bd+ONt3fhFBAbmyCGlopAx3gxvNyDxeNFXOcxA9jM7gosXHhXNw1uuACVRze88AW3Xic2bbsLR470/fqmm8q5fxPp8RRNO/bY43IOP/zwrA8//FDwRegkbs52wcBIIGIHYVoywAYN7t69O1BdXe3D5S1+HOZQsCxiOfLII224NN6ekZGhdzjki0dnMnUewnm5fBBLhBTTYAxumFWbqq7aWOdbufITzpoIRv0IYkktVqWhnMn9Shtpz6GOK3bs2H3RsceWbmh3ZTS4AjCu8ZFx+1ltep59zOxvZOe8s8Ld+bnxldmeopw8I9/18s4iF97cmZnt4myWWpkW8K95/kVXV5dbdFeMLvuL56brr6/ITEvL0i+hT0RkXxb0L3Lgn6Yf/cO7du1aH0/4cZ8sro+1HXPssY7Dx44l14n6WV+skF1GRrb9nHPOKcYtiW7gZzppp+MCrAYGsIIS4D90je8yWCczmQH8W0HRgLSVsQhwJd5/bSxwKBpeCkLFN9Z8N9xwQweWAGRtVxce0qhMRkdB6MLAtLIMzuRsV1FWrFjh+fOf/4zZjA7SQGLU6bMeKpsOv/vtb90Xn3dexoyjjuKe3QEBOhgsLx/hOP3003OgWKSfOOikDgU7v7PwBq4E2hWrIQfEjQQLl0Yefvjhnr/97W8ebLEj3ggOnl47//zz7ZjBZ51wwglcV6c8I+nxEKfSjBLQ1PZgjv++p192+dz6wR3KsE878giwscR+hPt0/jPPPLMDg2rdN0bkHf5wdYuSkcDw0ua1ez3KqBmn5IyeOrXz00/1ZTnOemkgefTW8uL6mpGf1XWkYW03oS6QyawMh5Ldusbzycr32AcI5JVh9gsPDjBYRlVW8oCPzcT35pAtAjy9F8QF8S58ydm9bt064hSa6GulY8ZYfnzFFelX/vCH2aVFReQjGTkHZ86ckXPyybNynnnmJelzug+b0pFdVrZ6x6ef2nGs24YX/4W4KXEk+ogZA88lycDtt9/e2draGsQ/nQhDDHjwr6qxUd/5IrwwWsLiM06HvqUl9iD4GExUKBA+COgK4O+9+557/ugKNwqpkUanItFQ0pixwRivNxaUy44I2c9HQScC7f33V3ixPqVidqhYsOaF0SyIY1+8o8CLZQIfTqf5kIb1QpvG454cQTd/9lnjtEmTchONlDR4s2cfn3nXXUoHCCGt4nTa8J+QRtf0IBFmRuVXDX784x93Llu2jB1AGlTkgBvB3RoupHf/4x//6PnlL3+ZfeWVV+aBB3ZdyRtGlfIGlEBAUwNZmdp/P/VR95IlK+TfEGXMtmM7UvYBvDQeDpnqOJe//PLuo+ZdUnpkSUbOuhaXlsj4Bj04AFdY6Tz3W5fmfvrpjewjsuQAWtuz/lHdVNra7lV0E4PE+GBVRtm6/OuffcbdyVuOQ/2MvJNvfbb73R/8IAen9pJ9N6G2tNQHr7/+ho7HHnuSm6llUhDRX9a1b9eu4K233upavWFDz7133lmMfeh8qWdW1lp2dr799NPn0PCyDuLWHf6BkvYmONo9B44dO2F4zeKFcfVoGDBwH36f3VVApeOnT6B+UFZ0xB0T/yFjeF2u9sCKFau8Tz75pPv111/3hpkD3TpTouw0uHQUoK784XSlGWs6WNjBNm/8FTD5t+fyy6/KvOSS76Vz9OJfDzoY1CB9rN9xVNPjUEcEIHwb8kSe4wWqqsY7YMAd7e3tpJUdgfImL1aLz5ev2BllGlTMgvzXX/9TGl0xBtKwxCkNrisZruBUfvGLX7gxqmv49AzXvETJTVf41cyIte3sXOV/l9e7fv/gU+i4kXcLlKvooS7v4447bn/WeOOJV/vuNdf0bP/mnNrZhcWTN7V40Iux5BCvBBJrsSxx/GlnZU9b/GD7+upa6ogNf7ttjy1vGLmz0ZWuWPzgIS4WvYYMvJmw7/3YvXr1auotwci73u+mTJqUBUxUYBoYM4DlBW9w0aI/d4eNLstQfwW3GCvxldeeecadj4nQvffcMwKDHPtOTCNGRFGgTZ16ZDrKOLB9j22lywI+cXN2qy/DJTtwwi4ovCQHtgkoIrQTJ3mgI0h9Eh+T5oNueHFbU4DfpXrjjdd9q1d/4seMTRiQRiEDFBwNrsx22fhkkHl0xpAp9CILRhNxpqCqqgr8B2CQImXEOIkfjUfFKB+pMzox+rm8vMw6btxox0cftZN2yppOfXbVKodqt3MjehIQUJ544q89b775jnQG0kHZiCwoI8pEGlzBGpbyP//zP76TTz45Cxd8UD6mZYO8XzGA2IKYD2bmBF/5sM193a8eRv9qFXlRJylncZQzbqOaNFwy0uvdsGHV3iOOO7e8ItNZWN/jCsazmTSnXrdXWZ2e5/i37/8kd/0vfsG+Yps6c2ruhjZPRWOnHzsZEhtdzImVcQ53YPVrz/e6Q5+hF6MiBsVz7uWXa3m5uTwElRRwPffuu/9bLl4ij8RJJ3KlT/2lY7rliUWLer81b57jrLlzK/BsGsaMGeMcMaLUCcNLnBwgpA7BHcjIz2fdgwHSRrlInyMekRPxsy72ecbrbQm/D+iWv0/M/j3QYNGZBS6yK2+++X/eZctWesNGl4SSeBJNxqhA/MtAZzS8ZDTCFCTrRKFkBxKUtwoe4pKw+IwzOolHdELgrNkyduxoNjo1nrTRt2Btl9diyl5ORMUHiMiKAcr/5JNPszGFHmlgyoiyoUJ3hx33MdK5//nPf7ZV19Q0Isz8KYgpAcxynVmWLkeh70+vrOu+6tb7Oxsb9d0tlLVRzpS1dDbqwnCB3sbnnXeFK7u5Yc8JZY4g3gol7Ff8o1fT47V4p30te8bEiXyrb8877ITy9TVdGTYL7mNIAGRsdL5NzcNsF2ugYjTIJ8NiuPwnnnii4khPJ/6EOJFHB76UWrz4STfWR3XeEEm5Sh8X/aXOUodFf3X/xVdfbeh0udj3E8oAeQhYbsjDpGcc/5qyz7EPSv8jDtIQGFVa6ue/W4STBb08ClEmpMvY9xgmPxQn08Vm9KlnqAyv6nK5NFxwLusfpgUE4djvv/9PuZgZkhYSyQYh0WJwKXwyQ8c4MsM8ZCSi/JAsZ3QUch8G8XwQgZe3l5AvOtLGxrfkZGSk43Y207JHh9Kwrc6PG8PIN4F8GxtdFFUanQ0vyuzevGZNA5ZIqORm2wVZv8QQ4JeHYWxtuCPGmam2p1cEn/nY1X3OdYvaf3Trw92NdTWiQ0bjYPzHJUZpuIUU+OcLL+ydk2PpGIELDTEAJwQf9vU2ZJc7T5s/PwcvVzM3tueUtfZ4sMGU6jcwELXDblOPyPD43n/9SUx2I9vnmERdY5/U3fhjjuFFmcmsu6p1dbsDuDaReKTfijEXXZV+zmf2c+n/vRvw8YTGtjbuiY/PBDIIYNKj4F8e+xudGF6G2QfYf/z4EC9pGAzo5VHQ2AfZ96QfknbKirIjv6JPCIaAhAwZvPLKK70nfO1rwTPOOIPvAvpVNkBFGq9au/POu7KuvPI/WnFtnjQyFZ3Ei894CopM00WDiT9S0UWG95lrQriiUQyv+FYftrEkWbO2d2+TNCJ5l84gxsDY0Eyn7CNGdl9vbw8y+NBTzC1OJ0ncQc1OE4C3oYnX9SEyvIHFvUGaSynRXG2t2q42u/+96i3e1/+xxrPqww+xeSF0aTn4ER2jztGJcZDOJOmmDcEgZKS34YKFC92fXnTR7tPKynP+2uXCKeFEEFD29NosRdO+nnWqrci23BWwm2l0KtSYfIem7f6wd93azWKQGC0GkrwzHBiZk6PhtjYMXObNB24WDOBvP+VGoE9cRv1lmHFME9uh6zAOQ+CeYr0NkGQesrKyI30OpUgsn6VfaPiijdBjHunnOVlW5EPZUE9ItzgEI2Hhh3E6mJeclBjA5wsqrClqd91xR/dxxx/vKMrLo470qzBGcT3PhRfOy8Q36z233LIQ78l0g0tjYjS6ZFScGbwxquoXJY3QL2GoIvBJe2ls+pSJBXLan3rJOxucjS3OOCgxXeTDerSx+GIAZtgs8yUDXGDjV4MfNqZ7eroxQ9O1WVSafTgEnJr14m6C3XV7Ai0t7cEt+zyBjVu2BNavr/aHt4oxo8hNdEyMLvWQhldkLcaBZYYbSJMFJyr3fvOKq0cenpeRv7XdpV/ROFDFVDB8KkXbl1WRPmlKXrpn3V4TxpqzXVUdbWn2vfvyY71kHMC6KQvyS97pMymYO3asyAqPSQNxGg1WtFyZTvwEXX8/u/hiLTf0JZhQrMnfzEwny4vxlf7HODoFu32kHj4mA1JO5CA6Y6Rd8EleedZ90dI+kYN9oPF97733PA8+8ED3LTfdlAMl4EwkZsXRdWB2qF577XW5bW1d7t///vecskvjsLEZFqYGxMdMVDwzwLVlOOIcNvD7PRiMcFz188YPNXrou01J1BtQR4woo+KQd9LMTiAdgfJhmPHR/Oiy+ubcudZgIGBm4gMUXyDATLe92x1c8PP7O7EMQxkQRD/ED8UO/Mt8dCI/o95x4BdHAyF6GC1nJA0baAsXLvSce+65O08rrsjd3hKwYMkfu20Gro935+72BtRNe7pxM3PiXsEdE2Py0zX3+n+6Pvj4s7Dd1XllWCY/Ef7x7Z4gsCb1IULsebaWlBSo4YuuSBRxizPqr7Hd9PC7s2dbnKqazNKGLpy6uhaWj+5/7Ee64cXWUWNdeplB/AgO+uISohlSwyu1Pfzgg92nzp1r//r06XxzTyGbAf3UCa5VLMYG8K633nqLM42Qofq8tDD5eUw4hJ5AxQjCmpox9mpNzQ7fr399ZzfWpiOdCHt1I3ixZWzAuiKZEEg0e8VLClFkFtP52dDQ4DsldHrGiCpO2KpWVo6yjRgxQsWnT0gXaaZcxfE5wgfCfcDS25ufkZY2LG3dp6KD9JBm8+kdKVy9yIe+OCNljBOQdJEf5UkloJOZWLRxMJYXPMPp6zRuW7q0cdK3vtVclZ9dur3TlfACHWqGszBb8bRg6TFAVuJZaodSpTT5/vclbp/TQfRLeBef8tGKYTAhIBpk9m8z8tBKS0fh22Qn2jZt0r8wbpQ3w8QhPoJ9oWDiRKfDbue32pjHJASUlhbd8BrzG/XEGH/Aw8PRGTXc8OW/9+67W4967DEHLpbhwrZZgQVhXNKwebps69atbm41Q1lxYoRjNjRahUrD85Uc0RICN0O/+uqruGoycs+q0Cj4xU+Iy0QG8hBRrMaNG704TuRDV+AobgaCY8dOtH7zm2c4H3lkERWeQPrE6RGxfp7F0WT0jkqkJdMOsVAdsnGqon+6hrKgjClrGgqGReYDtaUxD8uJ0TX6on+JcKH48MG8667zbJ01q2Z60ZjCnV2c78Y8umogAF0hG39yCnFUh1eYDQBMmZjnVGr+9VoPNr+InMgrZUA5Mgt9ykGHjyHXST5fLz4ZZNqQ8R/t/PnfT3/uuZd7+CIeiMSJXMPY+3ujS0v5loxXrQp9/TMZYjDJ10/H4Sg9aRYaxTfkPHhBU0ZqEORpr7/4Yvfy5cv5JpKCTQY0vI3Nu+eeO8tw+pWGiX+ROUBE/iLEQobjYb2QMhXEFJSVFVtGjSoX/kmjUdmMf6+oePvjiEvwUZmDuHu114W9cwibBRzssFqvvvrqzMMOO4xTF1MKSORn4/5jaBwPUJguw3JfQCB/7GhsK8pb3jL3256ENC5lGeMZppNdIfJ+gfrENiNe4j9YMtTr3tra2nRCuqW1KtuJbZigxgQ4C7HZxxp7lYkouLab17XV8/6rSygz1sN+wCTyLvzreotnnf8ZkInfbu9ApqSM2Yknzkq7+uoFGAnMy7FJ07JxPK4KZUzXxWEJX/rw48BRtO0xjQP1DSuI4RnKSvTGg/YHfnr77fVgnsc8kmGYp8XUc865sAzHhktRlsaXToxvTJox4+UwSmMWMx3xRtBycoqsM2fyXnZd0dhAVDJ5kcIOKJ0x2scdJIpZR97ZyY0d2o9lFK+mqm2ITwaCU6cenfbII4/gn9dE0k2Zklc6hvvJuEfTOLJMgR4mZayB64sIRoPBdozXhmwXY7uyjag7dCxL4y1Gh3ip07rRgX8wQK/7rLPO8uT5Omsuq8r12Z3927sfYbDO1gx0Hf020xiWGh8jL8u2B3eseKWnPnQHNeuRviADGA0yC0saNE3VWpubO7CsRxn10zvExQL06wzrz352Q97ll3+bR40T6i82oeTgDoCjk5nthitW16xZbfw3y2jSr8sxnOegejRmwwXaNszs/rp4ce3Pr7tufIbTSWNhlnEe3bVccsn88u3bd3v++Mc/8gAAFUI6ARutDy68Z/F4NY0GMe4FNkjXgcb9W9/6t7RFix7vwZ5FjuiiaPT53Ac/noPHHnus7aqrrsrHHQ4W3FcbnY4snwPufsDfnZbArbfe2NbY2EPFJe3Eq88efD09TYGsrHGwiGYVl8g1nkLDzUsVuGAkiPsYvLgkRwaaCD1Q2DT0lpHocoejDAetSBqRfIkh2miwLRkXCygTo1wkn8Qb02KVP9BxpMeCI/X7fnjtT5pOLc8rf3U7LtDhm7R4gGQnlhs87RxT+oLVaVXyu3d633lvaeiMWkge1FUaVMqOPuUiDsEQ4Oup/Nw6BzfTn/HCTDSII+y2//qv+8tmzTrdgkkEbyfjQEcQ+XPXnx0jYQHiJsNA8f6VSBozJgD9vpe3345cZWlsT+I5JNp1WA0vmAwuvPnm5jPmzs2aOX366AQCi07WcJba+ZOf/KjynXeWuNav32wUIPP2E2Jzb29TeVpaBdLIV0IBz5p1ivNXv7o14+abb6NWRhtfI36uPSu4fAb/9A+jMTMDltbWxr033XR7PSa9pIX46PSpxyeffNJxypw57VabjQqWkFbk0QEDBvc9Z/3hD38YixdtBfX19c24kawbl/34sJ5uyS4q4loYP6lNhe03QIWwfMl+Q593F6YoS8qY7Ulflzd8gWhZG58ZPqRlhh0O/tNPn7X7a+OOLl5V77B2eflaQ1iL7eOzHDCPsJFdVPNQZgqlKj0YbFz6mrsmdKsWC1M/pR/Q6NLpEwX4fQCHE3ravN5GKBlfsCUD6NdF9ssuu6wCF9Tk1NbWNuJK0w58scaLAw1B6DGXIkowJS6Gz8kaaUoGLDTmy5ev4sDB9qSTvkdf4hA8eCCzpeGgQBgM/O6++2r2NjW1oJIEKtKPjGBV1bjMBx740yhsR2GDcLGKjUG6+9H+3muvNfT6/Wb/wuuzanwjLe+hhx7KnzBhAvGJ0vHvlSw7uD/77DMrdlqMx/nvsYgnCG8D+cgS8G/YsHYvXt5Rx/s1PP827mtp2Y1E4khm1ovsShB7EO24d7cUM+CJM2bMOKaqquo47Bk+DgZ3CtJl1k/cXxUwtgV55jPlTvkbnbEtjB1RZCU+ih1yQHqVJ/7zpqaRQV/dqaXZ+GRVAhqZjlmxs4QTUzG6/KSPQ5lm3dW77M03qesE5jTOdGm4GGeUER4/h+3r1+/CS2ou0ySrv1xOVNCnc44//vhxs2fPPmr69OkzcKDheOA6Gq4Sjv082bbAbNfrx1Wv7vAHDViejjwIL8IPog4e9DNeQ0yKzuRLTzzRs2zVqp3YN8tGTraRlFmzTsr/zW9+U4qyYng5oyXtdBF88+bN89Y1NtYksT8XxjfD8h//cVXBkiVLxqxcuXIUTt+VvPHGG5xJ5nVrWolH03AXyqTjcMvYGCgLNdeMMqjNzQ2d996r70eOppn06jTX79jR4O7t5fLIYNqBdFCZMOPR6RKZMM4MjSyagi+eBLRHP/444GvYVjuzyO7OzTDxYUyu9fIL8NzlAJXBEz7pgw9lvr4Yl5x3GQ0TJx5G48tnpsfUJwz4na3d3bW6EiLTIID2gbcBUv9tYT3W4/Acs874dQTU999f6n3hhVdkMCEOkkc+6MToDgI3Sg8hDKbDJ1s9mdS+c/75TbsaG/cmW5hl0SDqRRedV3brrTcU4VkMGY1gNP3qO6+/3tDW3V2HtIhBRjgegD6rpaqqKhPfV6vERvXJOPJ8XHl5+Yn4u3M8KhuHwnh3p9dlpsF48Q+2qr3e+tJLb5FWvkjgPRJCt9DM77m5Gzo7azzJvaQAqj6gyxcx4vdJTD18OSXwz4efbB9h8dUdVZitmjJ84VkvViaUApzoym3Z6l6+fLXRsIqBkrVdPifSKXXxkiW7YXz5b9Zsf4vVIFIP/cECPhBQp+/Nj3GlLPkkP2Z4Gmz9SZUTI5BUoSQzizADTz766E4cZ0x2lwOr4+XGeLH148pTT53F/0xixMT4Rhp9wYIFgbfee297R28vdpj1M8zEFQuk4ZlGXEbHOGM6n+NAQK2u3tBz1113cubA9S8ukfAFF2mmvAU3cap/f+aZPW3t7YMZkFA8BV9BCei6iA9j+vbVbqw/tTCtN5M7HGhS4kF41mvNy1ZGZPQGV7zylDs82yU+zgRpnGh0xfCamnn+/Hvf633/gw82uwIBLs0dCHuCavoB9+0G7rzz9/iMl/6BAGYQnsiXOEqJ8QcdDoSgpGF59LFr2cqVWwd5U5aGF1wZeKk0CtupOIsU40sexKCxLuXSs8/ufPXvf9/QyQ+RhQwdow8EqFu37vBceeUVHdu27aaxlZmuLAPIAKHTSYKuueYa/69vu60aSyQNeJR0Jg0lDBfeoaQxhcu8BKg/6t13P9Q2wt9af1Jxob69IFHxAKYpY6aUKEVtW9yrVi3nxED6piwviNGVGWJETwfAraefd/rpLUuXLduIqxv59u5A2BQjORbOcG+++eaO++67j7sshCcxtlx2oCOPX6kZL/jVQRfI1b/+9b4dDQ3JLAVIefrBI4+ckfe73/2mAm/yeR+o0fiKcWE96vcuvLDjlcWLq3HbGY2vGGYEhwcwobA0N9f7b7752s5//etj0kBja6SJI60ohRDBZwUv93p/s3DhJux5bsTjUNKq149PFvm5/CGVpvwvhwTwiazg2g8/3D0rx+cptJlY60V3GWPXgnvWvOcJf7WbOkFjRCMlxpdh0dVEOsN0Pc83Tztt37MvvLAJL5NlsiO6jyzDAsRvpW7fdtttXfx+G54ZJzyRHxpcDiYykAhfiDq4cCBHJ72Rdi1d6nv2scd2YTLKJYdB1G9V5s49veTuu+8oQXnOKvn2k0ZOlh0Q1BUn+L0FC5rwUchNOMXSykjAIOoLFYzzy8a27N6903f11T/peP75/2NDSz2iBKLYVAZdDmEfXkjJ//SnP7l+fOONmzdv374vbCT3V3F1upYufacXSsljmqxrf3ESRwoODQlQj1S8UO4sC7rrZpbjXoY4dHH3Q2W2qmZsXtn7fy+/LFlpiGh4xejSNxreOBgjSaLPwSu/973G3/3ud9U47t+CwxWMl34QyTxEAezmCGg8AYqPurbfe++9VG7qdjQ/7IviDpnZLmWQSDBkxozjm3XiSwRsDAVLDp2bdu7kQWo2tBn8xjzYiZBtueyy71cuXHh9IcqL8SUBko/1sBGCN954Ywu+OVb9HD4eiO+QcR1K8iC4X6Dj4d+cxYsXd19wwQVtzz4b+SIyG5kKzEankrNe8sr46FFXlwnjX3v66Z5zzzprM/Dt2E9aua2GdHV997vzO5qbm4O8GDoMwn8c31RbEl0cHJ+nmdQNpZsLSIEgccLHReWJXDCcVy9wUH9MyQEUhngbOlJ1Ha/d/lHNaSXWrhKnU6XCUcminYLvBJ5u6/b//b57XJ2h0+rUO9FTmRkOpKPxKI70NWTy3407WubOnbtl0WOP1ezdu9c4+91f3iMy5hfIb7nllk5syWwNf4VcaCA/0uc4A6YjbwMOJiggdEXwI3+sMKKHDjhT7Ae1iCkDsRhVhGAczvbzbb0Q2acMr4PkxReJTnOhkAjI8pOrrqp/5sUXCyqKi8vlVrCB8PepLPSAm8xybJdcclX5kiXLe/BRPl0BkUSfwmc9dAyrH3zwgXveBRfsQUN1XXbZZYX4SGEedi3gcJyD/HDwYV4zwPwaR1uPxxVYunSFd9GiRa63337bRwMcRiA0UInZ6KLU0ieYHl2flA3gTmL3/Pnz6/CJ9h7czVCOwxK5+MAeP7BJOvX64ccCPY0Gd+PGT32LFj3W8/jjj+tfBMGpPtDr0esQWcdCwLhQW3YpcpRpoHyIhxjM6QfyUX/ioAolZWSh/dLwHaxAt6pvPEQ0rttV8Y1E8tYPnE5r0NWDk7+JUfcrO4QRlKsPPIp8B+wnrNOMHJKkTZszZ173pk2bak8pyjtibWdQ04JeFUoakRnFMxKfa69+/VnXB+s+46P0DYapn9TVwRhdFNOB+ESHLfiH6f7BD35Qd9JJJ3VfeumlBdhrXoD3Mw4M/viSuJV06boaKhr3V88H2er6i77hx7bP3qeeesqDvfXCBxGwbj6TB/Yzo9GNx5eGazP9mDWyT+s2DmWp2BHZ8ZkgNm6o2q9fBayEN1pdjF1/+JS4E86Bu07TsZaS1tnZ6UQHtoMwHpntV3bt2rX+mpoa44jD5QSOekajwyo4pcKs9bLMydOn5zfV1qbhCrc0LD84wBhkERs/C+Iorm600IA4RODwr1jxfgduMeO5exE2G0CML2mkweJyBKd8XBNOHz16dMbFF1+cAwOciYMTTpyWseHUl0rFQHo/vsCzxoEFxlXDOqwf+329+JYZvhO3DOTyy606iPKxbpEBZ7qkiz7jmJdO5wG+EcSwcjAknaQ3febMmVlz5swhrVlHHHFEWk5OjkXo5EwSsuKn5zXMajW0kw9faPbw1rXG0Nl74teqqqoUlLdQZjTClC+OZao4Km2lb2xLO758jBv/tVWrVvnQ3sIH25BtSV5wMlsL4msCOTDyTpwSsldXV6fhFF062jAdcTa2oREnyijsKNswU0GQHZ1/DYmTjrKhzGAxNDtknLOptta+/v33nejAaftaW9O7WludGE9suNBtIFq9oJXtTlyCl3WQfsYPC1B2+II07pBuc4I/G+UA/cjAc9pA/WTdunU+8CW0Up6kl7QyrMsBfjKg6+zCq65KO+KUUwpra7ehLZr4kce03t5eO9uCCuXC5fvvv/++P3wbH3WQbUF5SVuwfqORwmNSIH2Neswq+/S3U045JQsHJTInT56choMTNh67xyGgiCGGburGjzVSp9nf0KZB3lC4Zs0a34oVK7xRExz2IelzlKfoFtucvMiEhzKl69fnwvqWu2XtWvvaLVscOH6fjn6TTjvE9ovWYcRr6PNe9BuRnVHXRHb96kHd/aCfkYnKQQNJAfJPIB23RsmaKoL9gJWSSWFeDCKFEM28bnwRTyNDvHSyC0DSEBUTjAKn0ClocdLZxMBREcT4igEWpXDwE9A4IOGA8bUXFxdb8dLOAuPD/PhqQa9CowslDuKqS153GYDxELzMQhBaGG9UAPJMxaYvjRJdFkl9QJSXikta+QJRaHVWVlY6MWg4cLzSyhkwFMNCo0uFwIxHCxtbaXj6Qhvrp5P6WQ/rEBdLD1jWaCCkLYUXJOtyFf2QNmR7Em8snKyf8mBbidKyvagbTBNgecFn1Au9XSSTwRdaidtoyAS3IeuwBKmvoseyhVDkEKtC6SNGo0faKW/ykixQ1qRB9Jt9lX2J+sM4phvbQ/SU7SBGXwZA0rY/wDYiLWxDoUd0mP8y7ZhAOHA82IaTlnb0Pwv7HCuU/sZ7dDlAYIAKYCIXDNm5iFwoHzrRGeGFbU0ZimO8yNOoW4juB9LXpO0oO8bF0jfRNRnkRX7G/tWvgugIY2PEShPhifKzIRlHwcYCEQiJkNGUvnRWpgtEK4soChWW+GMxLWXFp/ApXAqd9VCRGGYc06Q+4qIj7XSsQ5RBeGSdUq8oarR85Jl4xUUrAHll45MOOuFdjB6i4gLrMNJKOumoCOJIM/NIOwi9iNJB6qJPWZAGoYMZBD/xEYfwxTQB8kfeyIuxLUW2LMOylCX1Irr9ENUPSI90DBkohS6mCR/EKziJl/wLzwj2g2haBbfQ2q/AEEZEy4F9RQwe5RxLtpSrUWelj5Be8jIYoMxEt0V29BknciVekRXrp5xYt9Rv7DOIHjSQFtFP1i99TfSXvqTTFzmJrOiTTvER1IE6Io60GnXb2N+MOpVInka5SdvF0zfiY70iP5Eh40hbovqQJdQoemCAHyIhMjJC4fBZhIpgTGB+EsEORuHEI0aYQDYdpK5EdUh+I32si8A4OiNIPtIlYamLhoP8UUHoRBGilQFJOgh+lhdHvMQhPhtFniVPNE3IMiAwr3QCCVNZSSvrIJ0io2g6jfQJPUKLyEiUjXQyLAqPYASkXuJgW9JnnBGi8zCN+UhTLKAsmC7yidYP4hNamI9085nlBqITSTpdxMUypJXlomlF1LCC8Mb6WTdpMCMH0syy+0svcdCJzBDUdYi6QhmKXFmPUVZsC9Kwv/UDRQRIB4E4hS7WQVqowzLgG/VYaDTKTGgSPPRJu9BPnOSXvvDBNKkTwYQguFmOOBLpm+RnvVKn8JuwMslAxuOBMMpKGCaD0tEHKidlmJduIKKYj47pzEdgmHUlqoN5BYw4hE6mUYBMI4hP/JKfYXZmlhFF4DMd6xcaRGERpQPLG3EYlYB8yDPxi5P6dQQJfiSv0MpnwUn8oqz0Y9EZizbyyLKCm+WEV1F4RPUD5mc5caSDcUaZkE7iJzCdeI3pjBcQ2oiPZVg2GiQP06jYgl/aIzo/n1mGjvUTL32WY9yBAGPdrI/1J6KX9IkcmH8oaCVOgrQH8bM9CNImrIf5WKfUz2e6oaABaHQ8xMc6iZOO9ZEW0mbsb6LHzBtLZlJeaCQecaRf+KAveaQMokwBy7E89Y1l6ceiBdF6On2RHX2WIQ76pkAaY6DMIgwSIY5545WTykUIQhD9WDCYOox4BqqP8ZJmzM+wCFV4ok+lMD5LnmheBa+RP2OjSzzzDcQzkkwB6xZnpI20Cr2SLnRKveKLchppYd6B+DMSFotXiWM+wSO0RdNixMUwyxJERuJLfCj1c9oEr9Aq6bF8oUtw0pe4WPmHMi5aDqSXwPhYIPxSbxgWmiU+VhkzcUKH+CK3aDqMdQ5V3QPRx7rFCT2iu+IzXtKiaSVeI40MU27GPif80E9WhkbajHQAVdz2Yz3Sfsb6WS4hxGLSWEjSSRBBnsUPxfb9Fcbpi2MOie+bO/REfOIYI/WFUhP/Cm6pT/x4JaU++lKfCF6ejXmIS/BKfaIQ9I1pEmaZoQAjHUKb0CppxnqM9AiNQjPzC8QqK2n0pYzwI74xD3EITYJbfGM+CRtxCJ2SJr7QJXjkWdJj+WZojVVdNEMhAAAATElEQVRuKOKi6TQ+D4TfjBwGKhsvXupmm0hYfCk3XHUL/lg+aYjlxPiyjDGdz0Y6GTbqsuiO5KE/WDDWyzBB/NBT31+pk7ESTqr+/w93v/ZsM+fHKAAAAABJRU5ErkJggg==";
}();return __lck()?{PivotDataProvider:PivotDataProvider,PivotView:PivotView,PivotSetupView:PivotSetupView,getVersion:_getVersion}:null}(this),RealPivot=function(a){if("string"==typeof a&&(a=document.getElementById(a)),!a)throw new Error("container not found.");this.provider=new RealPivotClass.PivotDataProvider,this.view=new RealPivotClass.PivotView(a),this.view.setDataSource(this.provider),this.view.addListener(this),this._setupView=new RealPivotClass.PivotSetupView(a,this.view),this.view.setSetupView(this._setupView),this.destroy=function(){this._setupView.destroy(),this._setupView=null,this.view.destroy(),this.view=null,this.provider.destroy(),this.provider=null},this.getVersion=function(){return RealPivotClass.getVersion()},this.setDataProvider=function(a){this.provider.setDataSource(a)},this.setFieldMapping=function(a){this.provider.setFieldMapping(a)},this.setPivotFields=function(a){this.provider.setPivotFields(a)},this.getDataOptions=function(){return this.provider.getOptions()},this.setDataOptions=function(a){this.provider.setOptions(a)},this.getOptions=function(){return this.view.getOptions()},this.setOptions=function(a){this.view.setOptions(a)},this.getDisplayOptions=function(){return this.view.getDisplayOptions()},this.setDisplayOptions=function(a){this.view.setDisplayOptions(a)},this.getSummaryOptions=function(){return this.view.getSummaryOptions()},this.setSummaryOptions=function(a){this.view.setSummaryOptions(a)},this.getHeaderOptions=function(){return this.view.getHeaderOptions()},this.setHeaderOptions=function(a){this.view.setHeaderOptions(a)},this.getCopyOptions=function(){return this.view.getCopyOptions()},this.setCopyOptions=function(a){this.view.setCopyOptions(a)},this.getGroupOptions=function(){return this.view.getGroupOptions()},this.setGroupOptions=function(a){this.view.setGroupOptions(a)},this.buildPivot=function(){this.provider.buildPivotData()},this.drawView=function(a){this.view.draw(a)},this.showSetupView=function(a,b){this._setupView.show(a,b)},this.resetSize=function(){this.view.resetSize()},this.sort=function(a){this.provider.sort(a),this.provider.buildPivotData()},this.resetFilter=function(){this.provider.resetFilter(),this.provider.buildPivotData()},this.filter=function(a){this.provider.filter(a),this.provider.buildPivotData()},this.exportGrid=function(a){this.view["export"](a)},this.expandColumnLevel=function(a){this.view.expandColumnLevel(a)},this.expandRowLevel=function(a){this.view.expandRowLevel(a)},this.expandColumn=function(a){this.view.expandColumn(a,!0)},this.expandRow=function(a){this.view.expandRow(a,!0)},this.collapseColumn=function(a){this.view.expandColumn(a,!1)},this.collapseRow=function(a){this.view.expandRow(a,!1)},this.setGlobalContextMenu=function(a){this.view.setGlobalContextMenu(a)},this.getGlobalContextMenu=function(a){return this.view.getGlobalContextMenu()},this.setContextMenu=function(a){this.view.setContextMenu(a)},this.getContextMenu=function(){return this.view.getContextMenu()},this.getColumnLabels=function(){return this.provider.getColumnLabelData()},this.getRowLabels=function(){return this.provider.getRowLabelData()},this.getAllValues=function(){return this.provider.getValueData()},this.getRowValues=function(a,b){return this.provider.getRowValueData(a,b)},this.getColumnValues=function(a,b){return this.provider.getColumnValueData(a,b)},this.getColumnFieldNames=function(){return this.provider.fieldManager().getColumnNames()},this.getRowFieldNames=function(){return this.provider.fieldManager().getRowNames()},this.onPivotViewClick=function(a,b,c){this.onClick&&this.onClick(a,b,c)},this.onPivotViewDblClick=function(a,b,c){this.onDblClick&&this.onDblClick(a,b,c)},this.onPivotViewTooltip=function(a,b,c){return this.onTooltip?this.onTooltip(a,b,c):c},this.onPivotViewLabelTooltip=function(a,b,c){return this.onLabelTooltip?this.onLabelTooltip(a,b,c):c},this.onPivotViewCurrentChanged=function(a,b){this.onCurrentChanged&&this.onCurrentChanged(a,b)}};