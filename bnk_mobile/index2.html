
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>realgrid2</title>
<style>
#btn2 {
  width: 80px;
  height: 30px;
  font-size:11px;
  color: black;
  text-align: center;
  background: white;
  border: solid 1px grey;
}

select  {
-webkit-appearance: none;
-moz-appearance: none;
appearance: none;
border: 0px;
background: #ccc1;
}

html, body { height:100%; overflow:hidden } 
.h-div {height:50%; border:0px #fff solid}
</style>

<script src="./scripts/jquery-3.1.1.min.js"></script>
<link href="./styles/style.css" rel="stylesheet" />
<link href="./styles/realgrid-style.css" rel="stylesheet" />
<script src="./scripts/realgrid-lic.js"></script>
<script src="./scripts/realgrid.2.5.1.min.js"></script>
<script src="./scripts/jszip.min.js"></script>

<script>
var fields = [
  {
    fieldName: "field0"
  },{
    fieldName: "field1",
    dataType: "datetime",
    datetimeFormat: "yyyy.MM.dd"
  },{
    fieldName: "field2"
  },{
    fieldName: "field3"
  },{
    fieldName: "field4",
    dataType: "number"
  },{
    fieldName: "field5",
    dataType: "number"
  }
];
var columns = [{
  fieldName:"field0",
  visible: false
},
  {
    name: "col1",
    fieldName: "field1",
    width: 100,
    styleName: "gray-color multiline-column",
    datetimeFormat: "MM.dd"
  },{
    name: "col2",
    fieldName: "field2",
    width: 200,
    styleName: "left-column multiline-column",
    editor: {
      type: "multiline"
    },
    renderer:{
      type:"html",
      callback: function(grid, cell, w, h) {
        if(cell.value == undefined){
          return "";
        }
        var multilineValue = dataProvider.getValue(cell.index.dataRow, "field3")
        var str = "";
        str = str + "<span style='font-weight:bold'>" + cell.value + "</span>" + "<span style='font-size:0.8em;color:gray' > \n" + multilineValue + "</span>"

        return str;
      }
    }
  },{
    name: "col3",
    fieldName: "field4",
    width: 200,
    styleName: "right-column multiline-column",
    editor: {
      type: "multiline"
    },
    renderer:{
      type:"html",
      callback: function(grid, cell, w, h) {
        if(cell.value == undefined){
          return "";
        }

        var multilineValue = dataProvider.getValue(cell.index.dataRow, "field5")
        var str = "";
        str = str + "<span style='font-size:1em;font-weight: bold;'>" + cell.value.toLocaleString() + "</span>" + " 원" + "<span style='font-size:0.8em;color:gray' >\n" + multilineValue.toLocaleString() + " 원" + "</span>"

        return str;
      }
    }
  }
];

var dataProvider, gridView;

$(function () {
  dataProvider = new RealGrid.LocalDataProvider();
  gridView = new RealGrid.GridView("realgrid");
  gridView.setDataSource(dataProvider);

  gridView.displayOptions.emptyMessage = "표시할 데이타가 없습니다.";
  gridView.header.visible = false;
  gridView.footer.visible = false;
  gridView.rowIndicator.visible = false;
  gridView.checkBar.visible = false;
  gridView.stateBar.visible = false;
  //gridView.editOptions.editable = true;
  gridView.displayOptions.rowHeight = 50;
  gridView.displayOptions.fitStyle = "evenFill";
  //gridView.displayOptions.vscrollBar = false;
  gridView.mobileOptions.grid.displayOptions.rowFocusType = "row";
  gridView.displayOptions.focusVisible = false;
  gridView.displayOptions.wheelEventPropagate = false;

  document.getElementById("realgrid").style.height = (document.body.offsetHeight - 255) + "px"
  gridView.resetSize();

  dataProvider.setFields(fields);
  gridView.setColumns(columns);

  var datas = [
    ["2022","2022.02.10", "KB카드결제", "카드결제", -100000, 2500000],
    ["2022","2022.01.16", "KB카드결제", "카드결제", -100000, 2600000],
    ["2022","2022.01.03", "KB카드결제", "카드결제", -100000, 2700000],
    ["2021","2021.12.31", "김미선", "타행입금", 100000, 2800000],
    ["2021","2021.12.02", "삼성화04100", "CMS자동이체", -100000, 2700000],
    ["2021","2021.11.25", "KB카드결제", "카드결제", -100000, 2800000],
    ["2021","2021.11.17", "KB카드결제", "카드결제", -100000, 2900000],
    ["2021","2021.11.15", "KB카드결제", "카드결제", -100000, 3000000],
    ["2021","2021.11.12", "KB카드결제", "카드결제", -100000, 3100000],
    ["2021","2021.11.11", "KB카드결제", "카드결제", -100000, 3200000],
    ["2021","2021.11.10", "KB카드결제", "카드결제", -100000, 3300000]
  ];

  dataProvider.setRows(datas);

  gridView.onDataLoadComplated = function(grid){
    gridView.setColumnFilters("col1",[{name:"1개월", tag:1, callback:function(ds, dataRow, level, field, filter, value) {
       return dateFilters(value, filter.tag);
    }},{name:"2개월", tag:2, callback:function(ds, dataRow, level, field, filter, value) {
       return dateFilters(value, filter.tag);
    }},{name:"3개월", tag:3, callback:function(ds, dataRow, level, field, filter, value) {
       return dateFilters(value, filter.tag);
    }}]);

    //gridView.groupBy(["field0"]);
    gridView.setRowGroup({
      expandedAdornments:"header",
      headerStatement: "${groupValue}"
    });

    gridView.orderBy(["field0","field1"],["descending","descending"]);
  }
});

function dateFilters(value, month){
  var now = new Date();
      
  if(value > new Date(now.setMonth(now.getMonth() - month))){
      return true;
  }
}

function setSorting(){
  if(document.getElementById("sorting").value == "descending"){
    gridView.orderBy(["field0","field1"],["descending","descending"])
  }else{
    gridView.orderBy(["field0","field1"],["ascending","ascending"])
  }
}

function setFiltering(){
  gridView.activateAllColumnFilters('col1', false);
  gridView.activateColumnFilters('col1', [document.getElementById("month").value + "개월"], true);
}

</script>
</head>
<body>
  <span style='font-size:1.2em;color:black;font-weight:bold;padding-right:10px;'>이체/거래내역조회</span><br/>
  <button type="button" style="background-color: white;width:50px;height:50px;color:white;border: none">
    <span style='font-size:2em;color:black'><</span>
  </button>
  <span style='font-size:1.5em;color:black'>거래내역조회</span><br/>

  <div>
    &nbsp;&nbsp; 생활비통장<br/>
    &nbsp;&nbsp; <span style='font-size:1em;color:black;font-weight:bold;'>1234-5678-9123-45</span><br/>

    <div style="border: 0px solid gold; float: left; background-color: #fff; width: 40%;height:30px; text-align: left;">
      &nbsp;&nbsp;&nbsp;<input type="button" value="거래확인증" id="btn2">
    </div>
    <div style="border: 0px solid gold; float: left; background-color: #fff; width: 60%;height:30px; text-align: right;">
      <span style='font-size:1.7em;color:black;font-weight:bold;padding-right:10px;'>100,000,000원</span>
    </div>
  </div><br/><br/>
  
  <div style="border: 0px solid gold; float: left; width: 50%;">
    <input type='button' 
         value='이체' 
         style="background-color: red;width:100%;height:50px;color:white;border: none"
         onclick='alert("")'/>
  </div>
  <div style="border: 0px solid red; float: left; width: 50%;">
    <input type='button' 
           value='ATM출금' 
           style="background-color: red;width:100%;height:50px;color:white;border: none"
           onclick='alert("")'/>
    <div style="height:5px"></div>
  </div>

  <div id="dateContainer" style="border: 0px solid gold; float: left; background-color: #ccc7; width: 55%;height:30px; text-align: center;">2021.11.10~2022.02.22</div>
  <div style="border: 0px solid gold; float: left; background-color: #ccc7; width: 15%;height:30px; text-align: center;">
    <select name="month" id="month" onchange="setFiltering()">
      <option value="1">1개월</option>
      <option value="2">2개월</option>
      <option value="3">3개월</option>
    </select>
  </div>
  <div style="border: 0px solid gold; float: left; background-color: #ccc7; width: 15%;height:30px; text-align: center;">
    <select name="sorting" id="sorting" onchange="setSorting()">
      <option value="descending">최신순</option>
      <option value="ascending">마지막</option>
    </select>
  </div>
  <div style="border: 0px solid gold; float: left; background-color: #ccc7; width: 15%;height:30px; text-align: center;">전체</div>
  <div id="realgrid" style="width: 100%; height: 400px;"></div>
</body>
</html>